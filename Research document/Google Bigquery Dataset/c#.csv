id,title,body,tags,answers,score
33824811,How can I avoid code duplication by using OOP or SOLID principles?,"<p>I have the following class and interface for him:</p>

<pre><code>public class A // int wrapper
{
    private int _a;

    public A(int a)
    {
        _a = a;
    }
}

interface IProgram
{
    int a();

    A b();
}

public class Program : IProgram
{
    public int a()
    {
       int b = 0;
       b++;
       return b;
    }

    public A b()
    {
        int b = 0;
        b++;
        return new A(b);
    }
}
</code></pre>

<p>Two methods do the same thing: just increase <code>b</code>.</p>

<p>How can I avoid code duplication and change my interface?</p>",c#|oop,"<p>Create a private method which iterates int b and returns it, then call that method from a() and b()</p>",1
33475992,System.Windows.MessageBox: Yes Button is missing,"<p>In my WPF Application (.NET 3.5) I create a MessageBox like this:</p>

<pre><code>if (System.Windows.MessageBox.Show(""Eine neue Version von Qualisoft steht zum Download bereit. Möchten Sie diese installieren?"", ""Neue Qualisoft Version"", MessageBoxButton.YesNo) == MessageBoxResult.Yes)
{
...
}
</code></pre>

<p>One of my customers get this result:</p>

<p><img src=""https://i.stack.imgur.com/PjOPG.jpg"" alt=""""></p>

<p>I tested this on about 10 systems and I cant reproduce this result.</p>

<p>Does anyone know why the Yes Button is missing?</p>",c#|wpf,"<p>Your customer is playing a prank on you and sent you a photo-shopped screenshot.  Probably a not-so-subtle hint that he's a bit tired of having to constantly deal with new versions.  Something like that.</p>

<p>The native MessageBox() winapi function does not have an option to <em>only</em> display the No button.</p>

<p>Just prank him right back and recommend he drags the machine to a 4th story window and let it slip.  With the advice that opening the window first is entirely optional.</p>",2
33475992,System.Windows.MessageBox: Yes Button is missing,"<p>In my WPF Application (.NET 3.5) I create a MessageBox like this:</p>

<pre><code>if (System.Windows.MessageBox.Show(""Eine neue Version von Qualisoft steht zum Download bereit. Möchten Sie diese installieren?"", ""Neue Qualisoft Version"", MessageBoxButton.YesNo) == MessageBoxResult.Yes)
{
...
}
</code></pre>

<p>One of my customers get this result:</p>

<p><img src=""https://i.stack.imgur.com/PjOPG.jpg"" alt=""""></p>

<p>I tested this on about 10 systems and I cant reproduce this result.</p>

<p>Does anyone know why the Yes Button is missing?</p>",c#|wpf,"<p>This issue is <strong>NOT</strong> (directly) related to .NET. WPF actually redirects the call to the <a href=""https://msdn.microsoft.com/en-us/library/windows/desktop/ms645505(v=vs.85).aspx"" rel=""nofollow"">operating system</a>, to be specific by <a href=""http://referencesource.microsoft.com/#PresentationFramework/src/Framework/System/Windows/MessageBox.cs,508"" rel=""nofollow"">this call</a>:</p>

<pre><code>UnsafeNativeMethods.MessageBox(...)
</code></pre>

<p>There can be other things that go wrong. This might be caused by a language pack or something, but I doubt that. Also video card drivers sometimes mess up UI controls. There is not much to go on now since it can't be reproduced easily.</p>

<p>You have to go check by taking out parts that might be the issue. Start in safe mode and check if the issue persists. Try to make a new default application with just this call. Is the behavior still the same? Then continue. Else something in your code might be causing this.</p>",3
43590896,ASP.net MVC - Call other controller from view,"<p>try to call from view in ""Transaction"" controller, The other ""CreditCard"" controller:</p>

<pre><code>@(Url.Action(""ShowImage"", ""CreditCard""))/"" + ConcatString
</code></pre>

<p>from src propery of IMG tag.
but because it from other controller the URL is invalid.
Insted Of:</p>

<pre><code>/creditcard/showimage/45809014157220320
</code></pre>

<p>Its:</p>

<pre><code>/Transaction/TransactionToPDF/creditcard/showimage/45809014157220320
</code></pre>",c#|asp.net|asp.net-mvc,"<p>Of course you can use Html.Action helper. But it is easier for me to do it like this. </p>

<pre><code>   &lt;img src=""/CreditCard/ShowImage/@ConcatString"" class=""img float-xs-right"" width=""350"" height=""380"" id=""creditCardImage"" /&gt; 
</code></pre>",0
43590896,ASP.net MVC - Call other controller from view,"<p>try to call from view in ""Transaction"" controller, The other ""CreditCard"" controller:</p>

<pre><code>@(Url.Action(""ShowImage"", ""CreditCard""))/"" + ConcatString
</code></pre>

<p>from src propery of IMG tag.
but because it from other controller the URL is invalid.
Insted Of:</p>

<pre><code>/creditcard/showimage/45809014157220320
</code></pre>

<p>Its:</p>

<pre><code>/Transaction/TransactionToPDF/creditcard/showimage/45809014157220320
</code></pre>",c#|asp.net|asp.net-mvc,"<p>I think you have an ""Area"" issue.  If they are in different areas, you should be able to do this:</p>

<pre><code>@(Url.Action(""ShowImage"", ""CreditCard"", new { area = """" }))/"" + ConcatString
</code></pre>",0
43590896,ASP.net MVC - Call other controller from view,"<p>try to call from view in ""Transaction"" controller, The other ""CreditCard"" controller:</p>

<pre><code>@(Url.Action(""ShowImage"", ""CreditCard""))/"" + ConcatString
</code></pre>

<p>from src propery of IMG tag.
but because it from other controller the URL is invalid.
Insted Of:</p>

<pre><code>/creditcard/showimage/45809014157220320
</code></pre>

<p>Its:</p>

<pre><code>/Transaction/TransactionToPDF/creditcard/showimage/45809014157220320
</code></pre>",c#|asp.net|asp.net-mvc,"<p>Wild guess, your Action doesn't accept a <code>null</code> for the image id? Rather than trying to add <code>concatstring</code> try specifying the parameter e.g.,</p>

<pre><code>@Url.Action(""ShowImage"", ""CreditCard"", new { ImageId= ConcatString }) 
</code></pre>

<p>Again, depending on what the allowed parameters are for the Action this should let the correct URL be resolved by the routing system</p>",1
43523653,Why do I get a Format Exception when comparing int and float values?,"<p>I don't know why but I am getting a <code>FormatException</code> when comparing two values. Could someone tell me what I am doing wrong? I already tried to make both values float, yet the same exception... </p>

<pre><code>float label1 = float.Parse(label15.Text);
int box1 = int.Parse(textBox23.Text);

if (label1 &lt;= box1)
{
    //Do things""
}
</code></pre>",c#|parsing|formatexception,"<p>You've got yourself in a corner without using proper exception handling. </p>

<pre><code>    float label1 = float.Parse(label15.Text);  //problem 1
    int box1 = int.Parse(label15.Text);  //problem 2

    if (label1 &lt;= box1)  //problem 3
    {
    //Do things""
    }
</code></pre>

<p>Problems 1 and 2 are that you aren't ensuring your UI is giving you values that you can parse.  That will throw exceptions.  Problem 3 is that since you don't know if your parsing was successful, you don't know if you can even make the comparison.   Try <code>TryParse()</code>.</p>

<pre><code>    float label1 = 0;

                int box1 = 0;

                if(float.TryParse(label15.Text, out label1)
                    &amp;&amp;  int.TryParse(label15.Text, out box1))
                {
                   if (label1 &lt;= box1)
                   {
                   //Do things""
                   }
                }
</code></pre>

<p>The <code>TryParse()</code> function populates your existing variables as <code>out</code> parameters, but returns a <code>bool</code>.  This returns as <code>false</code> if the parse fails, and allows the code to continue.  By making these succeeding an <code>if</code> condition, we sidestep errors entirely. </p>

<p>You can also always wrap your code in a <code>try-catch block</code> to determine the cause of any exception and generate output, but you never want that to manage your logical flow.  You'd use that to troubleshoot this problem, and what I posted as a possible solution. </p>",1
43523653,Why do I get a Format Exception when comparing int and float values?,"<p>I don't know why but I am getting a <code>FormatException</code> when comparing two values. Could someone tell me what I am doing wrong? I already tried to make both values float, yet the same exception... </p>

<pre><code>float label1 = float.Parse(label15.Text);
int box1 = int.Parse(textBox23.Text);

if (label1 &lt;= box1)
{
    //Do things""
}
</code></pre>",c#|parsing|formatexception,"<p><a href=""https://msdn.microsoft.com/en-us/library/system.formatexception(v=vs.110).aspx"" rel=""nofollow noreferrer"">FormatException</a></p>

<blockquote>
  <p>The exception that is thrown when the format of an argument is
  invalid, or when a composite format string is not well formed.</p>
</blockquote>

<p>the error is because whatever the value of <code>label15</code> / <code>textBox23</code> is, it is not a valid number.</p>

<p>use <a href=""https://msdn.microsoft.com/en-us/library/system.single.tryparse(v=vs.110).aspx"" rel=""nofollow noreferrer""><code>float.TryParse</code></a> and <a href=""https://msdn.microsoft.com/en-us/library/f02979c7(v=vs.110).aspx"" rel=""nofollow noreferrer""><code>int.TryParse</code></a> respectively as they don't throw exceptions:</p>

<pre><code>float label1;
if(label15.Text, out label1){
  // do something
}

int box1;
if(textBox23.Text, out box1){
   // do something
}
</code></pre>

<p>though, you'll still need to ensure that <code>label15</code> / <code>textBox23</code> is a parsable value, otherwise control will not go inside the <code>if</code> statements.</p>",2
43523653,Why do I get a Format Exception when comparing int and float values?,"<p>I don't know why but I am getting a <code>FormatException</code> when comparing two values. Could someone tell me what I am doing wrong? I already tried to make both values float, yet the same exception... </p>

<pre><code>float label1 = float.Parse(label15.Text);
int box1 = int.Parse(textBox23.Text);

if (label1 &lt;= box1)
{
    //Do things""
}
</code></pre>",c#|parsing|formatexception,"<p>The <a href=""https://msdn.microsoft.com/en-US/library/bh4863by(v=vs.110).aspx"" rel=""nofollow noreferrer"">float.Parse</a> method can take a second parameter. </p>

<p><sub>Assuming you are looking for German number parsing based on your profile.</sub></p>

<p>So if you want to parse German number formats, make sure the method knows that (because by US standards, ""2,5"" is not a floating point number... there's not even a <em>point</em> to start with).</p>

<p>In theory, your <code>System.Globalization.CultureInfo.CurrentCulture</code> should already be what you need. In case it's not, you can create a culture you need:</p>

<p>This should work fine:</p>

<pre><code>float f = float.Parse(""2,5"", new System.Globalization.CultureInfo(""de-DE""))
</code></pre>

<p>Keep in mind that despite your best efforts, people might still just enter garbage in your textbox, so you should keep an eye out for <a href=""https://msdn.microsoft.com/en-US/library/0xh24xh4(v=vs.110).aspx"" rel=""nofollow noreferrer"">TryParse</a> as mentioned in the other answers. But even there: watch out for the correct culture to parse your numbers.</p>",1
17770699,How to change DateTime to Local GMT DateTime in asp:BoundField?,"<p>I have a <strong>asp:GridView</strong> and it has a <strong>asp:BoundField</strong> that contains DateTime data comming form database. now here i want to show this DateTime to my local GMT DateTime only for view purpose.</p>

<p>I think it should need a client side solution.</p>

<p>source is below,</p>

<pre><code> &lt;asp:BoundField HeaderText=""Registration Date"" DataField=""RegisteredDate"" DataFormatString=""{0:MM/dd/yyyy hh:mm:ss}"" /&gt;
</code></pre>

<p>here <strong>RegisteredDate</strong> is the <strong>CurrentDateTime</strong> from database under <strong>DataField</strong></p>

<p>Any help will be appreciated.</p>",c#|javascript|jquery|asp.net,"<p>You can try it by using label  below and 
<a href=""http://msdn.microsoft.com/en-us/library/bb397769.aspx"" rel=""nofollow"">Time Zone Conversions in c#</a></p>

<pre><code>&lt;asp:TemplateField HeaderText=""Registration Date""&gt;
&lt;ItemTemplate&gt;
&lt;asp:Label runat=""server"" Text='&lt;%#Convert.ToDateTime(Eval(""RegisteredDate"")).ToLocalTime()%&gt;'/&gt;
&lt;/ItemTemplate&gt;      
&lt;/asp:TemplateField&gt;
</code></pre>",2
17770699,How to change DateTime to Local GMT DateTime in asp:BoundField?,"<p>I have a <strong>asp:GridView</strong> and it has a <strong>asp:BoundField</strong> that contains DateTime data comming form database. now here i want to show this DateTime to my local GMT DateTime only for view purpose.</p>

<p>I think it should need a client side solution.</p>

<p>source is below,</p>

<pre><code> &lt;asp:BoundField HeaderText=""Registration Date"" DataField=""RegisteredDate"" DataFormatString=""{0:MM/dd/yyyy hh:mm:ss}"" /&gt;
</code></pre>

<p>here <strong>RegisteredDate</strong> is the <strong>CurrentDateTime</strong> from database under <strong>DataField</strong></p>

<p>Any help will be appreciated.</p>",c#|javascript|jquery|asp.net,"<p>I've no experience with the asp controls but if you want a server side solution, this may help:  <a href=""https://stackoverflow.com/questions/179940/c-sharp-convert-utc-gmt-time-to-local-time"">C# - Convert UTC/GMT time to local time</a> or the gridview specific stuff here: <a href=""http://forums.asp.net/t/1358775.aspx"" rel=""nofollow noreferrer"">asp.net forum</a>.</p>

<p>EDIT - an alternative link <a href=""http://msdn.microsoft.com/en-us/library/bb882561.aspx"" rel=""nofollow noreferrer"">How to: Display Localized Date and Time Information to Web Users</a> </p>

<p>I'm sorry, if you still think server side processing wont work after reading that post. </p>

<p>If you wanted to format client-side the <a href=""http://momentjs.com/timezone/"" rel=""nofollow noreferrer"">moment.js</a> ibrary might be of use.</p>",1
18003699,The type 'System.Int32' needs to represent an enumeration type,"<p>I am try toggle a column value. I am using Entity framework database connection.</p>

<pre><code>public static void yayinDegistir(int id)
{
    using (vt dc = new vt())
    {
        Testler d = dc.testler.FirstOrDefault(t =&gt; t.testId.Equals(id));
        if (d != null)
        {
            d.yayinda = !d.yayinda; //bool value to toggle
            dc.SaveChanges(); //error
        }
    }
}
</code></pre>

<p>And the error is</p>

<pre><code>Description: An unhandled exception occurred during the execution of the current web request. Please review the stack trace for more information about the error and where it originated in the code. 

Exception Details: System.InvalidOperationException: The type 'System.Int32' needs to represent an enumeration type.
</code></pre>

<p>The Testler class</p>

<pre><code>public class Testler
{
    [Key]
    [ScaffoldColumn(false)]
    public virtual int testId { get; set; }

    [DataType(DataType.Text)]
    [Display(Name = ""Test Adı"")]
    public virtual string testAdi { get; set; }

    [DataType(DataType.MultilineText)]
    public virtual string aciklama { get; set; }

    [DataType(DataType.Text)]
    [EnumDataType(typeof(int), ErrorMessage = ""{0} mutlaka sayı olmalıdır!"")]
    public virtual int testSuresi { get; set; }

    public virtual bool cokluSecim { get; set; }

    [DataType(DataType.MultilineText)]
    public virtual string oneriler { get; set; }

    public virtual bool yayinda { get; set; }

    public virtual ICollection&lt;Sorular&gt; sorular { get; set; }
}
</code></pre>

<p>Stack trace of error</p>

<blockquote>
  <p>Stack Trace: </p>

<pre><code>[InvalidOperationException: The type 'System.Int32' needs to represent an enumeration type.]
   System.ComponentModel.DataAnnotations.EnumDataTypeAttribute.IsValid(Object
</code></pre>
  
  <p>value) +40216
         System.ComponentModel.DataAnnotations.ValidationAttribute.IsValid(Object
  value, ValidationContext validationContext) +115
         System.ComponentModel.DataAnnotations.ValidationAttribute.GetValidationResult(Object
  value, ValidationContext validationContext) +29
         System.Data.Entity.Internal.Validation.ValidationAttributeValidator.Validate(EntityValidationContext
  entityValidationContext, InternalMemberEntry property) +100</p>

<pre><code>[DbUnexpectedValidationException: An unexpected exception was thrown during validation of 'Test Süresi (saniye) (0 süresiz)' when
</code></pre>
  
  <p>invoking
  System.ComponentModel.DataAnnotations.EnumDataTypeAttribute.IsValid.
  See the inner exception for details.]
         System.Data.Entity.Internal.Validation.ValidationAttributeValidator.Validate(EntityValidationContext
  entityValidationContext, InternalMemberEntry property) +170
         System.Data.Entity.Internal.Validation.PropertyValidator.Validate(EntityValidationContext
  entityValidationContext, InternalMemberEntry property) +108
         System.Data.Entity.Internal.Validation.EntityValidator.ValidateProperties(EntityValidationContext
  entityValidationContext, InternalPropertyEntry parentProperty, List<code>1
  validationErrors) +100
         System.Data.Entity.Internal.Validation.TypeValidator.Validate(EntityValidationContext
  entityValidationContext, InternalPropertyEntry property) +69
         System.Data.Entity.Internal.Validation.EntityValidator.Validate(EntityValidationContext
  entityValidationContext) +17
         System.Data.Entity.Internal.InternalEntityEntry.GetValidationResult(IDictionary</code>2
  items) +193
         System.Data.Entity.DbContext.ValidateEntity(DbEntityEntry entityEntry, IDictionary<code>2 items) +40
         System.Data.Entity.DbContext.GetValidationErrors() +210
         System.Data.Entity.Internal.InternalContext.SaveChanges() +44
         System.Data.Entity.Internal.LazyInternalContext.SaveChanges() +33
         System.Data.Entity.DbContext.SaveChanges() +20
         Ramazan.TestIslem.yayinDegistir(Int32 id) in D:\Projects\Visual Studio 2010\Projects\hayatdestek\hayatdestek\Ramazan\Testler.cs:102
         hayatdestek.Controllers.YonetimController.YayinDegistir(Int32 id) in D:\Projects\Visual Studio
  2010\Projects\hayatdestek\hayatdestek\Controllers\YonetimController.cs:180
         lambda_method(Closure , ControllerBase , Object[] ) +97
         System.Web.Mvc.ActionMethodDispatcher.Execute(ControllerBase controller, Object[] parameters) +14
         System.Web.Mvc.ReflectedActionDescriptor.Execute(ControllerContext
  controllerContext, IDictionary</code>2 parameters) +182
         System.Web.Mvc.ControllerActionInvoker.InvokeActionMethod(ControllerContext
  controllerContext, ActionDescriptor actionDescriptor, IDictionary<code>2
  parameters) +27
         System.Web.Mvc.Async.&lt;&gt;c__DisplayClass42.&lt;BeginInvokeSynchronousActionMethod&gt;b__41()
  +28
         System.Web.Mvc.Async.&lt;&gt;c__DisplayClass8</code>1.b__7(IAsyncResult
  <em>) +10
         System.Web.Mvc.Async.WrappedAsyncResult<code>1.End() +50
         System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethod(IAsyncResult
  asyncResult) +32
         System.Web.Mvc.Async.&lt;&gt;c__DisplayClass39.&lt;BeginInvokeActionMethodWithFilters&gt;b__33()
  +58
         System.Web.Mvc.Async.&lt;&gt;c__DisplayClass4f.&lt;InvokeActionMethodFilterAsynchronously&gt;b__49()
  +225
         System.Web.Mvc.Async.&lt;&gt;c__DisplayClass37.&lt;BeginInvokeActionMethodWithFilters&gt;b__36(IAsyncResult asyncResult) +10
         System.Web.Mvc.Async.WrappedAsyncResult</code>1.End() +50
         System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeActionMethodWithFilters(IAsyncResult
  asyncResult) +34
         System.Web.Mvc.Async.&lt;>c</em>_DisplayClass2a.b_<em>20()
  +24
         System.Web.Mvc.Async.&lt;>c</em>_DisplayClass25.b_<em>22(IAsyncResult
  asyncResult) +99
         System.Web.Mvc.Async.WrappedAsyncResult<code>1.End() +50
         System.Web.Mvc.Async.AsyncControllerActionInvoker.EndInvokeAction(IAsyncResult
  asyncResult) +27
         System.Web.Mvc.&lt;&gt;c__DisplayClass1d.&lt;BeginExecuteCore&gt;b__18(IAsyncResult
  asyncResult) +14
         System.Web.Mvc.Async.&lt;&gt;c__DisplayClass4.&lt;MakeVoidDelegate&gt;b__3(IAsyncResult
  ar) +23
         System.Web.Mvc.Async.WrappedAsyncResult</code>1.End() +55
         System.Web.Mvc.Controller.EndExecuteCore(IAsyncResult asyncResult) +39
         System.Web.Mvc.Async.&lt;>c</em>_DisplayClass4.b_<em>3(IAsyncResult
  ar) +23
         System.Web.Mvc.Async.WrappedAsyncResult<code>1.End() +55
         System.Web.Mvc.Controller.EndExecute(IAsyncResult asyncResult) +29
         System.Web.Mvc.Controller.System.Web.Mvc.Async.IAsyncController.EndExecute(IAsyncResult
  asyncResult) +10
         System.Web.Mvc.&lt;&gt;c__DisplayClassb.&lt;BeginProcessRequest&gt;b__4(IAsyncResult
  asyncResult) +25
         System.Web.Mvc.Async.&lt;&gt;c__DisplayClass4.&lt;MakeVoidDelegate&gt;b__3(IAsyncResult
  ar) +23
         System.Web.Mvc.Async.WrappedAsyncResult</code>1.End() +55
         System.Web.Mvc.&lt;>c</em>_DisplayClasse.b_<em>d() +31
         System.Web.Mvc.SecurityUtil.b</em>_0(Action f) +7
         System.Web.Mvc.SecurityUtil.ProcessInApplicationTrust(Action action) +23
         System.Web.Mvc.MvcHandler.EndProcessRequest(IAsyncResult asyncResult) +59
         System.Web.Mvc.MvcHandler.System.Web.IHttpAsyncHandler.EndProcessRequest(IAsyncResult
  result) +9
         System.Web.CallHandlerExecutionStep.System.Web.HttpApplication.IExecutionStep.Execute()
  +9629296
         System.Web.HttpApplication.ExecuteStep(IExecutionStep step, Boolean&amp; completedSynchronously) +155</p>
</blockquote>

<p>The solution answer from @Pawel</p>

<blockquote>
  <p>this exception seems to originate from [EnumDataType(typeof(int),
  ErrorMessage = ""{0} mutlaka sayı olmalıdır!"")] where the type should
  an Enum type and not the simple type. Try removing this attribute to
  test things work. Note the EnumDataType attribute is not used by EF
  and this is issue is probably not related to EF.</p>
</blockquote>",c#,"<p>Your stack trace:</p>

<blockquote>
  <p>[InvalidOperationException: The type 'System.Int32' needs to represent
  an enumeration type.]<br>
  System.ComponentModel.DataAnnotations.EnumDataTypeAttribute.IsValid(Object</p>
</blockquote>

<p>suggests that this annotation:</p>

<pre><code>[EnumDataType(typeof(int), ErrorMessage = ""{0} mutlaka sayı olmalıdır!"")]
</code></pre>

<p>on <code>public virtual int testSuresi { get; set; }</code> is throwing up.</p>",0
43267833,ActiveX component can't create object COM interop,"<p>I have a requirement where I have to use a base64 encoding on an image in classic ASP</p>

<p>so I created a very simple class project in C# project and trying to make it COM visible, I've read all the guides and various other questions on stackoverflow  but I still can't get vbscript to create the Object</p>

<p>The assembly is marked as ComVisible and output is marked to register for COM interop, my source for the class:</p>

<pre><code>namespace Crypto
{
    [ComVisible(true)]
    [Guid(""ad491fe9-ade0-46a1-bae0-d407a987a9e9""),ClassInterface(ClassInterfaceType.None)]
    public class Base64
    {
        public Base64() {
            //default com exposable constructor
        }

        public string Base64Encode(string filePath) {

            if (!File.Exists(filePath)) return """";

            using (Image image = Image.FromFile(filePath))
            {
                using (MemoryStream m = new MemoryStream())
                {
                    image.Save(m, image.RawFormat);
                    byte[] imageBytes = m.ToArray();

                    // Convert byte[] to Base64 String
                    string base64String = Convert.ToBase64String(imageBytes);
                    return base64String;
                }
            }
        }
    }
}
</code></pre>

<p>After build, I register it as cominterop and put in in GAC anyway, using</p>

<pre><code>regasm *&lt;file path&gt;* /codebase /tlb
gacutil -i *&lt;file path&gt;*
</code></pre>

<p>everything registers successfully</p>

<p>when I call from a test classic asp page</p>

<pre><code>set obj = CreateObject(""Crypto.Base64"")
</code></pre>

<p>I get </p>

<pre><code>Microsoft VBScript runtime error '800a01ad'

ActiveX component can't create object: 'Crypto.Base64'
</code></pre>

<p>I have worked with ComInterop about 7-8 years ago in .Net 2.0, everything worked smoothly, I can't understand whats wrong in this case</p>

<p>On my dev machine, it's windows 10 pro 64-bit, target compilation is 4.6.2 Framework</p>",c#|vbscript|asp-classic|com-interop,"<p>Thanks to @Lankymart for pointing me in the right direction</p>

<p>Even though the COM exposable .NET assembly was compiled for both 32-bit / 64-bit
32-bit Applications still need to be enabled in the App Pool advanced settings to get it to work</p>

<p><a href=""https://i.stack.imgur.com/NgcPA.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/NgcPA.png"" alt=""enter image description here""></a></p>",0
42952007,c# multiple choice test,"<p>working on creating a web based revision resource and i am trying to create a multiple choice quiz in c# with asp.net.
I have created it and got it working but it is very long and was wondering if anyone had an idea of how i could make the code more compact,
also when it prints the final score it appears above my nav bar on my website by i have no idea why.</p>

<p>in addition, the answers can be changed and the submit button just re clicked, i cannot for the love of anything find anything on how to stop this.</p>

<p>I am extremely new to everything and am trying my best. if someone could point me in the right direction or suggest something that might help that would be awesome.</p>

<p>Thanks</p>

<p>I appologise for the length of the code:</p>

<pre><code>&lt;asp:Content ID=""Content1"" ContentPlaceHolderID=""Head"" runat=""server""&gt;
&lt;/asp:Content&gt;
&lt;asp:Content ID=""Content2"" ContentPlaceHolderID=""Body"" runat=""server""&gt;
    &lt;asp:Label ID=""Label1"" runat=""server"" Text=""""&gt;&lt;/asp:Label&gt;


    &lt;asp:RadioButtonList ID=""RadioButtonList1"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList2"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList3"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList4"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList5"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList6"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList7"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList8"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList9"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList10"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;

    &lt;asp:Button ID=""Button1"" runat=""server"" Text=""Submit Final Answers"" OnClick=""Submit_Click"" /&gt;
    &lt;script runat=""server""&gt;
        protected void Submit_Click(object sender, EventArgs e)
        {
            int Score = 0;
            string selectedValue1 = RadioButtonList1.SelectedValue;
            if (selectedValue1 == ""Correct"")
            {
                Score++;
            }
            string selectedValue2 = RadioButtonList2.SelectedValue;
            if (selectedValue2 == ""Correct"")
            {
                Score++;
            }
            string selectedValue3 = RadioButtonList3.SelectedValue;
            if (selectedValue3 == ""Correct"")
            {
                Score++;
            }
            string selectedValue4 = RadioButtonList4.SelectedValue;
            if (selectedValue4 == ""Correct"")
            {
                Score++;
            }
            string selectedValue5 = RadioButtonList5.SelectedValue;
            if (selectedValue5 == ""Correct"")
            {
                Score++;
            }
            string selectedValue6 = RadioButtonList6.SelectedValue;
            if (selectedValue6 == ""Correct"")
            {
                Score++;
            }
            string selectedValue7 = RadioButtonList7.SelectedValue;
            if (selectedValue7 == ""Correct"")
            {
                Score++;
            }
            string selectedValue8 = RadioButtonList8.SelectedValue;
            if (selectedValue8 == ""Correct"")
            {
                Score++;
            }
            string selectedValue9 = RadioButtonList9.SelectedValue;
            if (selectedValue9 == ""Correct"")
            {
                Score++;
            }
            string selectedValue10 = RadioButtonList10.SelectedValue;
            if (selectedValue10 == ""Correct"")
            {
                Score++;
            }
            Response.Write(Score);

        }
    &lt;/script&gt;
&lt;/asp:Content&gt;
</code></pre>",c#|asp.net,"<p>This may shorten up the evaluation phase:</p>

<pre><code>RadioButtonList[] lists = new RadioButtonList[] {RadioButtonList1, RadioButtonList2, RadioButtonList3, RadioButtonList4, RadioButtonList5, RadioButtonList6, RadioButtonList7, RadioButtonList8, RadioButtonList9, RadioButtonList10 };

foreach (RadioButtonList element in lists ) {
            if (element.SelectedValue == ""correct"") {
                Score++;
        }
}
</code></pre>",1
42952007,c# multiple choice test,"<p>working on creating a web based revision resource and i am trying to create a multiple choice quiz in c# with asp.net.
I have created it and got it working but it is very long and was wondering if anyone had an idea of how i could make the code more compact,
also when it prints the final score it appears above my nav bar on my website by i have no idea why.</p>

<p>in addition, the answers can be changed and the submit button just re clicked, i cannot for the love of anything find anything on how to stop this.</p>

<p>I am extremely new to everything and am trying my best. if someone could point me in the right direction or suggest something that might help that would be awesome.</p>

<p>Thanks</p>

<p>I appologise for the length of the code:</p>

<pre><code>&lt;asp:Content ID=""Content1"" ContentPlaceHolderID=""Head"" runat=""server""&gt;
&lt;/asp:Content&gt;
&lt;asp:Content ID=""Content2"" ContentPlaceHolderID=""Body"" runat=""server""&gt;
    &lt;asp:Label ID=""Label1"" runat=""server"" Text=""""&gt;&lt;/asp:Label&gt;


    &lt;asp:RadioButtonList ID=""RadioButtonList1"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList2"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList3"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList4"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList5"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList6"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList7"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList8"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList9"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList10"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;

    &lt;asp:Button ID=""Button1"" runat=""server"" Text=""Submit Final Answers"" OnClick=""Submit_Click"" /&gt;
    &lt;script runat=""server""&gt;
        protected void Submit_Click(object sender, EventArgs e)
        {
            int Score = 0;
            string selectedValue1 = RadioButtonList1.SelectedValue;
            if (selectedValue1 == ""Correct"")
            {
                Score++;
            }
            string selectedValue2 = RadioButtonList2.SelectedValue;
            if (selectedValue2 == ""Correct"")
            {
                Score++;
            }
            string selectedValue3 = RadioButtonList3.SelectedValue;
            if (selectedValue3 == ""Correct"")
            {
                Score++;
            }
            string selectedValue4 = RadioButtonList4.SelectedValue;
            if (selectedValue4 == ""Correct"")
            {
                Score++;
            }
            string selectedValue5 = RadioButtonList5.SelectedValue;
            if (selectedValue5 == ""Correct"")
            {
                Score++;
            }
            string selectedValue6 = RadioButtonList6.SelectedValue;
            if (selectedValue6 == ""Correct"")
            {
                Score++;
            }
            string selectedValue7 = RadioButtonList7.SelectedValue;
            if (selectedValue7 == ""Correct"")
            {
                Score++;
            }
            string selectedValue8 = RadioButtonList8.SelectedValue;
            if (selectedValue8 == ""Correct"")
            {
                Score++;
            }
            string selectedValue9 = RadioButtonList9.SelectedValue;
            if (selectedValue9 == ""Correct"")
            {
                Score++;
            }
            string selectedValue10 = RadioButtonList10.SelectedValue;
            if (selectedValue10 == ""Correct"")
            {
                Score++;
            }
            Response.Write(Score);

        }
    &lt;/script&gt;
&lt;/asp:Content&gt;
</code></pre>",c#|asp.net,"<p>For the <code>Submit_Click</code> method, I would encourage you to have all your CheckBoxes in a List or Enumerable of some sort. Then you could iterate on this List and evaluate the Result in each iteration. Something in the lines of:</p>

<pre><code>protected void Submit_Click(object sender, EventArgs e)
{
     int score = 0;
     List&lt;RadioButtonList&gt; list = new List&lt;RadioButtonList&gt;() { RadioButtonList1, RadioButtonList2, ... RadioButtonList3 };
     foreach (var element in list) 
     {
        if (element.SelectedValue == ""correct"") {
            score++;
     }
     Response.Write(score);
}
</code></pre>",1
42952007,c# multiple choice test,"<p>working on creating a web based revision resource and i am trying to create a multiple choice quiz in c# with asp.net.
I have created it and got it working but it is very long and was wondering if anyone had an idea of how i could make the code more compact,
also when it prints the final score it appears above my nav bar on my website by i have no idea why.</p>

<p>in addition, the answers can be changed and the submit button just re clicked, i cannot for the love of anything find anything on how to stop this.</p>

<p>I am extremely new to everything and am trying my best. if someone could point me in the right direction or suggest something that might help that would be awesome.</p>

<p>Thanks</p>

<p>I appologise for the length of the code:</p>

<pre><code>&lt;asp:Content ID=""Content1"" ContentPlaceHolderID=""Head"" runat=""server""&gt;
&lt;/asp:Content&gt;
&lt;asp:Content ID=""Content2"" ContentPlaceHolderID=""Body"" runat=""server""&gt;
    &lt;asp:Label ID=""Label1"" runat=""server"" Text=""""&gt;&lt;/asp:Label&gt;


    &lt;asp:RadioButtonList ID=""RadioButtonList1"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList2"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList3"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList4"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList5"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList6"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList7"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList8"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList9"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;
    &lt;asp:RadioButtonList ID=""RadioButtonList10"" runat=""server""
        RepeatDirection=""Horizontal"" RepeatLayout=""Table""&gt;
        &lt;asp:ListItem Text=""*Answer 1*"" Value=""Incorrect 1"" /&gt;
        &lt;asp:ListItem Text=""*Answer 2*"" Value=""Correct"" /&gt;
        &lt;asp:ListItem Text=""*Answer 3*"" Value=""I"" /&gt;
        &lt;asp:ListItem Text=""*Answer 4*"" Value=""4"" /&gt;
    &lt;/asp:RadioButtonList&gt;

    &lt;asp:Button ID=""Button1"" runat=""server"" Text=""Submit Final Answers"" OnClick=""Submit_Click"" /&gt;
    &lt;script runat=""server""&gt;
        protected void Submit_Click(object sender, EventArgs e)
        {
            int Score = 0;
            string selectedValue1 = RadioButtonList1.SelectedValue;
            if (selectedValue1 == ""Correct"")
            {
                Score++;
            }
            string selectedValue2 = RadioButtonList2.SelectedValue;
            if (selectedValue2 == ""Correct"")
            {
                Score++;
            }
            string selectedValue3 = RadioButtonList3.SelectedValue;
            if (selectedValue3 == ""Correct"")
            {
                Score++;
            }
            string selectedValue4 = RadioButtonList4.SelectedValue;
            if (selectedValue4 == ""Correct"")
            {
                Score++;
            }
            string selectedValue5 = RadioButtonList5.SelectedValue;
            if (selectedValue5 == ""Correct"")
            {
                Score++;
            }
            string selectedValue6 = RadioButtonList6.SelectedValue;
            if (selectedValue6 == ""Correct"")
            {
                Score++;
            }
            string selectedValue7 = RadioButtonList7.SelectedValue;
            if (selectedValue7 == ""Correct"")
            {
                Score++;
            }
            string selectedValue8 = RadioButtonList8.SelectedValue;
            if (selectedValue8 == ""Correct"")
            {
                Score++;
            }
            string selectedValue9 = RadioButtonList9.SelectedValue;
            if (selectedValue9 == ""Correct"")
            {
                Score++;
            }
            string selectedValue10 = RadioButtonList10.SelectedValue;
            if (selectedValue10 == ""Correct"")
            {
                Score++;
            }
            Response.Write(Score);

        }
    &lt;/script&gt;
&lt;/asp:Content&gt;
</code></pre>",c#|asp.net,"<p>I do not have an exact solution but since you asked about being pointed to the right direction, here are the steps you should take:</p>

<ul>
<li>Create a User Control with a TextBox for question statement and a radio control list or anything for the choices, Also add a hidden field to put an identifier or something that identifies the question correctly. </li>
<li>On the main webpage either you use a Repeater control or Add the User Control dynamically with the data. </li>
<li>All the code for checking the correct Choice selection should be in the user control. </li>
<li>In the main form, when it is submitted, access each user control and collect the result.</li>
</ul>

<p>I made a similar app in ASP.NET webForms years ago but I had ""&lt;&lt; Back"" and ""Next >>"" buttons so on one page only one question was displayed and the whole app recorded time so when the test duration elapses it took the user to the end page.  </p>",0
43231720,ControllerContext throwing error in Parallel.ForEach in mvc c#,"<p>I have function which return string and it has parameter of ControllerContext and this is throwing error</p>

<p>Here is code</p>

<pre><code>        var cContext = ControllerContext;

       Parallel.ForEach(listInvHeaderIDs, x =&gt;         
       {

        body = new myClass().myFunctionReturnString(cContext);

       }
</code></pre>

<p>Can we use <strong>ControllerContext</strong> in Parallel.Foreach if not than what to use</p>",c#|asp.net-mvc,"<p>You can probably try this overload of the <code>Parallel.ForEach</code>:</p>

<pre><code>public static ParallelLoopResult ForEach&lt;TSource, TLocal&gt;(IEnumerable&lt;TSource&gt; source, 
      Func&lt;TLocal&gt; localInit, Func&lt;TSource, ParallelLoopState, TLocal, TLocal&gt; body,
      Action&lt;TLocal&gt; localFinally)
</code></pre>

<blockquote>
  <p>Executes a <code>foreach</code> operation with thread-local data on an <code>IEnumerable</code> in which iterations may run in parallel, and the state of the loop can be monitored and manipulated.</p>
</blockquote>

<p>An example of usage:</p>

<p><strong>UDPATE</strong>
I've updated the example, should be ok now.</p>

<pre><code>Parallel.ForEach(listInvHeaderIDs, () =&gt; {return cContext; }, 
(listId, loopInfo, ctrlContext) =&gt;            
{
    body = new myClass().myFunctionReturnString(ctrlContext);
    return ctrlContext;
}, 
(ctrlContext) =&gt; { /*access controller context if needed...*/} );
</code></pre>",-1
43006946,"what's going on here with content value, font awesome and unicode","<p>Having trouble with character types...</p>

<pre><code>protected void Page_Load(object sender, EventArgs e)
{
    char test = '\ue900'; //This makes test = 59648'.'
}
</code></pre>

<p>However, this doesn't work:</p>

<pre><code>protected void Page_Load(object sender, EventArgs e)
{        
    char test = '\f000'; 
    //This won't compile because squiggly on test says ""Too many characters in literal""        
    //However, this works when I put the value in CSS content attribute.
}
</code></pre>

<p>How do I make the latter fit into the test variable? I think in the first example, it's a unicode value and in the second it's not?</p>",c#|css|asp.net|font-awesome,"<p>I believe \f is form-feed, so it being suffixed exceeds the scope of a single char literal.</p>",0
43006946,"what's going on here with content value, font awesome and unicode","<p>Having trouble with character types...</p>

<pre><code>protected void Page_Load(object sender, EventArgs e)
{
    char test = '\ue900'; //This makes test = 59648'.'
}
</code></pre>

<p>However, this doesn't work:</p>

<pre><code>protected void Page_Load(object sender, EventArgs e)
{        
    char test = '\f000'; 
    //This won't compile because squiggly on test says ""Too many characters in literal""        
    //However, this works when I put the value in CSS content attribute.
}
</code></pre>

<p>How do I make the latter fit into the test variable? I think in the first example, it's a unicode value and in the second it's not?</p>",c#|css|asp.net|font-awesome,"<p><code>\u</code> is the notation of specifying a unicode character in the c#. The <code>\u</code> is followed by a hexadecimal value, more on that <a href=""https://msdn.microsoft.com/en-us/library/aa664669(v=vs.71).aspx"" rel=""nofollow noreferrer"">here</a></p>

<p>So first code compiles because you are specifying one character but in second code, you have 4 characters which are <code>\f</code> escape sequence and three zeroes. And that is why it doesn't compile.</p>",0
43316524,How to read and edit SQL views in C #,"<p>How to read and edit SQL view scripts in C #?</p>

<p>Or sqlserver in the system table storage view of the name and the corresponding view script, like sys.views this?</p>

<p>add:
In addition to through the sys.sp_helptext, C # have the corresponding method?</p>

<p>English comparison dishes, please forgive me.</p>",c#|sql,"<p>I use the sql script to handle it</p>

<p>SELECT * FROM sys.views</p>

<p>EXEC sys.sp_helptext @objname='viewname'</p>

<p>SELECT * FROM  syscomments  </p>",0
43316524,How to read and edit SQL views in C #,"<p>How to read and edit SQL view scripts in C #?</p>

<p>Or sqlserver in the system table storage view of the name and the corresponding view script, like sys.views this?</p>

<p>add:
In addition to through the sys.sp_helptext, C # have the corresponding method?</p>

<p>English comparison dishes, please forgive me.</p>",c#|sql,"<p>The programmatic way to generate scripts from a SQL Server database is contained within the SQL Management Objects (SMO).</p>

<p>There is a <a href=""https://msdn.microsoft.com/en-us/library/microsoft.sqlserver.management.smo.scripter.aspx"" rel=""nofollow noreferrer""><code>Scripter</code></a> class that will allow you to generate scripts for any objects, and allows you to specify the same options that are provided when scripting through SSMS.</p>

<p>SMO is usually installed with SQL Server and are also <a href=""https://www.microsoft.com/en-us/download/details.aspx?id=52676"" rel=""nofollow noreferrer"">available to redistribute</a>.</p>

<p>To apply changes back into the database, you merely need to run the script (or an edited version of it) using any normal SQL connection.</p>",2
43201599,Using an IQueryable in another IQueryable,"<p>I've an extension method, which returns an IQueryable, to get company products, I just want to use it in a IQueryable as a subquery,</p>

<pre><code>public static class DBEntitiesCompanyExtensions {
   public static IQueryable&lt;Product&gt; GetCompanyProducts(this DBEntities db, int companyId)
   {
      return db.Products.Where(m =&gt; m.CompanyId == companyId);
   }
}
</code></pre>

<p>And this is how I call it,</p>

<pre><code>using(var db = new DBEntities()) {
   var query = db.Companies.Select(m =&gt; new {
                CompanyName = m.Name,
                NumberOfProducts = db.GetCompanyProducts(m.CompanyId).Count()
   });    
}
</code></pre>

<p>I expected it to works beacuse my extension methods returns an IQueryable, so it could be used in a IQueryable, am I wrong?</p>

<p>This is what I get, Is that possible to make it work?</p>

<blockquote>
  <p>System.NotSupportedException: LINQ to Entities does not recognize the
  method 'System.Linq.IQueryable`1[WebProject.Models.Company]
  GetCompanyProducts(WebProject.Models.DBEntities, Int32)'
  method, and this method cannot be translated into a store expression.</p>
</blockquote>",c#|linq|linq-to-entities|iqueryable,"<p>Problem is not <code>IQueryable</code> inside <code>IQueryable</code>, because you can include subqueries just not the way you did.</p>

<p>In your example whole <code>Select</code> is represented as expression tree. In that expression tree there is something like :</p>

<pre><code>CALL method DBEntitiesCompanyExtensions.GetCompanyProducts
</code></pre>

<p>Now EF should somehow traslate this into SQL SELECT statement. It cannot do that, because it cannot ""look inside"" <code>GetCompanyProducts</code> method and see what is going on there. Nor can it execute this method and do anything with it's result. The fact it returns <code>IQueryable</code> does not help and is not related. </p>",1
58441077,Xamarin Forms - how to change the status bar color without a navigation page,"<p>I want to change the status bar color on some views.</p>

<p>I found this solution <a href=""https://github.com/yuv4ik/XFDynamicStatusBarAppearance"" rel=""nofollow noreferrer"">https://github.com/yuv4ik/XFDynamicStatusBarAppearance</a></p>

<p>but it's working only with NavigationPage.</p>

<p>I don't need from my app Navigation Page ...</p>

<pre><code>    public App()
    {
        InitializeComponent();

        MainPage = new MainPage();
    }
</code></pre>

<p>Here is my try ...</p>

<pre><code>    var statusBarStyleManager = DependencyService.Get&lt;IStatusBarStyleManager&gt;();

    MainCarousel.PositionChanged += (sender, e) =&gt;
    {
        switch (e.CurrentPosition)
        {
            case 1:
                Device.BeginInvokeOnMainThread(() =&gt;
                {
                    Xamarin.Forms.Application.Current.MainPage.SetValue(Xamarin.Forms.NavigationPage.BarBackgroundColorProperty, Color.DarkCyan);

                    //((Xamarin.Forms.NavigationPage)Xamarin.Forms.Application.Current.MainPage).BarBackgroundColor = Color.DarkCyan;
                    statusBarStyleManager.SetDarkTheme();
                });
                break;
            case 0:
            case 2:
                Device.BeginInvokeOnMainThread(() =&gt;
                {
                    Xamarin.Forms.Application.Current.MainPage.SetValue(Xamarin.Forms.NavigationPage.BarBackgroundColorProperty, Color.LightGreen);
                    statusBarStyleManager.SetLightTheme();
                });
                break;
            default:
                break;
        }

    };
</code></pre>

<p>How can i change the status bar color ?</p>",c#|xamarin|xamarin.forms|xamarin.android|xamarin.ios,"<p>You can try add this code in Android platform, OnCreate method:</p>

<pre><code> protected override void OnCreate(Bundle savedInstanceState)
    {
        TabLayoutResource = Resource.Layout.Tabbar;
        ToolbarResource = Resource.Layout.Toolbar;

        base.OnCreate(savedInstanceState);

        global::Xamarin.Forms.Forms.Init(this, savedInstanceState);

        LoadApplication(new App());
       Window.SetStatusBarColor(Android.Graphics.Color.Argb(255, 0, 0, 0)); //here

    }
</code></pre>

<p>Please note SetStatusBarColor is only supported in API level 21 and up. Therefore, we should check for this before calling SetStatusBarColor. </p>

<pre><code>if (Android.OS.Build.VERSION.SdkInt &gt;= BuildVersionCodes.Lollipop)

  {
   Window.SetStatusBarColor(...);
  }
</code></pre>

<p><strong>Update:</strong></p>

<p>Create interface in PCL:</p>

<pre><code>public  interface IStatusBarColor
{
    void changestatuscolor(string color);
}
</code></pre>

<p>Now, Mainactivity implement this interface.</p>

<pre><code>[assembly: Dependency(typeof(demo2.Droid.MainActivity))]
 namespace demo2.Droid
 {
[Activity(Label = ""demo2"", Icon = ""@mipmap/icon"", Theme = ""@style/MainTheme"", MainLauncher = true, ConfigurationChanges = ConfigChanges.ScreenSize | ConfigChanges.Orientation)]
public class MainActivity : global::Xamarin.Forms.Platform.Android.FormsAppCompatActivity,IStatusBarColor
{

    public static Context context;
    protected override void OnCreate(Bundle savedInstanceState)
    {
        TabLayoutResource = Resource.Layout.Tabbar;
        ToolbarResource = Resource.Layout.Toolbar;

        base.OnCreate(savedInstanceState);

        global::Xamarin.Forms.Forms.Init(this, savedInstanceState);

        LoadApplication(new App());

    }



    public void changestatuscolor(string color)
    {
        if (Build.VERSION.SdkInt &gt;= BuildVersionCodes.Lollipop)
        {
            var c = MainActivity.context as FormsAppCompatActivity;
            c?.RunOnUiThread(() =&gt; c.Window.SetStatusBarColor(Android.Graphics.Color.ParseColor(color)));
        }

    }
    protected override void OnResume()
    {
        context = this;
        base.OnResume();
    }

}
</code></pre>

<p>}</p>

<p>In Mainpage, to change status bar color in Button click event.</p>

<pre><code> private void Changecolor_Clicked(object sender, EventArgs e)
    {
        DependencyService.Get&lt;IStatusBarColor&gt;().changestatuscolor(Color.Red.ToHex());
    }
</code></pre>

<p><a href=""https://i.stack.imgur.com/jph6c.gif"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/jph6c.gif"" alt=""enter image description here""></a></p>",1
58441077,Xamarin Forms - how to change the status bar color without a navigation page,"<p>I want to change the status bar color on some views.</p>

<p>I found this solution <a href=""https://github.com/yuv4ik/XFDynamicStatusBarAppearance"" rel=""nofollow noreferrer"">https://github.com/yuv4ik/XFDynamicStatusBarAppearance</a></p>

<p>but it's working only with NavigationPage.</p>

<p>I don't need from my app Navigation Page ...</p>

<pre><code>    public App()
    {
        InitializeComponent();

        MainPage = new MainPage();
    }
</code></pre>

<p>Here is my try ...</p>

<pre><code>    var statusBarStyleManager = DependencyService.Get&lt;IStatusBarStyleManager&gt;();

    MainCarousel.PositionChanged += (sender, e) =&gt;
    {
        switch (e.CurrentPosition)
        {
            case 1:
                Device.BeginInvokeOnMainThread(() =&gt;
                {
                    Xamarin.Forms.Application.Current.MainPage.SetValue(Xamarin.Forms.NavigationPage.BarBackgroundColorProperty, Color.DarkCyan);

                    //((Xamarin.Forms.NavigationPage)Xamarin.Forms.Application.Current.MainPage).BarBackgroundColor = Color.DarkCyan;
                    statusBarStyleManager.SetDarkTheme();
                });
                break;
            case 0:
            case 2:
                Device.BeginInvokeOnMainThread(() =&gt;
                {
                    Xamarin.Forms.Application.Current.MainPage.SetValue(Xamarin.Forms.NavigationPage.BarBackgroundColorProperty, Color.LightGreen);
                    statusBarStyleManager.SetLightTheme();
                });
                break;
            default:
                break;
        }

    };
</code></pre>

<p>How can i change the status bar color ?</p>",c#|xamarin|xamarin.forms|xamarin.android|xamarin.ios,"<p>Here is my working solution on both platforms ...</p>

<pre><code>public interface IStatusBarStyleManager
{
    void SetColoredStatusBar(string hexColor);
    void SetWhiteStatusBar();
}
</code></pre>

<p>Setup the Status bar color with this line </p>

<pre><code>DependencyService.Get&lt;IStatusBarStyleManager&gt;().SetColoredStatusBar(""#2196F3"");
</code></pre>

<p>or you can keep it white with black font color</p>

<pre><code>DependencyService.Get&lt;IStatusBarStyleManager&gt;().SetWhiteStatusBar();
</code></pre>

<blockquote>
  <p>Android</p>
</blockquote>

<pre><code>[assembly: Xamarin.Forms.Dependency(typeof(StatusBarStyleManager))]
namespace ShaXam.Droid.DependencyServices
{
    public class StatusBarStyleManager : IStatusBarStyleManager
    {
        public void SetColoredStatusBar(string hexColor)
        {
            if (Build.VERSION.SdkInt &gt;= BuildVersionCodes.M)
            {
                Device.BeginInvokeOnMainThread(() =&gt;
                {
                    var currentWindow = GetCurrentWindow();
                    currentWindow.DecorView.SystemUiVisibility = 0;
                    currentWindow.SetStatusBarColor(Android.Graphics.Color.ParseColor(hexColor);
                });
            }
        }

        public void SetWhiteStatusBar()
        {
            if (Build.VERSION.SdkInt &gt;= BuildVersionCodes.M)
            {
                Device.BeginInvokeOnMainThread(() =&gt;
                {
                    var currentWindow = GetCurrentWindow();
                    currentWindow.DecorView.SystemUiVisibility = (StatusBarVisibility)SystemUiFlags.LightStatusBar;
                    currentWindow.SetStatusBarColor(Android.Graphics.Color.White);
                });
            }
        }

        Window GetCurrentWindow()
        {
            var window = CrossCurrentActivity.Current.Activity.Window;

            // clear FLAG_TRANSLUCENT_STATUS flag:
            window.ClearFlags(WindowManagerFlags.TranslucentStatus);

            // add FLAG_DRAWS_SYSTEM_BAR_BACKGROUNDS flag to the window
            window.AddFlags(WindowManagerFlags.DrawsSystemBarBackgrounds);

            return window;
        }
    }
}
</code></pre>

<blockquote>
  <p>iOS</p>
</blockquote>

<pre><code>[assembly: Dependency(typeof(StatusBarStyleManager))]
namespace ShaXam.iOS.DependencyServices
{
    public class StatusBarStyleManager : IStatusBarStyleManager
    {
        public void SetColoredStatusBar(string hexColor)
        {
            Device.BeginInvokeOnMainThread(() =&gt;
            {
                UIView statusBar = UIApplication.SharedApplication.ValueForKey(new NSString(""statusBar"")) as UIView;
                if (statusBar.RespondsToSelector(new ObjCRuntime.Selector(""setBackgroundColor:"")))
                {
                    statusBar.BackgroundColor = Color.FromHex(hexColor).ToUIColor();
                }
                UIApplication.SharedApplication.SetStatusBarStyle(UIStatusBarStyle.LightContent, false);
                GetCurrentViewController().SetNeedsStatusBarAppearanceUpdate();
            });
        }

        public void SetWhiteStatusBar()
        {
            Device.BeginInvokeOnMainThread(() =&gt;
            {
                UIView statusBar = UIApplication.SharedApplication.ValueForKey(new NSString(""statusBar"")) as UIView;
                if (statusBar.RespondsToSelector(new ObjCRuntime.Selector(""setBackgroundColor:"")))
                {
                    statusBar.BackgroundColor = UIColor.White;
                }
                UIApplication.SharedApplication.SetStatusBarStyle(UIStatusBarStyle.Default, false);
                GetCurrentViewController().SetNeedsStatusBarAppearanceUpdate();
            });
        }

        UIViewController GetCurrentViewController()
        {
            var window = UIApplication.SharedApplication.KeyWindow;
            var vc = window.RootViewController;
            while (vc.PresentedViewController != null)
                vc = vc.PresentedViewController;
            return vc;
        }
    }
}
</code></pre>

<p>The full working sample is here <a href=""https://github.com/georgemichailou/ShaXam"" rel=""nofollow noreferrer"">https://github.com/georgemichailou/ShaXam</a></p>",1
58702588,Error in Service IUserStore being created in Identity Asp.net core 3 MVC,"<p><strong>Update</strong></p>

<p>See Update below.</p>

<p>I have asked a <a href=""https://stackoverflow.com/questions/58654400/store-does-not-implement-iuserrolestoretuser-usermanagertuser-getuserrolesto"">previous stackoverflow question</a> very recently, but  I face an issue after implementing the suggested solutions from the following 2 places <a href=""https://docs.microsoft.com/en-us/aspnet/core/security/authentication/customize-identity-model?view=aspnetcore-3.0"" rel=""nofollow noreferrer"">Identity model customization in ASP.NET Core</a> and <a href=""https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity-custom-storage-providers?view=aspnetcore-3.0"" rel=""nofollow noreferrer"">Custom storage providers for ASP.NET Core Identity</a>. I am just not able to get the solution to work. I have implemented the extension of <code>IdentityUser</code> as recommended and the extension of <code>IdentityRole</code>.   I have implemented <code>IUserPasswordStore</code> and <code>IUserRoleStore</code> and <code>IUserStore</code> for <code>UserStore</code> and I have implemented <code>IRoleStore</code> for <code>RoleStore</code>. I have also implemented the new dbContext <code>ApplicationDbContext</code> which implements <code>IdentityDbContext</code>. There was an issue with this with the constructor not accepting a parameter so I implemented a new constructor. I am not sure if this is right. </p>

<p>However that appears to be irrelevant because I get the error in the Main method of Program.cs when calling </p>

<pre><code>CreateHostBuilder(args).Build().Run(); 
</code></pre>

<p>And the error is massive. I have placed it at the end. Searching the parts of the error online does not provide any ideas as to what I am doing, and as I am new to ASP.NET Core 3 and Identity I am stumped.</p>

<p>Here is the code I have so far.</p>

<p><strong>ConfigureServices</strong> method</p>

<pre><code>public void ConfigureServices(IServiceCollection services)
    {
        services.AddControllersWithViews();
        services.AddMvc(options =&gt;
        {
            var policy = new AuthorizationPolicyBuilder().RequireAuthenticatedUser().Build();
            options.Filters.Add(new AuthorizeFilter(policy));
        options.EnableEndpointRouting = false;
        });

        services.AddDbContext&lt;EntitiesModel&gt;(options =&gt; options.UseSqlServer(
            Configuration[""Data:ConnectionStrings:XXXXDbConnection""]));
        services.AddIdentity&lt;UserViewModel,RoleViewModel&gt;().AddEntityFrameworkStores&lt;ApplicationDbContext&gt;()
            .AddDefaultTokenProviders().AddRoles&lt;RoleViewModel&gt;(); ;
        services.AddTransient&lt;IUserStore&lt;UserViewModel&gt;, UserStore&gt;();
        services.AddTransient&lt;IRoleStore&lt;RoleViewModel&gt;, RoleStore&gt;();
        services.ConfigureApplicationCookie(options =&gt;
        {
            options.LoginPath = ""/Login"";
            options.LogoutPath = ""/Logout"";
        });
    }
</code></pre>

<p><strong>ApplicationDbContext</strong> - these are all in the same namespace</p>

<pre><code>public class IdentityDbContext
    : IdentityDbContext&lt;IdentityUser, IdentityRole, string&gt;
{
    public IdentityDbContext(DbContextOptions&lt;ApplicationDbContext&gt; options) : base(options)
    {
    }
}

public class IdentityDbContext&lt;TUser&gt;
    : IdentityDbContext&lt;TUser, IdentityRole, string&gt;
    where TUser : IdentityUser
{
    public IdentityDbContext(DbContextOptions&lt;ApplicationDbContext&gt; options) : base(options)
    {
    }
}

// Uses the built-in Identity types except with custom User and Role types
// The key type is defined by TKey
public class IdentityDbContext&lt;TUser, TRole, TKey&gt; : IdentityDbContext&lt;
    TUser, TRole, TKey, IdentityUserClaim&lt;TKey&gt;, IdentityUserRole&lt;TKey&gt;,
    IdentityUserLogin&lt;TKey&gt;, IdentityRoleClaim&lt;TKey&gt;, IdentityUserToken&lt;TKey&gt;&gt;
    where TUser : IdentityUser&lt;TKey&gt;
    where TRole : IdentityRole&lt;TKey&gt;
    where TKey : IEquatable&lt;TKey&gt;
{
    private DbContextOptions&lt;ApplicationDbContext&gt; options;
    //private string nameOrConnectionString;

    public IdentityDbContext(DbContextOptions&lt;ApplicationDbContext&gt; options)
    {
        this.options = options;
    }

}

public abstract class IdentityDbContext&lt;
        TUser, TRole, TKey, TUserClaim, TUserRole, TUserLogin, TRoleClaim, TUserToken&gt;
    : IdentityUserContext&lt;TUser, TKey&gt;
    where TUser : IdentityUser&lt;TKey&gt;
    where TRole : IdentityRole&lt;TKey&gt;
    where TKey : IEquatable&lt;TKey&gt;
    where TUserRole : IdentityUserRole&lt;TKey&gt;
{

}
public class ApplicationDbContext : IdentityDbContext&lt;UserViewModel,RoleViewModel,int&gt;
{
    public ApplicationDbContext(DbContextOptions&lt;ApplicationDbContext&gt; options)
        : base(options)
    {
    }

    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);

        modelBuilder.Entity&lt;UserViewModel&gt;(b =&gt;
        {               
            b.HasMany(e =&gt; e.UserRoles)
                .WithOne()
                .HasForeignKey(ur =&gt; ur.Id)
                .IsRequired();
        });
        modelBuilder.Entity&lt;UserViewModel&gt;(b =&gt;
        {
            b.ToTable(""T_CustomerContacts"");
        });
        modelBuilder.Entity&lt;RoleViewModel&gt;(b =&gt;
        {
            b.ToTable(""T_LoginRoles"");
        });
        modelBuilder.Entity&lt;UserRoleViewModel&gt;(b =&gt;
        {
            b.ToTable(""T_CustomerContactRole"");
        });         
        modelBuilder.Entity&lt;RoleViewModel&gt;(b =&gt;
        {
            b.HasMany(e =&gt; e.UserRoles)
                .WithOne(e =&gt; e.Role)
                .HasForeignKey(ur =&gt; ur.RoleId)
                .IsRequired();
        });
    }
}
</code></pre>

<p><strong>UserViewModel</strong></p>

<pre><code>public class UserViewModel : IdentityUser&lt;int&gt;
{
</code></pre>

<p><strong>UserRoleViewModel</strong></p>

<pre><code>public class UserRoleViewModel : IdentityUserRole&lt;int&gt;
{
</code></pre>

<p><strong>RoleViewModel</strong></p>

<pre><code>public class RoleViewModel : IdentityRole&lt;int&gt;
{   
</code></pre>

<p><strong>RoleStore</strong></p>

<pre><code>public class RoleStore : IRoleStore&lt;RoleViewModel&gt;
{
</code></pre>

<p><strong>UserStore</strong></p>

<pre><code>public class UserStore : IUserStore&lt;UserViewModel&gt;, IUserPasswordStore&lt;UserViewModel&gt;, IUserRoleStore&lt;UserRoleViewModel&gt;
{
</code></pre>

<p>I have to add that this is the final configuration I have tried. I have tried many combinations and solutions.
Part of the error is as follows</p>

<blockquote>
  <p>An error occurred while starting the application.
  AggregateException: Some services are not able to be constructed (Error while validating the service descriptor 'ServiceType: Microsoft.AspNetCore.Identity.IUserStore<code>1[TrussCorp.CustomerPortal.Models.ViewModel.Identity.UserViewModel] Lifetime: Scoped ImplementationType: Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore</code>4[TrussCorp.CustomerPortal.Models.ViewModel.Identity.UserViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.RoleViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext,System.Int32]': Unable to resolve service for type 'TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext' while attempting to activate 'Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore<code>4[TrussCorp.CustomerPortal.Models.ViewModel.Identity.UserViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.RoleViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext,System.Int32]'.) (Error while validating the service descriptor 'ServiceType: Microsoft.AspNetCore.Identity.IRoleStore</code>1[TrussCorp.CustomerPortal.Models.ViewModel.Identity.RoleViewModel] Lifetime: Scoped ImplementationType: Microsoft.AspNetCore.Identity.EntityFrameworkCore.RoleStore<code>3[TrussCorp.CustomerPortal.Models.ViewModel.Identity.RoleViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext,System.Int32]': Unable to resolve service for type 'TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext' while attempting to activate 'Microsoft.AspNetCore.Identity.EntityFrameworkCore.RoleStore</code>3[TrussCorp.CustomerPortal.Models.ViewModel.Identity.RoleViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext,System.Int32]'.)
  Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(IEnumerable serviceDescriptors, ServiceProviderOptions options)</p>
</blockquote>

<p><strong>Update</strong></p>

<p>I am back to where I began with the previous question and but solved the above error by reversing the orders of the following</p>

<pre><code>    services.AddTransient&lt;IUserStore&lt;UserViewModel&gt;, UserStore&gt;();
        services.AddTransient&lt;IRoleStore&lt;RoleViewModel&gt;, TrussCorp.CustomerPortal.Identity.RoleStore&gt;();
        services.AddIdentity&lt;UserViewModel,RoleViewModel&gt;().AddEntityFrameworkStores&lt;ApplicationDbContext&gt;()
            .AddDefaultTokenProviders().AddRoles&lt;RoleViewModel&gt;();
</code></pre>

<p>But as stated now I am getting <a href=""https://stackoverflow.com/questions/58654400/store-does-not-implement-iuserrolestoretuser-usermanagertuser-getuserrolesto"">Store does not implement IUserRoleStore UserManager.GetUserRoleStore()</a> error which has put me back to square one.</p>",c#|asp.net-core|asp.net-core-mvc|asp.net-core-identity,"<p>Can you try instead adding this in the top perhaps?</p>

<pre><code>services.AddIdentity&lt;UserViewModel,RoleViewModel&gt;().AddUserStore&lt;UserStore&gt;().AddRoleStore&lt;RoleStore&gt;();
</code></pre>",0
58702588,Error in Service IUserStore being created in Identity Asp.net core 3 MVC,"<p><strong>Update</strong></p>

<p>See Update below.</p>

<p>I have asked a <a href=""https://stackoverflow.com/questions/58654400/store-does-not-implement-iuserrolestoretuser-usermanagertuser-getuserrolesto"">previous stackoverflow question</a> very recently, but  I face an issue after implementing the suggested solutions from the following 2 places <a href=""https://docs.microsoft.com/en-us/aspnet/core/security/authentication/customize-identity-model?view=aspnetcore-3.0"" rel=""nofollow noreferrer"">Identity model customization in ASP.NET Core</a> and <a href=""https://docs.microsoft.com/en-us/aspnet/core/security/authentication/identity-custom-storage-providers?view=aspnetcore-3.0"" rel=""nofollow noreferrer"">Custom storage providers for ASP.NET Core Identity</a>. I am just not able to get the solution to work. I have implemented the extension of <code>IdentityUser</code> as recommended and the extension of <code>IdentityRole</code>.   I have implemented <code>IUserPasswordStore</code> and <code>IUserRoleStore</code> and <code>IUserStore</code> for <code>UserStore</code> and I have implemented <code>IRoleStore</code> for <code>RoleStore</code>. I have also implemented the new dbContext <code>ApplicationDbContext</code> which implements <code>IdentityDbContext</code>. There was an issue with this with the constructor not accepting a parameter so I implemented a new constructor. I am not sure if this is right. </p>

<p>However that appears to be irrelevant because I get the error in the Main method of Program.cs when calling </p>

<pre><code>CreateHostBuilder(args).Build().Run(); 
</code></pre>

<p>And the error is massive. I have placed it at the end. Searching the parts of the error online does not provide any ideas as to what I am doing, and as I am new to ASP.NET Core 3 and Identity I am stumped.</p>

<p>Here is the code I have so far.</p>

<p><strong>ConfigureServices</strong> method</p>

<pre><code>public void ConfigureServices(IServiceCollection services)
    {
        services.AddControllersWithViews();
        services.AddMvc(options =&gt;
        {
            var policy = new AuthorizationPolicyBuilder().RequireAuthenticatedUser().Build();
            options.Filters.Add(new AuthorizeFilter(policy));
        options.EnableEndpointRouting = false;
        });

        services.AddDbContext&lt;EntitiesModel&gt;(options =&gt; options.UseSqlServer(
            Configuration[""Data:ConnectionStrings:XXXXDbConnection""]));
        services.AddIdentity&lt;UserViewModel,RoleViewModel&gt;().AddEntityFrameworkStores&lt;ApplicationDbContext&gt;()
            .AddDefaultTokenProviders().AddRoles&lt;RoleViewModel&gt;(); ;
        services.AddTransient&lt;IUserStore&lt;UserViewModel&gt;, UserStore&gt;();
        services.AddTransient&lt;IRoleStore&lt;RoleViewModel&gt;, RoleStore&gt;();
        services.ConfigureApplicationCookie(options =&gt;
        {
            options.LoginPath = ""/Login"";
            options.LogoutPath = ""/Logout"";
        });
    }
</code></pre>

<p><strong>ApplicationDbContext</strong> - these are all in the same namespace</p>

<pre><code>public class IdentityDbContext
    : IdentityDbContext&lt;IdentityUser, IdentityRole, string&gt;
{
    public IdentityDbContext(DbContextOptions&lt;ApplicationDbContext&gt; options) : base(options)
    {
    }
}

public class IdentityDbContext&lt;TUser&gt;
    : IdentityDbContext&lt;TUser, IdentityRole, string&gt;
    where TUser : IdentityUser
{
    public IdentityDbContext(DbContextOptions&lt;ApplicationDbContext&gt; options) : base(options)
    {
    }
}

// Uses the built-in Identity types except with custom User and Role types
// The key type is defined by TKey
public class IdentityDbContext&lt;TUser, TRole, TKey&gt; : IdentityDbContext&lt;
    TUser, TRole, TKey, IdentityUserClaim&lt;TKey&gt;, IdentityUserRole&lt;TKey&gt;,
    IdentityUserLogin&lt;TKey&gt;, IdentityRoleClaim&lt;TKey&gt;, IdentityUserToken&lt;TKey&gt;&gt;
    where TUser : IdentityUser&lt;TKey&gt;
    where TRole : IdentityRole&lt;TKey&gt;
    where TKey : IEquatable&lt;TKey&gt;
{
    private DbContextOptions&lt;ApplicationDbContext&gt; options;
    //private string nameOrConnectionString;

    public IdentityDbContext(DbContextOptions&lt;ApplicationDbContext&gt; options)
    {
        this.options = options;
    }

}

public abstract class IdentityDbContext&lt;
        TUser, TRole, TKey, TUserClaim, TUserRole, TUserLogin, TRoleClaim, TUserToken&gt;
    : IdentityUserContext&lt;TUser, TKey&gt;
    where TUser : IdentityUser&lt;TKey&gt;
    where TRole : IdentityRole&lt;TKey&gt;
    where TKey : IEquatable&lt;TKey&gt;
    where TUserRole : IdentityUserRole&lt;TKey&gt;
{

}
public class ApplicationDbContext : IdentityDbContext&lt;UserViewModel,RoleViewModel,int&gt;
{
    public ApplicationDbContext(DbContextOptions&lt;ApplicationDbContext&gt; options)
        : base(options)
    {
    }

    protected override void OnModelCreating(ModelBuilder modelBuilder)
    {
        base.OnModelCreating(modelBuilder);

        modelBuilder.Entity&lt;UserViewModel&gt;(b =&gt;
        {               
            b.HasMany(e =&gt; e.UserRoles)
                .WithOne()
                .HasForeignKey(ur =&gt; ur.Id)
                .IsRequired();
        });
        modelBuilder.Entity&lt;UserViewModel&gt;(b =&gt;
        {
            b.ToTable(""T_CustomerContacts"");
        });
        modelBuilder.Entity&lt;RoleViewModel&gt;(b =&gt;
        {
            b.ToTable(""T_LoginRoles"");
        });
        modelBuilder.Entity&lt;UserRoleViewModel&gt;(b =&gt;
        {
            b.ToTable(""T_CustomerContactRole"");
        });         
        modelBuilder.Entity&lt;RoleViewModel&gt;(b =&gt;
        {
            b.HasMany(e =&gt; e.UserRoles)
                .WithOne(e =&gt; e.Role)
                .HasForeignKey(ur =&gt; ur.RoleId)
                .IsRequired();
        });
    }
}
</code></pre>

<p><strong>UserViewModel</strong></p>

<pre><code>public class UserViewModel : IdentityUser&lt;int&gt;
{
</code></pre>

<p><strong>UserRoleViewModel</strong></p>

<pre><code>public class UserRoleViewModel : IdentityUserRole&lt;int&gt;
{
</code></pre>

<p><strong>RoleViewModel</strong></p>

<pre><code>public class RoleViewModel : IdentityRole&lt;int&gt;
{   
</code></pre>

<p><strong>RoleStore</strong></p>

<pre><code>public class RoleStore : IRoleStore&lt;RoleViewModel&gt;
{
</code></pre>

<p><strong>UserStore</strong></p>

<pre><code>public class UserStore : IUserStore&lt;UserViewModel&gt;, IUserPasswordStore&lt;UserViewModel&gt;, IUserRoleStore&lt;UserRoleViewModel&gt;
{
</code></pre>

<p>I have to add that this is the final configuration I have tried. I have tried many combinations and solutions.
Part of the error is as follows</p>

<blockquote>
  <p>An error occurred while starting the application.
  AggregateException: Some services are not able to be constructed (Error while validating the service descriptor 'ServiceType: Microsoft.AspNetCore.Identity.IUserStore<code>1[TrussCorp.CustomerPortal.Models.ViewModel.Identity.UserViewModel] Lifetime: Scoped ImplementationType: Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore</code>4[TrussCorp.CustomerPortal.Models.ViewModel.Identity.UserViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.RoleViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext,System.Int32]': Unable to resolve service for type 'TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext' while attempting to activate 'Microsoft.AspNetCore.Identity.EntityFrameworkCore.UserStore<code>4[TrussCorp.CustomerPortal.Models.ViewModel.Identity.UserViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.RoleViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext,System.Int32]'.) (Error while validating the service descriptor 'ServiceType: Microsoft.AspNetCore.Identity.IRoleStore</code>1[TrussCorp.CustomerPortal.Models.ViewModel.Identity.RoleViewModel] Lifetime: Scoped ImplementationType: Microsoft.AspNetCore.Identity.EntityFrameworkCore.RoleStore<code>3[TrussCorp.CustomerPortal.Models.ViewModel.Identity.RoleViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext,System.Int32]': Unable to resolve service for type 'TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext' while attempting to activate 'Microsoft.AspNetCore.Identity.EntityFrameworkCore.RoleStore</code>3[TrussCorp.CustomerPortal.Models.ViewModel.Identity.RoleViewModel,TrussCorp.CustomerPortal.Models.ViewModel.Identity.ApplicationDbContext,System.Int32]'.)
  Microsoft.Extensions.DependencyInjection.ServiceProvider..ctor(IEnumerable serviceDescriptors, ServiceProviderOptions options)</p>
</blockquote>

<p><strong>Update</strong></p>

<p>I am back to where I began with the previous question and but solved the above error by reversing the orders of the following</p>

<pre><code>    services.AddTransient&lt;IUserStore&lt;UserViewModel&gt;, UserStore&gt;();
        services.AddTransient&lt;IRoleStore&lt;RoleViewModel&gt;, TrussCorp.CustomerPortal.Identity.RoleStore&gt;();
        services.AddIdentity&lt;UserViewModel,RoleViewModel&gt;().AddEntityFrameworkStores&lt;ApplicationDbContext&gt;()
            .AddDefaultTokenProviders().AddRoles&lt;RoleViewModel&gt;();
</code></pre>

<p>But as stated now I am getting <a href=""https://stackoverflow.com/questions/58654400/store-does-not-implement-iuserrolestoretuser-usermanagertuser-getuserrolesto"">Store does not implement IUserRoleStore UserManager.GetUserRoleStore()</a> error which has put me back to square one.</p>",c#|asp.net-core|asp.net-core-mvc|asp.net-core-identity,"<p>My advice to other Developers is if you can not find a similar problem on the internet, you are doing something silly and unique.</p>

<p>The solution was to change this </p>

<pre><code>public class UserStore : IUserStore&lt;UserViewModel&gt;, IUserPasswordStore&lt;UserViewModel&gt;, IUserRoleStore&lt;UserRoleViewModel&gt;
{
</code></pre>

<p>to this </p>

<pre><code>public class UserStore : IUserStore&lt;UserViewModel&gt;, IUserPasswordStore&lt;UserViewModel&gt;, IUserRoleStore&lt;UserViewModel&gt;
{
</code></pre>",2
58495935,How would I represent the following JSON layout as a C# object?,"<p>I am a little confused as to how to represent this as a C# class. I want to deserialize the below JSON file into a C# class.</p>

<p>I have an idea but kind of lost looking at, I think I am missing the idea a little!</p>

<p>I have this so far:</p>

<pre><code>public class CountrySetting
{
   public string Name {get;set;}
   public string Flag {get;set;}
}

public class Setting
{
   public string Type {get;set;}
   public string Id {get;set;}
   public List&lt;LabelSetting&gt; Label {get;set;}
}

public class LabelSetting 
{
   public string Key {get;set;}
   public string Value {get;set;}
}
</code></pre>

<p>The JSON layout is:</p>

<pre><code>[
  {
    ""name"": ""USA"",
    ""flag"": ""usa.jpg"",    
  },
  {
    ""name"": {      
      ""en"": ""Layout"",
      ""es"": ""Diseño""      
    },
    ""settings"": [
      {
        ""type"": ""checkbox"",
        ""id"": ""enabled"",
        ""label"": {
          ""en"": ""Please Select One or More""          
        }
      }
    ]
  }    
]
</code></pre>",c#|json,"<p>The <code>name</code> property of the first item in the array is a different kind of object to what it is in the 2nd object.</p>

<pre><code>[
  {
    ""name"": ""USA"",
    (...)
  },
  {
    ""name"": {      
      ""en"": ""Layout"",
      ""es"": ""Diseño""      
    },
    (...)
  }    
]
</code></pre>

<p>While this is valid json you cannot deserialise it to one class.
You can still get the values though.</p>

<pre><code>using Newtonsoft.Json.Linq;
(...)

var jArr = JArray.Parse(json);
var one = jArr[0].ToObject&lt;Type1&gt;();
var two = jArr[1].ToObject&lt;Type2&gt;();
</code></pre>

<hr>

<h1>Models</h1>

<pre><code> public class Country
    {
        public string name { get; set; }
        public string flag { get; set; }
    }

    public class Name
    {
        public string en { get; set; }
        public string es { get; set; }
    }

    public class Label
    {
        public string en { get; set; }
    }

    public class Setting
    {
        public string type { get; set; }
        public string id { get; set; }
        public Label label { get; set; }
    }

    public class Something
    {
        public Name name { get; set; }
        public List&lt;Setting&gt; settings { get; set; }
    }

</code></pre>

<h1>Test code</h1>

<pre><code>public static async Task Main(string[] args)
    {

        var json = @""[
  {
    """"name"""": """"USA"""",
    """"flag"""": """"usa.jpg"""",    
  },
  {
    """"name"""": {      
      """"en"""": """"Layout"""",
      """"es"""": """"Diseño""""      
    },
    """"settings"""": [
      {
        """"type"""": """"checkbox"""",
        """"id"""": """"enabled"""",
        """"label"""": {
          """"en"""": """"Please Select One or More""""          
        }
      }
    ]
  }    
]"";

        var jArr = JArray.Parse(json);
        var c = jArr[0].ToObject&lt;Country&gt;();
        var s = jArr[1].ToObject&lt;Something&gt;();

        Console.WriteLine(c.flag);
        Console.WriteLine(s.name.es);
        Console.WriteLine(s.settings[0].label.en);
    }
</code></pre>

<p>Result</p>

<pre><code>usa.jpg
Diseño
Please Select One or More
</code></pre>

<p>I used <a href=""http://json2csharp.com/"" rel=""nofollow noreferrer"">http://json2csharp.com/</a> to create the objects. You can use <a href=""https://app.quicktype.io/#l=cs&amp;r=json2csharp"" rel=""nofollow noreferrer"">https://app.quicktype.io/#l=cs&amp;r=json2csharp</a> to create both models with C# capitalisation.</p>

<p>For exemple:</p>

<pre><code>public partial class Country
    {
        [JsonProperty(""name"")]
        public string Name { get; set; }

        [JsonProperty(""flag"")]
        public string Flag { get; set; }
    }
</code></pre>",2
58495935,How would I represent the following JSON layout as a C# object?,"<p>I am a little confused as to how to represent this as a C# class. I want to deserialize the below JSON file into a C# class.</p>

<p>I have an idea but kind of lost looking at, I think I am missing the idea a little!</p>

<p>I have this so far:</p>

<pre><code>public class CountrySetting
{
   public string Name {get;set;}
   public string Flag {get;set;}
}

public class Setting
{
   public string Type {get;set;}
   public string Id {get;set;}
   public List&lt;LabelSetting&gt; Label {get;set;}
}

public class LabelSetting 
{
   public string Key {get;set;}
   public string Value {get;set;}
}
</code></pre>

<p>The JSON layout is:</p>

<pre><code>[
  {
    ""name"": ""USA"",
    ""flag"": ""usa.jpg"",    
  },
  {
    ""name"": {      
      ""en"": ""Layout"",
      ""es"": ""Diseño""      
    },
    ""settings"": [
      {
        ""type"": ""checkbox"",
        ""id"": ""enabled"",
        ""label"": {
          ""en"": ""Please Select One or More""          
        }
      }
    ]
  }    
]
</code></pre>",c#|json,"<p>You have some progress there. Taking your class configuration I will propose this:</p>

<pre><code>public class Country
{
    public string Name { get; set; }
    public string Flag { get; set; }
}

public class LabelSetting
{
    public List&lt;string&gt; Name { get; set; }
    public List&lt;Settings&gt; SettingsList { get; set; }
}

public class Settings
{
    public string Type { get; set; }
    public string Id { get; set; }
    public List&lt;string&gt; Label { get; set; }
}
</code></pre>

<p>The main class that at the end would be serialized/deserialized:</p>

<pre><code>[Serializable]
public class Country
{
    public Country CountryProperty { get; set; }
    public LabelSetting LabelSettingProperty { get; set; }
}
</code></pre>

<p>As the previous response you got, use the JsonConvert methods. It is the best way to go.</p>

<p>Regards,</p>",-1
31726132,Button to call javascript with programmatical parameter,"<p>I have some code on my view which works fine:</p>

<pre><code>&lt;button id=""foo"" onclick=""myMethod('false', 'true');return false;"" class=""btn btn-large btn-primary pull-right"" style=""margin-bottom:10px;"" type=""button""&gt;Not Present&lt;/button&gt;
</code></pre>

<p>In some circumstances I want to change the parameters passed to myMethod, but when I try:</p>

<pre><code>&lt;button id=""foo"" onclick=""myMethod('false', @Status);return false;"" class=""btn btn-large btn-primary pull-right"" style=""margin-bottom:10px;"" type=""button""&gt;Not Present&lt;/button&gt;
</code></pre>

<p>I get a warning of Invalid Character in the error list, and if I run it, then I have a blank space instead of the second paramter.</p>

<p>I could modify the code to have an if block:</p>

<pre><code>@if{Status}
  .... Button with true parameter
else
  ....Button with false parameter
</code></pre>

<p>But that seems a bit off. So what is the syntax for mixing an @Parameter in with parameters for a javascript function call?</p>",c#|razor|model-view-controller,"<p>Please use jquery to solve your problem i made this for you if it is not solving your problem please let me know ...</p>

<pre><code>&lt;button id=""foo"" class=""btn btn-large btn-primary pull-right"" style=""margin-bottom:10px;"" type=""button""&gt;Not Present&lt;/button&gt;

&lt;script&gt;

$(document).ready(function(){

$('#foo').click(function(){
@{
if(status)
{&lt;text&gt;myMethod(false,true);&lt;/text&gt;}
else
{&lt;text&gt;myMethod(false,false);&lt;/text&gt;}

}
});

});

function myMethod(var par1,var status){
//Your logic here
return false;
}
&lt;/script&gt;
</code></pre>",0
31882470,Calling an EXE from a WCF Service,"<p>I am working on a project where i need to run an executable once its reached the end of the WCF Method, I cant do this in the codebehind as the webservice will be set to oneway. </p>

<p>I have tried the following:</p>

<pre><code>  System.Diagnostics.Process process = new System.Diagnostics.Process();

  System.Diagnostics.ProcessStartInfo startInfo = new System.Diagnostics.ProcessStartInfo();
  startInfo.WindowStyle = System.Diagnostics.ProcessWindowStyle.Normal;
  startInfo.FileName = ""C:\\Test.exe"";
  startInfo.Arguments = ""Arg"";
  process.StartInfo = startInfo;
  process.Start();
</code></pre>

<p>The WCF webservice doesn't throw any errors.</p>

<p>Is it possible to call executables from WCF or is there any alternative ways of doing this.</p>",c#|asp.net|wcf,"<p>The main difference between double clicking a program versus launching it from your WCF service is permissions.  When you double click the program, it runs under your account (which is probably administrator or super user) while launching from the WCF service will execute it under the service account associated with the WCF application or the app pool in which it resides (which is typically very restricted).</p>

<p>To test to see if this is the problem, ON DEV BOX ONLY, you can temporarily assign administrator as the app pool service account and see if it works.  Once you have confirmed that is the problem, restore the original account and tweak its permissions until the program works.</p>

<p>Another way to test it is to interactively sign on as the IIS account and double click the program.  This will let you see any errors that may be occurring when it is called from the service.</p>

<p>There are other potential problems (e.g. environment variables or current working directory that are different when running as yourself vs. as the WCF service) but I've found that permissions is usually the culprit.</p>",2
31623338,Where should I put unhandled exception handler?,"<p>I have some piece of code called <code>Finally()</code> which handles unhandled exceptions by subscribing to <code>UnhandledException</code> event (I'm talking about WinForms).</p>

<pre><code>AppDomain.CurrentDomain.UnhandledException += (_, __) =&gt; Finally(__.ExceptionObject as Exception);
</code></pre>

<p>Where should I put this line? Into the <code>static Program()</code> constructor or into the <code>static void Main()</code> method? Is there any differences?</p>",c#|winforms|exception-handling,"<p>Although they both are called in the beginning of your program, I would place it in the <code>Main()</code> method because any exceptions that occur from within the static constructor are harder to debug. </p>",0
31626593,Error saving in SQL Server if system datetime format is changed,"<p>I am importing data from an Excel file into SQL Server using a C# app. My sheet contains some datetime columns. </p>

<p>Irrespective of what format my system datetime is set to (<code>dd/mm/yyyy</code> or <code>mm/dd/yyyy</code> or any other format) and what format my datetime values is in the Excel sheet, I would be able to load it properly in SQL Server without any errors. Currently if my system datetime is <code>mm/dd/yyyy</code>, data is saved, but if I change system format to <code>dd/mm/yyyy</code>, the save operation fails. </p>

<p><strong>Save functionality:</strong></p>

<pre><code>public int InsertSetting(DataRow drow)
    {
        int Result = 0;

        try
        {

            OdbcParameter[] p = new OdbcParameter[9];
            p[0] = new OdbcParameter(""@ID"", drow[""ID""].ToString().Trim());
            p[1] = new OdbcParameter(""@ComID"", drow[""CompanyID""].ToString().DbNullIfNullOrEmpty());
            p[2] = new OdbcParameter(""@Mod"", drow[""ModuleID""].ToString().DbNullIfNullOrEmpty());
            p[3] = new OdbcParameter(""@Stat"", drow[""Status""].ToString());
            p[4] = new OdbcParameter(""@EnterBy"", drow[""EnterBy""].ToString().DbNullIfNullOrEmpty());
            p[5] = new OdbcParameter(""@EnterDate"", (drow[""EnterDate""].ToString() == """" || drow[""EnterDate""].ToString() == ""NULL"") ? (object)DBNull.Value : drow[""EnterDate""].ToString());
            p[6] = new OdbcParameter(""@UpdateBy"", drow[""UpdateBy""].ToString().DbNullIfNullOrEmpty());
            p[7] = new OdbcParameter(""@UpdateDate"", (drow[""UpdateDate""].ToString() == """" || drow[""UpdateDate""].ToString() == ""NULL"") ? (object)DBNull.Value : drow[""UpdateDate""].ToString());
            p[8] = new OdbcParameter(""@Mode"", 7);


            Result = //calling stored procedure to save data

        }
        catch (Exception ex)
        {
             MessageBox.Show(ex.Message, ""InsertSetting()"");


        }
        return Result;

    }
</code></pre>

<p>Reading enterdate and updatedate in <code>mm/dd/yyyy</code> format.</p>

<p>I am not able to understand what exactly the problem is and what I have to do with system <strong>Datetime</strong> format. </p>",c#|sql|sql-server|excel,"<p>If <code>drow[""EnterDate""]</code> and <code>drow[""UpdateDate""]</code> are DateTime, you could enter a custom format in <code>ToString()</code>.</p>

<p>To save date into SQL Server via ADO.net, though I admit it is not a formal way, I found that it is always safer to format it to <code>ToString(""yyyy-MM-dd HH:mm:ss"")</code> regardless of local/server date time format settings. </p>",0
31626593,Error saving in SQL Server if system datetime format is changed,"<p>I am importing data from an Excel file into SQL Server using a C# app. My sheet contains some datetime columns. </p>

<p>Irrespective of what format my system datetime is set to (<code>dd/mm/yyyy</code> or <code>mm/dd/yyyy</code> or any other format) and what format my datetime values is in the Excel sheet, I would be able to load it properly in SQL Server without any errors. Currently if my system datetime is <code>mm/dd/yyyy</code>, data is saved, but if I change system format to <code>dd/mm/yyyy</code>, the save operation fails. </p>

<p><strong>Save functionality:</strong></p>

<pre><code>public int InsertSetting(DataRow drow)
    {
        int Result = 0;

        try
        {

            OdbcParameter[] p = new OdbcParameter[9];
            p[0] = new OdbcParameter(""@ID"", drow[""ID""].ToString().Trim());
            p[1] = new OdbcParameter(""@ComID"", drow[""CompanyID""].ToString().DbNullIfNullOrEmpty());
            p[2] = new OdbcParameter(""@Mod"", drow[""ModuleID""].ToString().DbNullIfNullOrEmpty());
            p[3] = new OdbcParameter(""@Stat"", drow[""Status""].ToString());
            p[4] = new OdbcParameter(""@EnterBy"", drow[""EnterBy""].ToString().DbNullIfNullOrEmpty());
            p[5] = new OdbcParameter(""@EnterDate"", (drow[""EnterDate""].ToString() == """" || drow[""EnterDate""].ToString() == ""NULL"") ? (object)DBNull.Value : drow[""EnterDate""].ToString());
            p[6] = new OdbcParameter(""@UpdateBy"", drow[""UpdateBy""].ToString().DbNullIfNullOrEmpty());
            p[7] = new OdbcParameter(""@UpdateDate"", (drow[""UpdateDate""].ToString() == """" || drow[""UpdateDate""].ToString() == ""NULL"") ? (object)DBNull.Value : drow[""UpdateDate""].ToString());
            p[8] = new OdbcParameter(""@Mode"", 7);


            Result = //calling stored procedure to save data

        }
        catch (Exception ex)
        {
             MessageBox.Show(ex.Message, ""InsertSetting()"");


        }
        return Result;

    }
</code></pre>

<p>Reading enterdate and updatedate in <code>mm/dd/yyyy</code> format.</p>

<p>I am not able to understand what exactly the problem is and what I have to do with system <strong>Datetime</strong> format. </p>",c#|sql|sql-server|excel,"<p>Assuming drow[""EnterDate""] is string, you should convert date parameters to DateTime before passing to SQL Server. SQL Server treats date as MM/DD/YYYY if first part is 1 or 2 digits. Alternatively, you can pass dates as yyyyMMdd format.</p>

<p>With some simplification: </p>

<pre><code>p[5] = new OdbcParameter(""@EnterDate"", !string.IsNullOrEmpty(drow[""EnterDate""].ToString()) ? DateTime.Parse((string)drow[""EnterDate""]) : DBNull.Value);
</code></pre>

<p>or</p>

<pre><code>p[5] = new OdbcParameter(""@EnterDate"", !string.IsNullOrEmpty(drow[""EnterDate""].ToString) ? DateTime.Parse((string)drow[""EnterDate""]).ToString(""yyyyMMdd HH:mm:ss"") : DBNull.Value);
</code></pre>

<p>If drow[""EnterDate""] is already type of DateTime, then;</p>

<pre><code>p[5] = new OdbcParameter(""@EnterDate"", drow[""EnterDate""] != DBNull.Value ? (DateTime)drow[""EnterDate""] : DBNull.Value);
</code></pre>

<p>or</p>

<pre><code>p[5] = new OdbcParameter(""@EnterDate"", drow[""EnterDate""] != DBNull.Value ? ((DateTime)drow[""EnterDate""]).ToString(""yyyyMMdd HH:mm:ss"") : DBNull.Value);
</code></pre>",0
31745147,Send email when 'submit' button clicked,"<p>I have a 4 page ASP.NET form which is storing data in the session. When the 'Submit' button on the 3rd page is clicked i want the details entered to be emailed to my hotmail account but i can't seem to get it to work as it always falls stright into my <code>catch</code>.</p>

<p><strong>HTML is</strong></p>

<pre><code>&lt;table&gt;
        &lt;tr&gt;
            &lt;td&gt;Name:&lt;/td&gt;
            &lt;td&gt;
                &lt;asp:TextBox ID=""txtName"" runat=""server"" Columns=""50""&gt;&lt;/asp:TextBox&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Subject:&lt;/td&gt;
            &lt;td&gt;
                &lt;asp:DropDownList ID=""ddlSubject"" runat=""server""&gt;
                    &lt;asp:ListItem&gt;Ask a question&lt;/asp:ListItem&gt;
                    &lt;asp:ListItem&gt;Report a bug&lt;/asp:ListItem&gt;
                    &lt;asp:ListItem&gt;Customer support ticket&lt;/asp:ListItem&gt;
                    &lt;asp:ListItem&gt;Other&lt;/asp:ListItem&gt;
                &lt;/asp:DropDownList&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td&gt;Message:&lt;/td&gt;
            &lt;td&gt;
                &lt;asp:TextBox ID=""txtMessage"" runat=""server"" Columns=""40"" Rows=""6"" TextMode=""MultiLine""&gt;&lt;/asp:TextBox&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td colspan=""2""&gt;
                &lt;asp:Button ID=""btnSubmit"" runat=""server"" Text=""Submit"" onclick=""btnSubmit_Click"" /&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
        &lt;tr&gt;
            &lt;td colspan=""2""&gt;
                &lt;asp:Label ID=""lblResult"" runat=""server""&gt;&lt;/asp:Label&gt;
            &lt;/td&gt;
        &lt;/tr&gt;
    &lt;/table&gt;
</code></pre>

<p><strong>Code for my <code>onclick</code> is</strong></p>

<pre><code>using System.Net.Mail;
using System.Net;

protected void btnSubmit_Click(object sender, EventArgs e)
{
    try
    {
        //Create the msg object to be sent
        MailMessage msg = new MailMessage();
        //Add your email address to the recipients
        msg.To.Add(""**SHOULD THIS BE MY EMAIL ADDRESS?**"");
        //Configure the address we are sending the mail from **- NOT SURE IF I NEED THIS OR NOT?**
        //MailAddress address = new MailAddress(""SenderAddress@gmail.com"");
        //msg.From = address;
        //Append their name in the beginning of the subject
        msg.Subject = txtName.Text + "" :  "" + ddlSubject.Text;
        msg.Body = txtMessage.Text;

        //Configure an SmtpClient to send the mail.
        SmtpClient client = new SmtpClient(""smtp.live.com"", 465);
        client.EnableSsl = true; //only enable this if your provider requires it
        //Setup credentials to login to our sender email address (""UserName"", ""Password"")
        NetworkCredential credentials = new NetworkCredential(""MY@EMAIL ADDRESS"", ""**SHOULD THIS BE MY PASSOWRD?**"");
        client.Credentials = credentials;

        //Send the msg
        client.Send(msg);

        //Display some feedback to the user to let them know it was sent
        lblResult.Text = ""Your message was sent!"";

        //Clear the form
        txtName.Text = """";
        txtMessage.Text = """";
    }
    catch
    {
        //If the message failed at some point, let the user know
        lblResult.Text = ""Your message failed to send, please try again."";
    }
}
</code></pre>

<p>Can anyone help me out.</p>

<p>I got the SMTP details from <a href=""http://www.serversmtp.com/en/smtp-hotmail"" rel=""nofollow"">http://www.serversmtp.com/en/smtp-hotmail</a> but it always fails</p>",c#|asp.net|webforms,"<p>I have updated your code, try to use the same email for From and To since you are sending it to yourself and also use your hotmail password as part of the NetworkCredential instantiation:     </p>

<pre><code>using System.Net.Mail;
using System.Net;

    protected void btnSubmit_Click(object sender, EventArgs e)
    {
        try
        {
            //Create the msg object to be sent
            MailMessage msg = new MailMessage();
            //Add your email address to the recipients
            msg.To.Add(""youremail@hotmail.com"");
            //Configure the address we are sending the mail from **- NOT SURE IF I NEED THIS OR NOT?**
            MailAddress address = new MailAddress(""youremail@hotmail.com"");
            msg.From = address;
            //Append their name in the beginning of the subject
            msg.Subject = txtName.Text + "" :  "" + ddlSubject.Text;
            msg.Body = txtMessage.Text;

            //Configure an SmtpClient to send the mail.
            SmtpClient client = new SmtpClient(""smtp.live.com"", 465);
            client.EnableSsl = true; //only enable this if your provider requires it
            //Setup credentials to login to our sender email address (""UserName"", ""Password"")
            NetworkCredential credentials = new NetworkCredential(""youremail@hotmail.com"", ""YourPassword"");
            client.Credentials = credentials;

            //Send the msg
            client.Send(msg);

            //Display some feedback to the user to let them know it was sent
            lblResult.Text = ""Your message was sent!"";

            //Clear the form
            txtName.Text = """";
            txtMessage.Text = """";
        }
        catch
        {
            //If the message failed at some point, let the user know
            lblResult.Text = ""Your message failed to send, please try again."";
        }
    }
</code></pre>

<p>Also make sure that 465 port number is correct for smtp.live.com. You can try 587 instead <a href=""http://www.codeproject.com/Tips/520998/Send-Email-from-Yahoo-GMail-Hotmail-Csharp"" rel=""nofollow"">Send Email from Yahoo!, GMail, Hotmail (C#)</a> </p>",2
31743320,Wpf uniform grid item,"<p>I have uniform grid, with buttons and labels. Each button has unique content, after clicking on the button situated in the box I want to change label in this box. But how can i figure out in which box button was clicked and which label need to change?  </p>

<pre><code>namespace WpfApplication107
{
public partial class MainWindow : Window
{
    public MainWindow()
    {
        InitializeComponent();
        DataContext = new Shop();
    }
}

public class StructOfBox
{
    public string Size { get; set; }
    public string Amount { get; set; }
    public ICommand ChangeSize { get; set; }
}

public class Shop
{
    public Shop()
    {
        Items = new ObservableCollection&lt;StructOfBox&gt;();
        Items.Add(new StructOfBox { Amount = ""0"", Size = ""S"", ChangeSize = new RelayCommand(() =&gt; ChangeAmount()) });
        Items.Add(new StructOfBox { Amount = ""0"", Size = ""M"", ChangeSize = new RelayCommand(() =&gt; ChangeAmount()) });
        Items.Add(new StructOfBox { Amount = ""0"", Size = ""L"", ChangeSize = new RelayCommand(() =&gt; ChangeAmount()) });
        Items.Add(new StructOfBox { Amount = ""0"", Size = ""XL"", ChangeSize = new RelayCommand(() =&gt; ChangeAmount()) });
    }

    public ObservableCollection&lt;StructOfBox&gt; Items { get; set; }
    public void ChangeAmount()
    {
        // what box?
        Debug.WriteLine(""pressed"");
    }
}
}
</code></pre>

<p>Xaml:</p>

<pre><code> &lt;Grid&gt;
    &lt;ItemsControl ItemsSource=""{Binding Items}""&gt;
        &lt;ItemsControl.ItemsPanel&gt;
            &lt;ItemsPanelTemplate&gt;
                &lt;UniformGrid Columns=""2"" Rows=""2""&gt;&lt;/UniformGrid&gt;
            &lt;/ItemsPanelTemplate&gt;
        &lt;/ItemsControl.ItemsPanel&gt;
        &lt;ItemsControl.ItemTemplate&gt;
            &lt;DataTemplate&gt;
                &lt;Border BorderThickness=""2"" BorderBrush=""Green""&gt;
                    &lt;Grid&gt;
                        &lt;Grid.RowDefinitions&gt;
                            &lt;RowDefinition&gt;&lt;/RowDefinition&gt;
                            &lt;RowDefinition&gt;&lt;/RowDefinition&gt;
                            &lt;RowDefinition&gt;&lt;/RowDefinition&gt;
                        &lt;/Grid.RowDefinitions&gt;
                        &lt;Button Content=""{Binding Size}"" Command=""{Binding ChangeSize}""&gt;&lt;/Button&gt;
                        &lt;Label Content=""{Binding Amount}"" Height=""25"" Grid.Row=""2""&gt;&lt;/Label&gt;
                    &lt;/Grid&gt;
                &lt;/Border&gt;
            &lt;/DataTemplate&gt;
        &lt;/ItemsControl.ItemTemplate&gt;
    &lt;/ItemsControl&gt;
&lt;/Grid&gt;
</code></pre>",c#|wpf,"<p>I would pass the ""calling"" StructOfBox as a parameter to the ChangeAmount() handler. That way you would be able to change the label without really needing to know which button was clicked.</p>

<p>But as Clemens said, in order for this to work correctly, StructOfBox will have to implement INotifyPropertyChanged. </p>",0
58836039,How can I display collected amount of coins without overflow (accessing another script) in Unity?,"<p>I have two scripts. <strong>PlayerMove.cs</strong> and <strong>Spawner.cs</strong> .
In PlayerMove.cs I want a function that changes the text to the number of coins.</p>

<pre><code>void CountCoin()
{
    cointext.text = "": ""+ coincount;
    CountCoin();
}
</code></pre>

<p>In Spawner.cs I spawn coins and I want to increase coincount(which is public variable of PlayerMove.cs) each time I spawn.</p>

<pre><code>IEnumerator StartSpawningCoins ()
    {
        coin.GetComponent&lt;Renderer&gt;().enabled=true;

        yield return new WaitForSeconds(Random.Range(6f, 16f));

        GameObject k = Instantiate(coin);

        // my problem starts here

        GameObject Player = GameObject.Find(""PlayerMove"");
        PlayerMove playermove = Player.GetComponent&lt;PlayerMove&gt;();
        playermove.coincount++;

        //till here

        float x = Random.Range(min_X,max_X);

        k.transform.position = new Vector2(x, transform.position.y);

        StartCoroutine(StartSpawningCoins());
    }
</code></pre>

<p>When I use these I get stack overflow error. How can I fix it?</p>",c#|unity3d|stack-overflow,"<p>The problem is that in</p>

<pre><code>void CountCoin()
{
    cointext.text = "": ""+ coincount;
    CountCoin();
}
</code></pre>

<p>you call <code>CountCoin()</code> itself! </p>

<hr>

<p>If you wanted a repeated Update you could e.g. use <a href=""https://docs.unity3d.com/ScriptReference/MonoBehaviour.Invoke.html"" rel=""nofollow noreferrer""><code>Invoke</code></a></p>

<pre><code>void CountCoin()
{
    cointext.text = "": ""+ coincount;

    // calls this method again after 1 second
    Invoke(nameof(CountCoin), 1f);
}
</code></pre>

<p>or directly <a href=""https://docs.unity3d.com/ScriptReference/MonoBehaviour.InvokeRepeating.html"" rel=""nofollow noreferrer""><code>InvokeRepeating</code></a></p>

<pre><code>void Start()
{
    // calls CountCoin every second, the first time after 1 second delay
    InvokeRepeating(nameof(CountCoin), 1f, 1f);
}
</code></pre>

<p>in order to call it every second.</p>

<p>Or simply remove the nested call entirely and add one to <a href=""https://docs.unity3d.com/ScriptReference/MonoBehaviour.Update.html"" rel=""nofollow noreferrer""><code>Update</code></a> to make it get called every frame</p>

<pre><code>void Update()
{
    CountCoin();
}
</code></pre>

<p><strong>Or</strong> this is what I would rather do: Make <code>coincount</code> a <a href=""https://docs.microsoft.com/dotnet/csharp/programming-guide/classes-and-structs/properties"" rel=""nofollow noreferrer"">property</a> and add the according behavior to the setter:</p>

<pre><code>private int _coincount;
public int coincount 
{
    get { return _coincount; }
    set 
    { 
        _coincount = value;
        cointext.text = "": ""+ value;
    }
}  
</code></pre>

<p>so everytime you change the property the code is executed automatically</p>

<hr>

<p>Btw <code>Find</code> is quite expensive and should be avoided. I would change your code to</p>

<pre><code>private PlayerMove playermove;

IEnumerator StartSpawningCoins ()
{
    // as long as you yield inside this is ok
    while(true)
    {
        // only do find if needed
        if(!player) player = GameObject.Find(""PlayerMove"");

        // this should probably actually be done in the prefab not via code
        coin.GetComponent&lt;Renderer&gt;().enabled = true;

        yield return new WaitForSeconds(Random.Range(6f, 16f));

        GameObject k = Instantiate(coin);
        playermove.coincount++;

        float x = Random.Range(min_X,max_X);

        k.transform.position = new Vector2(x, transform.position.y);
    }
}
</code></pre>",2
4661058,Passing Parameters through stored Procedure,"<p>I am new to interfacing DB's with applications and am trying to pull a couple of fields from a database where the parameter I specified should filter out the results. I keep receiving a no parameters or arguments were supplied. Can anyone shed a little insight on this? Thanks.</p>

<p>below is the stored procedure:</p>

<pre><code>ALTER PROC dbo.PassParamUserID

AS
set nocount on
DECLARE @UserID int;

SELECT f_Name, l_Name
FROM tb_User
WHERE tb_User.ID = @UserID;
</code></pre>

<p>And here is my code</p>

<pre><code>class StoredProcedureDemo
{
    static void Main()
    {
        StoredProcedureDemo spd = new StoredProcedureDemo();

        //run a simple stored procedure that takes a parameter
        spd.RunStoredProcParams();
    }

    public void RunStoredProcParams()
    {
        SqlConnection conn = null;
        SqlDataReader rdr = null;

        string ID = ""2"";

        Console.WriteLine(""\n the customer full name is:"");

        try
        {
            //create a new connection object
            conn = new SqlConnection(""Data Source=.\\SQLEXPRESS;AttachDbFilename=c:\\Program Files\\Microsoft SQL Server\\MSSQL10.SQLEXPRESS\\MSSQL\\DATA\\UserDB.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True; Integrated Security=SSPI"");
            conn.Open();

            //create command objects identifying the stored procedure
            SqlCommand cmd = new SqlCommand(""PassParamUserID"", conn);

            //Set the command object so it know to execute the stored procedure
            cmd.CommandType = CommandType.StoredProcedure;

            //ADD PARAMETERS TO COMMAND WHICH WILL BE PASSED TO STORED PROCEDURE
            cmd.Parameters.Add(new SqlParameter(""@UserID"", 2));

            //execute the command
            rdr = cmd.ExecuteReader();

            //iterate through results, printing each to console
            while (rdr.Read())
            {
                Console.WriteLine(""First Name: {0,25} Last Name: {0,20}"", rdr[""f_Name""], rdr[""l_Name""]);
            }
        }
</code></pre>",c#|tsql|stored-procedures,"<pre><code>ALTER PROC dbo.PassParamUserID (@UserID int)

AS 
set nocount on 
SELECT f_Name, l_Name FROM tb_User WHERE tb_User.ID = @UserID;
</code></pre>

<p>If you want to pass a parameter in you need to define it before the AS statement as  shown above.</p>",1
4661058,Passing Parameters through stored Procedure,"<p>I am new to interfacing DB's with applications and am trying to pull a couple of fields from a database where the parameter I specified should filter out the results. I keep receiving a no parameters or arguments were supplied. Can anyone shed a little insight on this? Thanks.</p>

<p>below is the stored procedure:</p>

<pre><code>ALTER PROC dbo.PassParamUserID

AS
set nocount on
DECLARE @UserID int;

SELECT f_Name, l_Name
FROM tb_User
WHERE tb_User.ID = @UserID;
</code></pre>

<p>And here is my code</p>

<pre><code>class StoredProcedureDemo
{
    static void Main()
    {
        StoredProcedureDemo spd = new StoredProcedureDemo();

        //run a simple stored procedure that takes a parameter
        spd.RunStoredProcParams();
    }

    public void RunStoredProcParams()
    {
        SqlConnection conn = null;
        SqlDataReader rdr = null;

        string ID = ""2"";

        Console.WriteLine(""\n the customer full name is:"");

        try
        {
            //create a new connection object
            conn = new SqlConnection(""Data Source=.\\SQLEXPRESS;AttachDbFilename=c:\\Program Files\\Microsoft SQL Server\\MSSQL10.SQLEXPRESS\\MSSQL\\DATA\\UserDB.mdf;Integrated Security=True;Connect Timeout=30;User Instance=True; Integrated Security=SSPI"");
            conn.Open();

            //create command objects identifying the stored procedure
            SqlCommand cmd = new SqlCommand(""PassParamUserID"", conn);

            //Set the command object so it know to execute the stored procedure
            cmd.CommandType = CommandType.StoredProcedure;

            //ADD PARAMETERS TO COMMAND WHICH WILL BE PASSED TO STORED PROCEDURE
            cmd.Parameters.Add(new SqlParameter(""@UserID"", 2));

            //execute the command
            rdr = cmd.ExecuteReader();

            //iterate through results, printing each to console
            while (rdr.Read())
            {
                Console.WriteLine(""First Name: {0,25} Last Name: {0,20}"", rdr[""f_Name""], rdr[""l_Name""]);
            }
        }
</code></pre>",c#|tsql|stored-procedures,"<p>You need to modify your SQL stored proc to:</p>

<pre><code>ALTER PROC dbo.PassParamUserID

@UserID int

AS set nocount on

SELECT f_Name, l_Name FROM tb_User WHERE tb_User.ID = @UserID;
</code></pre>

<p>At the moment you are just declaring it as a variable within the procedure.</p>

<p>Here are some MSDN articles that may help you going forward:</p>

<p><a href=""http://msdn.microsoft.com/en-us/library/aa258259%28v=sql.80%29.aspx"" rel=""nofollow"">Creating and Altering Stored procedures</a></p>

<p><a href=""http://msdn.microsoft.com/en-us/library/aa258839%28v=sql.80%29.aspx"" rel=""nofollow"">Declaring Local Variables</a></p>",2
4429935,"Netduino plus, SD Card cannot get basic example working","<p>Hi I want to try my SD card on de the netduino plus.
I downloaded the SDK from this website yesterday.</p>

<p>I could not find documentation so I figured out the following code.
However it gives ""CLR_E_VOLUME_NOT_FOUND"".. What do I do wrong ?
I read something online about mounting and a certain dll (SecretLabs.NETMF.IO.dll ) but I cannot find that dll.</p>

<p>Can anybody help me getting started ?</p>

<pre><code>public class Program
{
    public static void Main()
    {
        var dir = Directory.GetCurrentDirectory();
        var fileName = Path.Combine(dir, ""test.txt"");
        Debug.Print(fileName);
        byte[] testBytes = new byte[] { 1,2,3,4 };
        File.WriteAllBytes(fileName, testBytes);
    }

}
</code></pre>

<p>Output :</p>

<p>\test.txt</p>

Exception System.IO.IOException - CLR_E_VOLUME_NOT_FOUND (1)

Message:

System.IO.Path::NormalizePath [IP: 0070]

System.IO.Path::GetFullPath [IP: 001a]

System.IO.FileStream::.ctor [IP: 0009]

System.IO.File::WriteAllBytes [IP: 0012]

NetduinoPlusApplication1.Program::Main [IP: 0025]

<p>A first chance exception of type 'System.IO.IOException' occurred in System.IO.dll
An unhandled exception of type 'System.IO.IOException' occurred in System.IO.dll </p>",c#|netduino,"<p>Check out the \Samples\SDCardTest in the <a href=""http://netduinohelpers.codeplex.com/"" rel=""nofollow"">http://netduinohelpers.codeplex.com/</a> project for a complete example which is aware of the various Netduino platforms (for instance, the SD card chip select pin for the Netduino Mini is different than the one for the Netduino or the Netduino Plus). As of firmware version 4.1.1 Beta 1, High Capacity microSD cards are supported and have been tested successfully up to 8GB.</p>",1
4429935,"Netduino plus, SD Card cannot get basic example working","<p>Hi I want to try my SD card on de the netduino plus.
I downloaded the SDK from this website yesterday.</p>

<p>I could not find documentation so I figured out the following code.
However it gives ""CLR_E_VOLUME_NOT_FOUND"".. What do I do wrong ?
I read something online about mounting and a certain dll (SecretLabs.NETMF.IO.dll ) but I cannot find that dll.</p>

<p>Can anybody help me getting started ?</p>

<pre><code>public class Program
{
    public static void Main()
    {
        var dir = Directory.GetCurrentDirectory();
        var fileName = Path.Combine(dir, ""test.txt"");
        Debug.Print(fileName);
        byte[] testBytes = new byte[] { 1,2,3,4 };
        File.WriteAllBytes(fileName, testBytes);
    }

}
</code></pre>

<p>Output :</p>

<p>\test.txt</p>

Exception System.IO.IOException - CLR_E_VOLUME_NOT_FOUND (1)

Message:

System.IO.Path::NormalizePath [IP: 0070]

System.IO.Path::GetFullPath [IP: 001a]

System.IO.FileStream::.ctor [IP: 0009]

System.IO.File::WriteAllBytes [IP: 0012]

NetduinoPlusApplication1.Program::Main [IP: 0025]

<p>A first chance exception of type 'System.IO.IOException' occurred in System.IO.dll
An unhandled exception of type 'System.IO.IOException' occurred in System.IO.dll </p>",c#|netduino,"<p>I've been helped at the Netduino Forum, <a href=""http://forums.netduino.com/index.php?/topic/825-sd-card-cannot-get-basic-example-working/"" rel=""nofollow noreferrer"">see this forum post</a>.</p>

<p>I needed to write to the <code>\SD\</code> folder. <code>Mounting/dll</code> was only necessary for the plain Netduino with an additional SD card shield.</p>

<p>Three quick things:</p>

<ol>
<li>The MicroSD card will be mounted at <code>\SD\</code> rather than <code>\</code></li>
<li>MicroSD cards up to <em>2GB</em> are generally supported.<br></li>
<li><code>SecretLabs.NETMF.IO</code> is only needed for manually mounting and dismounting--on the <em>regular Netduino</em>. The <em>Netduino Plus</em> automatically mounts and dismounts MicroSD Cards.</li>
</ol>",6
4308118,Get attribute values from matching XML nodes using XPath query,"<p>This doesn't seem like it should be difficult, but I'm stuck currently.  I'm trying to get the attribute values for a particular attribute from nodes that match a given XPath query string.  Here's what I have so far:</p>

<pre><code>    public static IEnumerable&lt;string&gt; GetAttributes(this XmlDocument xml,
        string xpathQuery, string attributeName)
    {
        var doc = new XPathDocument(new XmlNodeReader(xml));
        XPathNavigator nav = doc.CreateNavigator();
        XPathExpression expr = nav.Compile(xpathQuery);
        XPathNodeIterator iterator = nav.Select(expr);
        while (iterator.MoveNext())
        {
            XPathNavigator curNav = iterator.Current;
            if (curNav.HasAttributes)
            {
                XmlNode curNode = ((IHasXmlNode)curNav).GetNode();
                if (null != curNode)
                {
                    XmlAttribute attrib = curNode.Attributes[attributeName];
                    if (null != attrib)
                    {
                        yield return attrib.Value;
                    }
                }
            }
        }
    }
</code></pre>

<p>This currently throws an exception:</p>

<blockquote>
  <p>System.InvalidCastException: Unable to cast object of type 'MS.Internal.Xml.Cache.XPathDocumentNavigator' to type 'System.Xml.IHasXmlNode'.</p>
</blockquote>

<p>Am I going about this wrong?  Is there a simpler way to get attribute values from matching nodes?</p>",c#|xml|extension-methods|xpath|xpathnavigator,"<p>solution to the initial problem of the exception being thrown...</p>

<pre><code>var doc = new XPathDocument(new XmlNodeReader(xml));
</code></pre>

<p>should be replaced by...</p>

<pre><code>var doc = new XmlDocument();
doc.load(*you can either specify the path to the file, the string out of which the xml document is to be generated or specify an xmlreader, look for more overloads*);
</code></pre>

<p>This will not throw the exception and the code will work just fine.</p>",1
4308118,Get attribute values from matching XML nodes using XPath query,"<p>This doesn't seem like it should be difficult, but I'm stuck currently.  I'm trying to get the attribute values for a particular attribute from nodes that match a given XPath query string.  Here's what I have so far:</p>

<pre><code>    public static IEnumerable&lt;string&gt; GetAttributes(this XmlDocument xml,
        string xpathQuery, string attributeName)
    {
        var doc = new XPathDocument(new XmlNodeReader(xml));
        XPathNavigator nav = doc.CreateNavigator();
        XPathExpression expr = nav.Compile(xpathQuery);
        XPathNodeIterator iterator = nav.Select(expr);
        while (iterator.MoveNext())
        {
            XPathNavigator curNav = iterator.Current;
            if (curNav.HasAttributes)
            {
                XmlNode curNode = ((IHasXmlNode)curNav).GetNode();
                if (null != curNode)
                {
                    XmlAttribute attrib = curNode.Attributes[attributeName];
                    if (null != attrib)
                    {
                        yield return attrib.Value;
                    }
                }
            }
        }
    }
</code></pre>

<p>This currently throws an exception:</p>

<blockquote>
  <p>System.InvalidCastException: Unable to cast object of type 'MS.Internal.Xml.Cache.XPathDocumentNavigator' to type 'System.Xml.IHasXmlNode'.</p>
</blockquote>

<p>Am I going about this wrong?  Is there a simpler way to get attribute values from matching nodes?</p>",c#|xml|extension-methods|xpath|xpathnavigator,"<p>If you're using .net 3.5 or later you could use linq to Xml</p>

<p>For a given xml document</p>

<pre><code>&lt;?xml version=""1.0"" encoding=""utf-8"" ?&gt;
&lt;root&gt;
  &lt;storedProcedures&gt;
    &lt;storedProcedure name=""usp_GET_HOME_PAGE_DATA""&gt;
      &lt;resultSet name=""Features""/&gt;
      &lt;resultSet name=""Highlights""/&gt;
    &lt;/storedProcedure&gt;
    &lt;storedProcedure name=""usp_GET_FEATURES"" /&gt;
    &lt;storedProcedure name=""usp_GET_FEATURE"" /&gt;
    &lt;storedProcedure name=""usp_UPDATE_FEATURE"" /&gt;
    &lt;storedProcedure name=""usp_GET_FEATURE_FOR_DISPLAY""&gt;
      &lt;resultSet name=""CurrentFeature""/&gt;
      &lt;resultSet name=""OtherFeatures""/&gt;
    &lt;/storedProcedure&gt;
    &lt;storedProcedure name=""usp_GET_HIGHLIGHT_TITLES""&gt;
      &lt;resultSet name=""Highlights""/&gt;
    &lt;/storedProcedure&gt;
  &lt;/storedProcedures&gt;
&lt;/root&gt;
</code></pre>

<p>The following linq expression will get you the values of the ""name"" attributes of all storedProcedure node</p>

<pre><code>XDocument xDcoument = XDocument.Load(xmlStoredProcSchemeFile);

  var storedProcedureNames = from doc in xDcoument.Descendants(""storedProcedure"")
                             select doc.Attribute(""name"").Value;
</code></pre>

<p>you could also use regular XPath syntax. In the code below the variable node holds the node identified by the ""usp_GET_HOME_PAGE_DATA"" name and then the attributes variable holds all child nodes (the attributes) of the selected node and it's children.</p>

<pre><code>  XmlDocument xmlDocument = new XmlDocument();
  xmlDocument.Load(@""C:\inetpub\wwwroot\ASPNETBuilder\BusinessLayer\DataAccessCodeGenerationSchema.xml"");
  var node = xmlDocument.DocumentElement.SelectSingleNode(""./storedProcedures/storedProcedure[@name='usp_GET_HOME_PAGE_DATA']"");
  var attributes = node.SelectNodes(""./resultSet/@name"");
</code></pre>",4
4308118,Get attribute values from matching XML nodes using XPath query,"<p>This doesn't seem like it should be difficult, but I'm stuck currently.  I'm trying to get the attribute values for a particular attribute from nodes that match a given XPath query string.  Here's what I have so far:</p>

<pre><code>    public static IEnumerable&lt;string&gt; GetAttributes(this XmlDocument xml,
        string xpathQuery, string attributeName)
    {
        var doc = new XPathDocument(new XmlNodeReader(xml));
        XPathNavigator nav = doc.CreateNavigator();
        XPathExpression expr = nav.Compile(xpathQuery);
        XPathNodeIterator iterator = nav.Select(expr);
        while (iterator.MoveNext())
        {
            XPathNavigator curNav = iterator.Current;
            if (curNav.HasAttributes)
            {
                XmlNode curNode = ((IHasXmlNode)curNav).GetNode();
                if (null != curNode)
                {
                    XmlAttribute attrib = curNode.Attributes[attributeName];
                    if (null != attrib)
                    {
                        yield return attrib.Value;
                    }
                }
            }
        }
    }
</code></pre>

<p>This currently throws an exception:</p>

<blockquote>
  <p>System.InvalidCastException: Unable to cast object of type 'MS.Internal.Xml.Cache.XPathDocumentNavigator' to type 'System.Xml.IHasXmlNode'.</p>
</blockquote>

<p>Am I going about this wrong?  Is there a simpler way to get attribute values from matching nodes?</p>",c#|xml|extension-methods|xpath|xpathnavigator,"<p>For the following xml:</p>

<pre><code>&lt;root&gt;
  &lt;elem att='the value' /&gt;
&lt;/root&gt;
</code></pre>

<p>You can get the ""the value"" text with this C# code</p>

<pre><code>    XmlDocument xdoc = new XmlDocument();
    xdoc.LoadXml(text);
    Console.WriteLine(xdoc.SelectSingleNode(""/root/elem/@att"").Value);
</code></pre>",32
4149973,"Amazon Product API - are there any valid, up-to-date examples in C#?","<p>I must have run through 10 different sample C# projects that are out of date, and no longer work.</p>

<p>All I'm after is a way to get a book's information back based on an ISBN or title.</p>

<p>The Amazon Web Service site is an absolutely miserable morass.</p>

<p><strong>Update:</strong></p>

<p>I've managed to use <a href=""https://stackoverflow.com/questions/1310520/c-amazon-product-advertising-api"">this</a> as a starting point, and have successfully completed a basic request.  I'll continue to look for other resources that are up to date that might go into some other detailed scenarios.</p>",c#|amazon-web-services,"<p>I've been struggling with this also (and I'm also at the learning stage).  </p>

<p>What I found worked best was to use the REST api, and then to parse the results with Linq to XML into a custom results object I could work with.  Excuse the long code paste (not sure on the protocol with that on this board) but figured you'd want it all.  Much of this came from one of Amazon's own samples, but there site is not organized so I'm struggling to find it again.</p>

<pre><code>// custom class for result item
public class AmazonBookSearchResult
{
    public string ASIN;
    public string Author;
    public string Title;
    public Uri DetailPageURL;
    public Uri AllCustomerReviews;
}

// I call this with the search terms, returns an IEnumerable of results
public class ItemLookup
{
    private const string MY_AWS_ACCESS_KEY_ID = ""YOUR KEY"";
    private const string MY_AWS_SECRET_KEY = ""YOUR KEY"";
    private const string DESTINATION = ""ecs.amazonaws.com"";

    private const string NAMESPACE = ""http://webservices.amazon.com/AWSECommerceService/2009-03-31"";

    public static IEnumerable&lt;AmazonBookSearchResult&gt; AmazonItemLookup(string category, string browseNode, string keyWords)
    {
        SignedRequestHelper helper = new SignedRequestHelper(MY_AWS_ACCESS_KEY_ID, MY_AWS_SECRET_KEY, DESTINATION);
        String requestUrl;

        IDictionary&lt;string, string&gt; r1 = new Dictionary&lt;string, String&gt;();
        r1[""Service""] = ""AWSECommerceService"";
        r1[""Version""] = ""2009-03-31"";
        r1[""Operation""] = ""ItemSearch"";
        r1[""ResponseGroup""] = ""ItemAttributes"";
        r1[""SearchIndex""] = category;
        r1[""Keywords""] = keyWords;

        requestUrl = helper.Sign(r1);
        XmlDocument xmlDoc = sendRequest(requestUrl);
        XDocument doc = XDocument.Load(new XmlNodeReader(xmlDoc));

        XNamespace ns = ""http://webservices.amazon.com/AWSECommerceService/2009-03-31"";
        IEnumerable&lt;AmazonBookSearchResult&gt; result =
            from items in doc.Element(ns + ""ItemSearchResponse"").Elements(ns + ""Items"").Elements(ns + ""Item"")
            select new AmazonBookSearchResult
            {
                ASIN = (string)items.Element(ns + ""ASIN"")
            };

        int count = doc.Element(ns + ""ItemSearchResponse"").Elements(ns + ""Items"").Elements(ns + ""Item"").Count();

        return result;

    } // end Lookup()

    // this is just taken from the amazon sample
    private static XmlDocument sendRequest(string url)
    {
        try
        {
            WebRequest request = HttpWebRequest.Create(url);
            WebResponse response = request.GetResponse();
            XmlDocument doc = new XmlDocument();
            doc.Load(response.GetResponseStream());

            XmlNodeList errorMessageNodes = doc.GetElementsByTagName(""Message"", NAMESPACE);
            if (errorMessageNodes != null &amp;&amp; errorMessageNodes.Count &gt; 0)
            {
                String message = errorMessageNodes.Item(0).InnerText;
                throw new Exception(""Error "" + message);
            }

            return doc;
        }
        catch (Exception e)
        {
            System.Console.WriteLine(""Caught Exception: "" + e.Message);
            System.Console.WriteLine(""Stack Trace: "" + e.StackTrace);
        }

        return null;
    }// end FetchTitle()
}

class SignedRequestHelper
{
    private string endPoint;
    private string akid;
    private byte[] secret;
    private HMAC signer;

    private const string REQUEST_URI = ""/onca/xml"";
    private const string REQUEST_METHOD = ""GET"";

    /*
     * Use this constructor to create the object. The AWS credentials are available on
     * http://aws.amazon.com
     *
     * The destination is the service end-point for your application:
     *  US: ecs.amazonaws.com
     *  JP: ecs.amazonaws.jp
     *  UK: ecs.amazonaws.co.uk
     *  DE: ecs.amazonaws.de
     *  FR: ecs.amazonaws.fr
     *  CA: ecs.amazonaws.ca
     */
    public SignedRequestHelper(string awsAccessKeyId, string awsSecretKey, string destination)
    {
        this.endPoint = destination.ToLower();
        this.akid = awsAccessKeyId;
        this.secret = Encoding.UTF8.GetBytes(awsSecretKey);
        this.signer = new HMACSHA256(this.secret);
    }

    /*
     * Sign a request in the form of a Dictionary of name-value pairs.
     *
     * This method returns a complete URL to use. Modifying the returned URL
     * in any way invalidates the signature and Amazon will reject the requests.
     */
    public string Sign(IDictionary&lt;string, string&gt; request)
    {
        // Use a SortedDictionary to get the parameters in naturual byte order, as
        // required by AWS.
        ParamComparer pc = new ParamComparer();
        SortedDictionary&lt;string, string&gt; sortedMap = new SortedDictionary&lt;string, string&gt;(request, pc);

        // Add the AWSAccessKeyId and Timestamp to the requests.
        sortedMap[""AWSAccessKeyId""] = this.akid;
        sortedMap[""Timestamp""] = this.GetTimestamp();

        // Get the canonical query string
        string canonicalQS = this.ConstructCanonicalQueryString(sortedMap);

        // Derive the bytes needs to be signed.
        StringBuilder builder = new StringBuilder();
        builder.Append(REQUEST_METHOD)
            .Append(""\n"")
            .Append(this.endPoint)
            .Append(""\n"")
            .Append(REQUEST_URI)
            .Append(""\n"")
            .Append(canonicalQS);

        string stringToSign = builder.ToString();
        byte[] toSign = Encoding.UTF8.GetBytes(stringToSign);

        // Compute the signature and convert to Base64.
        byte[] sigBytes = signer.ComputeHash(toSign);
        string signature = Convert.ToBase64String(sigBytes);

        // now construct the complete URL and return to caller.
        StringBuilder qsBuilder = new StringBuilder();
        qsBuilder.Append(""http://"")
            .Append(this.endPoint)
            .Append(REQUEST_URI)
            .Append(""?"")
            .Append(canonicalQS)
            .Append(""&amp;Signature="")
            .Append(this.PercentEncodeRfc3986(signature));

        return qsBuilder.ToString();
    }

    /*
     * Sign a request in the form of a query string.
     *
     * This method returns a complete URL to use. Modifying the returned URL
     * in any way invalidates the signature and Amazon will reject the requests.
     */
    public string Sign(string queryString)
    {
        IDictionary&lt;string, string&gt; request = this.CreateDictionary(queryString);
        return this.Sign(request);
    }

    /*
     * Current time in IS0 8601 format as required by Amazon
     */
    private string GetTimestamp()
    {
        DateTime currentTime = DateTime.UtcNow;
        string timestamp = currentTime.ToString(""yyyy-MM-ddTHH:mm:ssZ"");
        return timestamp;
    }

    /*
     * Percent-encode (URL Encode) according to RFC 3986 as required by Amazon.
     *
     * This is necessary because .NET's HttpUtility.UrlEncode does not encode
     * according to the above standard. Also, .NET returns lower-case encoding
     * by default and Amazon requires upper-case encoding.
     */
    private string PercentEncodeRfc3986(string str)
    {
        str = HttpUtility.UrlEncode(str, System.Text.Encoding.UTF8);
        str = str.Replace(""'"", ""%27"").Replace(""("", ""%28"").Replace("")"", ""%29"").Replace(""*"", ""%2A"").Replace(""!"", ""%21"").Replace(""%7e"", ""~"").Replace(""+"", ""%20"");

        StringBuilder sbuilder = new StringBuilder(str);
        for (int i = 0; i &lt; sbuilder.Length; i++)
        {
            if (sbuilder[i] == '%')
            {
                if (Char.IsLetter(sbuilder[i + 1]) || Char.IsLetter(sbuilder[i + 2]))
                {
                    sbuilder[i + 1] = Char.ToUpper(sbuilder[i + 1]);
                    sbuilder[i + 2] = Char.ToUpper(sbuilder[i + 2]);
                }
            }
        }
        return sbuilder.ToString();
    }

    /*
     * Convert a query string to corresponding dictionary of name-value pairs.
     */
    private IDictionary&lt;string, string&gt; CreateDictionary(string queryString)
    {
        Dictionary&lt;string, string&gt; map = new Dictionary&lt;string, string&gt;();

        string[] requestParams = queryString.Split('&amp;');

        for (int i = 0; i &lt; requestParams.Length; i++)
        {
            if (requestParams[i].Length &lt; 1)
            {
                continue;
            }

            char[] sep = { '=' };
            string[] param = requestParams[i].Split(sep, 2);
            for (int j = 0; j &lt; param.Length; j++)
            {
                param[j] = HttpUtility.UrlDecode(param[j], System.Text.Encoding.UTF8);
            }
            switch (param.Length)
            {
                case 1:
                    {
                        if (requestParams[i].Length &gt;= 1)
                        {
                            if (requestParams[i].ToCharArray()[0] == '=')
                            {
                                map[""""] = param[0];
                            }
                            else
                            {
                                map[param[0]] = """";
                            }
                        }
                        break;
                    }
                case 2:
                    {
                        if (!string.IsNullOrEmpty(param[0]))
                        {
                            map[param[0]] = param[1];
                        }
                    }
                    break;
            }
        }

        return map;
    }

    /*
     * Consttuct the canonical query string from the sorted parameter map.
     */
    private string ConstructCanonicalQueryString(SortedDictionary&lt;string, string&gt; sortedParamMap)
    {
        StringBuilder builder = new StringBuilder();

        if (sortedParamMap.Count == 0)
        {
            builder.Append("""");
            return builder.ToString();
        }

        foreach (KeyValuePair&lt;string, string&gt; kvp in sortedParamMap)
        {
            builder.Append(this.PercentEncodeRfc3986(kvp.Key));
            builder.Append(""="");
            builder.Append(this.PercentEncodeRfc3986(kvp.Value));
            builder.Append(""&amp;"");
        }
        string canonicalString = builder.ToString();
        canonicalString = canonicalString.Substring(0, canonicalString.Length - 1);
        return canonicalString;
    }
}

/*
 * To help the SortedDictionary order the name-value pairs in the correct way.
 */
class ParamComparer : IComparer&lt;string&gt;
{
    public int Compare(string p1, string p2)
    {
        return string.CompareOrdinal(p1, p2);
    }
}
</code></pre>",1
4149973,"Amazon Product API - are there any valid, up-to-date examples in C#?","<p>I must have run through 10 different sample C# projects that are out of date, and no longer work.</p>

<p>All I'm after is a way to get a book's information back based on an ISBN or title.</p>

<p>The Amazon Web Service site is an absolutely miserable morass.</p>

<p><strong>Update:</strong></p>

<p>I've managed to use <a href=""https://stackoverflow.com/questions/1310520/c-amazon-product-advertising-api"">this</a> as a starting point, and have successfully completed a basic request.  I'll continue to look for other resources that are up to date that might go into some other detailed scenarios.</p>",c#|amazon-web-services,"<p>You can download this example from Amazon 
<a href=""http://aws.amazon.com/code/Product-Advertising-API/3941"" rel=""nofollow"">Product Advertising API Signed Requests Sample Code - C# SOAP WCF 4.0</a></p>

<p>If you use SOAP (in this case) it will be much simpler for you to get the information you need than using REST.</p>

<p>I don't think that using REST in this case is simpler than using the SOAP calls which in C# returns a well formed object in which you can get all the information you need about the product without all the extra coding. I guess everybody is using REST nowadays because is trendy, I only use it when is simpler to integrate. In case of Amazon Product Advertising API I would rather use the SOAP api.</p>",0
4149973,"Amazon Product API - are there any valid, up-to-date examples in C#?","<p>I must have run through 10 different sample C# projects that are out of date, and no longer work.</p>

<p>All I'm after is a way to get a book's information back based on an ISBN or title.</p>

<p>The Amazon Web Service site is an absolutely miserable morass.</p>

<p><strong>Update:</strong></p>

<p>I've managed to use <a href=""https://stackoverflow.com/questions/1310520/c-amazon-product-advertising-api"">this</a> as a starting point, and have successfully completed a basic request.  I'll continue to look for other resources that are up to date that might go into some other detailed scenarios.</p>",c#|amazon-web-services,"<p>The SprightlySoft AWS Component for .NET allows you to interact will all Amazon service including the Product Advertising API.  Here is some sample code for looking up an ISBN.  Get the component for free at <a href=""http://sprightlysoft.com/"" rel=""nofollow"">http://sprightlysoft.com/</a>.</p>

<pre><code>//Product Advertising API, ItemLookup: http://docs.amazonwebservices.com/AWSECommerceService/2010-10-01/DG/ItemLookup.html

SprightlySoftAWS.REST MyREST = new SprightlySoftAWS.REST();

String RequestURL;
RequestURL = ""https://ecs.amazonaws.com/onca/xml?Service=AWSECommerceService&amp;Operation=ItemLookup&amp;Version=2010-10-01"";
RequestURL += ""&amp;AWSAccessKeyId="" + System.Uri.EscapeDataString(AWSAccessKeyId) + ""&amp;SignatureVersion=2&amp;SignatureMethod=HmacSHA256&amp;Timestamp="" + Uri.EscapeDataString(DateTime.UtcNow.ToString(""yyyy-MM-dd\\THH:mm:ss.fff\\Z""));
RequestURL += ""&amp;ItemId=9781904233657"";
RequestURL += ""&amp;IdType=ISBN"";
RequestURL += ""&amp;SearchIndex=Books"";

String RequestMethod;
RequestMethod = ""GET"";

String SignatureValue;
SignatureValue = MyREST.GetSignatureVersion2Value(RequestURL, RequestMethod, """", AWSSecretAccessKey);

RequestURL += ""&amp;Signature="" + System.Uri.EscapeDataString(SignatureValue);

Boolean RetBool;
RetBool = MyREST.MakeRequest(RequestURL, RequestMethod, null);

System.Diagnostics.Debug.Print("""");
System.Diagnostics.Debug.Print(MyREST.LogData);
System.Diagnostics.Debug.Print("""");

String ResponseMessage = """";

if (RetBool == true)
{
    System.Xml.XmlDocument MyXmlDocument;
    System.Xml.XmlNamespaceManager MyXmlNamespaceManager;
    System.Xml.XmlNode MyXmlNode;
    System.Xml.XmlNodeList MyXmlNodeList;

    MyXmlDocument = new System.Xml.XmlDocument();
    MyXmlDocument.LoadXml(MyREST.ResponseString);

    MyXmlNamespaceManager = new System.Xml.XmlNamespaceManager(MyXmlDocument.NameTable);
    MyXmlNamespaceManager.AddNamespace(""amz"", ""http://webservices.amazon.com/AWSECommerceService/2010-10-01"");

    MyXmlNodeList = MyXmlDocument.SelectNodes(""amz:ItemLookupResponse/amz:Items/amz:Item"", MyXmlNamespaceManager);

    if (MyXmlNodeList.Count == 0)
    {
        ResponseMessage = ""No items found."";
    }
    else
    {
        foreach (System.Xml.XmlNode ItemXmlNode in MyXmlNodeList)
        {
            MyXmlNode = ItemXmlNode.SelectSingleNode(""amz:ItemAttributes/amz:Title"", MyXmlNamespaceManager);
            ResponseMessage += ""Title = "" + MyXmlNode.InnerText;

            ResponseMessage += Environment.NewLine;
        }
    }

    MessageBox.Show(ResponseMessage);
}
else
{
    ResponseMessage = MyREST.ResponseStringFormatted;

    MessageBox.Show(ResponseMessage);
}
</code></pre>",3
4149973,"Amazon Product API - are there any valid, up-to-date examples in C#?","<p>I must have run through 10 different sample C# projects that are out of date, and no longer work.</p>

<p>All I'm after is a way to get a book's information back based on an ISBN or title.</p>

<p>The Amazon Web Service site is an absolutely miserable morass.</p>

<p><strong>Update:</strong></p>

<p>I've managed to use <a href=""https://stackoverflow.com/questions/1310520/c-amazon-product-advertising-api"">this</a> as a starting point, and have successfully completed a basic request.  I'll continue to look for other resources that are up to date that might go into some other detailed scenarios.</p>",c#|amazon-web-services,"<p>A while back I had wrote a client library for communicating with Amazon's ECS (A2S) services.  Seems that Amazon hates their developers and keeps changing their service name and framework.  Well, my client is now completely broken because of <a href=""http://developer.amazonwebservices.com/connect/ann.jspa?annID=483"" rel=""nofollow"">Recent API Changes</a>.</p>

<p>Your best bet would be to look at their samples <a href=""http://aws.amazon.com/code/Product-Advertising-API/3941"" rel=""nofollow"">here</a>.</p>

<p>Good luck with this. Their API is huge and outdated from the experience I had, but that was two years ago. I get the impression that they really cater to developers for their enterprise services, not the free A2S.</p>",2
4681949,Use LINQ to group a sequence of numbers with no gaps,"<p>With this array <code>int[]{ 1, 2, 3, 4, 7, 8, 11, 15,16,17,18 };</code>
How can i convert to this string array <code>""1-4"",""7-8"",""11"",""15-18""</code></p>

<p>Suggestions ? Linq ?</p>",c#|linq,"<p>Here is a cut at it:</p>

<pre><code>public static IEnumerable&lt;string&gt; ToRanges(this IEnumerable&lt;int&gt; values)
{
    int? start = null, end = null;
    foreach (var value in values.OrderBy(vv =&gt; vv))
    {
        if (!start.HasValue)
        {
            start = value;
        }
        else if (value == (end ?? start) + 1)
        {
            end = value;
        }
        else
        {
            yield return end.HasValue
                ? String.Format(""{0}-{1}"", start, end)
                : String.Format(""{0}"", start);
            start = value;
            end = null;
        }
    }

    if (start.HasValue)
    {
        yield return end.HasValue
            ? String.Format(""{0}-{1}"", start, end)
            : String.Format(""{0}"", start);
    }
}
</code></pre>",1
4681949,Use LINQ to group a sequence of numbers with no gaps,"<p>With this array <code>int[]{ 1, 2, 3, 4, 7, 8, 11, 15,16,17,18 };</code>
How can i convert to this string array <code>""1-4"",""7-8"",""11"",""15-18""</code></p>

<p>Suggestions ? Linq ?</p>",c#|linq,"<p>What's the algorithm you want to implement? Figure out what you want to happen, then see if it could be made clearer with a LINQ translation. Here's something non-LINQ that could give you an idea.</p>

<pre><code>int[] array = { 1, 2, 3, 4, 7, 8, 11, 15, 16, 17, 18};
List&lt;string&gt; ranges = new List&lt;string&gt;();

// code assumes array is not zero-length, is distinct, and is sorted.
// to do: handle scenario as appropriate if assumptions not valid

Action&lt;int, int, List&lt;string&gt;&gt; addToRanges = (first, last, list) =&gt;
{
    if (last == first)
        list.Add(last.ToString());
    else
        list.Add(string.Format(""{0}-{1}"", first, last)); ;
};

int firstItem = array[0];
int lastItem = firstItem;
foreach (int item in array.Skip(1))
{
    if (item &gt; lastItem + 1)
    {
        addToRanges(firstItem, lastItem, ranges);
        firstItem = lastItem = item;
    }
    else
    {
        lastItem = item;
    }
}

addToRanges(firstItem, lastItem, ranges);

// return ranges or ranges.ToArray()
</code></pre>",1
4681949,Use LINQ to group a sequence of numbers with no gaps,"<p>With this array <code>int[]{ 1, 2, 3, 4, 7, 8, 11, 15,16,17,18 };</code>
How can i convert to this string array <code>""1-4"",""7-8"",""11"",""15-18""</code></p>

<p>Suggestions ? Linq ?</p>",c#|linq,"<p>You don't need Linq; in fact, the easiest solution requires knowing about three positions in the array (your starting number, current number and the next number after the current), for which Enumerables are not well-suited.</p>

<p>Try this:</p>

<pre><code>var start = 0;
var end = 0;
var write = false;
var builder = new StringBuilder();
for(var i=0; i&lt;array.Length; i++)
{
   //arranged this way to avoid ArrayOutOfBoundException
   //if the next index doesn't exist or isn't one greater than the current,
   //the current index is the end of our incremental range.
   if(i+1 == array.Length || array[i+1] &gt; array[i] + 1)
   {
      end = i;
      write = true;
   }

   if(write)
   {
      if(end - start == 0) //one number
         builder.Append(String.Format(""{0}, "", array[start]);
      else //multi-number range
         builder.Append(String.Format(""{0}-{1}, "", array[start], array[end]);

      start = i+1;
      end = i+1; //not really necessary but avoids any possible case of counting backwards
      write = false;
   }  

}
</code></pre>

<p>You can rearrange this to reduce nesting of code, <code>continue</code> early in the loop logic, and remove a few vars; you'll gain a few millis of execution time. You'll also need to trim the last two characters (a trailing comma and space) off the end of the StringBuilder before getting the String out.</p>",4
4681949,Use LINQ to group a sequence of numbers with no gaps,"<p>With this array <code>int[]{ 1, 2, 3, 4, 7, 8, 11, 15,16,17,18 };</code>
How can i convert to this string array <code>""1-4"",""7-8"",""11"",""15-18""</code></p>

<p>Suggestions ? Linq ?</p>",c#|linq,"<pre><code>var array = new int[] { 1, 2, 3, 4, 7, 8, 11, 15, 16, 17, 18 };

var result = string.Join("","", array
    .Distinct()
    .OrderBy(x =&gt; x)
    .GroupAdjacentBy((x, y) =&gt; x + 1 == y)
    .Select(g =&gt; new int[] { g.First(), g.Last() }.Distinct())
    .Select(g =&gt; string.Join(""-"", g)));
</code></pre>

<p>with</p>

<pre><code>public static class LinqExtensions
{
    public static IEnumerable&lt;IEnumerable&lt;T&gt;&gt; GroupAdjacentBy&lt;T&gt;(
        this IEnumerable&lt;T&gt; source, Func&lt;T, T, bool&gt; predicate)
    {
        using (var e = source.GetEnumerator())
        {
            if (e.MoveNext())
            {
                var list = new List&lt;T&gt; { e.Current };
                var pred = e.Current;
                while (e.MoveNext())
                {
                    if (predicate(pred, e.Current))
                    {
                        list.Add(e.Current);
                    }
                    else
                    {
                        yield return list;
                        list = new List&lt;T&gt; { e.Current };
                    }
                    pred = e.Current;
                }
                yield return list;
            }
        }
    }
}
</code></pre>",43
4085983,How to avoid null key errors in dictionary?,"<p>How to avoid error if key is null?</p>

<pre><code>//Getter/setter
public static Dictionary&lt;string, string&gt; Dictionary
{
    get { return Global.dictionary; }
    set { Global.dictionary = value; }
}
</code></pre>

<p><strong>UPDATE:</strong></p>

<pre><code>Dictionary.Add(""Key1"", ""Text1"");
Dictionary[""Key2""] &lt;-error! so what can I write in the GET to avoid error?
</code></pre>

<p>Thanks.</p>

<p>regards</p>",c#|static-methods,"<p>You can use the <a href=""http://msdn.microsoft.com/en-us/library/kw5aaea4.aspx"" rel=""noreferrer""><code>Dictionary.ContainsKey</code></a> method.</p>

<p>So you'd write:</p>

<pre><code>if (myDictionary.ContainsKey(""Key2""))
{
    // Do something.
}
</code></pre>

<p>The other alternatives are to either wrap the access in a <code>try...catch</code> block or use <a href=""http://msdn.microsoft.com/en-us/library/bb347013.aspx"" rel=""noreferrer""><code>TryGetValue</code></a> (see the examples on the MSDN page linked to).</p>

<pre><code>string result = null;
if (dict.TryGetValue(""Key2"", out result))
{
    // Do something with result
}
</code></pre>

<p>The <code>TryGetMethod</code> is more efficient if you want do something with the result as you don't need a second call to get the value (as you would with the <code>ContainsKey</code> method).</p>

<p>(Of course, in both methods you'd replace ""Key2"" with a variable.)</p>",12
4085983,How to avoid null key errors in dictionary?,"<p>How to avoid error if key is null?</p>

<pre><code>//Getter/setter
public static Dictionary&lt;string, string&gt; Dictionary
{
    get { return Global.dictionary; }
    set { Global.dictionary = value; }
}
</code></pre>

<p><strong>UPDATE:</strong></p>

<pre><code>Dictionary.Add(""Key1"", ""Text1"");
Dictionary[""Key2""] &lt;-error! so what can I write in the GET to avoid error?
</code></pre>

<p>Thanks.</p>

<p>regards</p>",c#|static-methods,"<p>You're returning the wrong thing.  Don't return the dictionary, pass in a key and return the value.</p>

<pre><code>public static string GetValue(string key)
{
    if(Global.dictionary.ContainsKey(key))
    {
        return Global.dictionary[key];
    }

    return """"; // or some other value
}
</code></pre>",0
4085983,How to avoid null key errors in dictionary?,"<p>How to avoid error if key is null?</p>

<pre><code>//Getter/setter
public static Dictionary&lt;string, string&gt; Dictionary
{
    get { return Global.dictionary; }
    set { Global.dictionary = value; }
}
</code></pre>

<p><strong>UPDATE:</strong></p>

<pre><code>Dictionary.Add(""Key1"", ""Text1"");
Dictionary[""Key2""] &lt;-error! so what can I write in the GET to avoid error?
</code></pre>

<p>Thanks.</p>

<p>regards</p>",c#|static-methods,"<p>An extension method:</p>

<pre><code>public static TValue GetValue&lt;TKey, TValue&gt;(this Dictionary&lt;TKey, TValue&gt; dic, TKey key)
{
    TValue result;
    return dic.TryGetValue(key, out result) ?
        result :
        default(TValue);
}
</code></pre>

<p>Usage:</p>

<pre><code>var dic = new Dictionary&lt;string, string&gt;
{
   { ""key"", ""value"" }
};

string r1 = dic.GetValue(""key""); // ""value""
string r2 = dic.GetValue(""false""); // null
</code></pre>",2
4085983,How to avoid null key errors in dictionary?,"<p>How to avoid error if key is null?</p>

<pre><code>//Getter/setter
public static Dictionary&lt;string, string&gt; Dictionary
{
    get { return Global.dictionary; }
    set { Global.dictionary = value; }
}
</code></pre>

<p><strong>UPDATE:</strong></p>

<pre><code>Dictionary.Add(""Key1"", ""Text1"");
Dictionary[""Key2""] &lt;-error! so what can I write in the GET to avoid error?
</code></pre>

<p>Thanks.</p>

<p>regards</p>",c#|static-methods,<p>A key can never be null in a dictionary. A dictionary is a hashtable where by definition you need a non-empty key or the hash function cannot map to the corresponding element.</p>,0
4085983,How to avoid null key errors in dictionary?,"<p>How to avoid error if key is null?</p>

<pre><code>//Getter/setter
public static Dictionary&lt;string, string&gt; Dictionary
{
    get { return Global.dictionary; }
    set { Global.dictionary = value; }
}
</code></pre>

<p><strong>UPDATE:</strong></p>

<pre><code>Dictionary.Add(""Key1"", ""Text1"");
Dictionary[""Key2""] &lt;-error! so what can I write in the GET to avoid error?
</code></pre>

<p>Thanks.</p>

<p>regards</p>",c#|static-methods,"<p>Use <code>TryGetValue</code>:</p>

<pre><code>Dictionary&lt;int, string&gt; dict = ...;
string value;

if (dict.TryGetValue(key, out value))
{
    // value found
    return value;
}
else
{
    // value not found, return what you want
}
</code></pre>",17
4835979,Grouping Logical Operators (Multiple Sets of Conditions) in a do {} while () loop?,"<p>I currently have the following loop:</p>

<pre><code>do {
       checkedWord = articleWords.Dequeue().TrimEnd('?', '.', ',', '!');
       correct = _spellChecker.CheckWord(checkedWord);
   } while (correct &amp;&amp; articleWords.Count &gt; 0);
</code></pre>

<p>I am queuing up the words from an array that was split from a textbox with <code>' '</code> as the separator. The loop works fine, except for I don't want any blank entries <code>""""</code> or really anything non alpha-numeric to stop the loop. Currently if there's more than one space between the words then the loop ends and it continues on to get word suggestions from the spellchecker.</p>

<p>If I do <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || checkedWord == """");</code> then it'll skip any blank queue entries, but it still hangs up on things like new lines - so if the textbox that it loads from contains a couple of paragraphs it screws up at the newline separating the two. I've also tried <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || !Char.IsLetterOrDigit(checkedWord, 0));</code> but that also doesn't work.</p>

<p><strong>Question 1</strong>: Can you group conditions like <code>(statement1 == true &amp;&amp; count &gt; 0) || (statement1 == false &amp;&amp; Char.IsLetterOrDigit(char))</code>? - Meaning that all of the conditions in the first grouping must be met OR all of the conditions in the second set must be.</p>

<p><strong>Question 2</strong>: I want my loop to continue progressing until an actual spelling error is found, and for it to ignore things like empty queue entries, as well as anything that's not an alpha-numeric character at the beginning of the string.</p>

<p>I suspect that I'm close with the <code>Char.IsLetterOrDigit</code> bit, but have to figure out how to do it correctly.</p>

<p>Let me know if more info is required. </p>

<p>Thanks!</p>",c#|.net|silverlight|silverlight-4.0,"<p>You should not use composite loop condition, a good practice is usage while loop with easy general condition and 'break' in loop body when you should leave it.</p>

<p>You can use some thing like this:</p>

<pre><code>public void Test()
{
    var separators = new[] { ' ', '\t', '\r', '\x00a0', '\x0085', '?', ',', '.', '!' };

    var input = ""Test  string, news112!  news \n next, line! error in error word"";          
    var tokens = new Queue&lt;string&gt;(input.Split(separators, StringSplitOptions.RemoveEmptyEntries));

    string currentWord = null;

    while (tokens.Any())
    {
        currentWord = tokens.Dequeue();
        if (currentWord.All(c =&gt; Char.IsLetterOrDigit(c)))
        {
            if (!CheckSpell(currentWord))
            {
                break;
            }
        }
    }
}

public bool CheckSpell(string word)
{
    return word != null &amp;&amp; word.Length &gt; 0 &amp;&amp; word[0] != 'e';
}
</code></pre>",1
4835979,Grouping Logical Operators (Multiple Sets of Conditions) in a do {} while () loop?,"<p>I currently have the following loop:</p>

<pre><code>do {
       checkedWord = articleWords.Dequeue().TrimEnd('?', '.', ',', '!');
       correct = _spellChecker.CheckWord(checkedWord);
   } while (correct &amp;&amp; articleWords.Count &gt; 0);
</code></pre>

<p>I am queuing up the words from an array that was split from a textbox with <code>' '</code> as the separator. The loop works fine, except for I don't want any blank entries <code>""""</code> or really anything non alpha-numeric to stop the loop. Currently if there's more than one space between the words then the loop ends and it continues on to get word suggestions from the spellchecker.</p>

<p>If I do <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || checkedWord == """");</code> then it'll skip any blank queue entries, but it still hangs up on things like new lines - so if the textbox that it loads from contains a couple of paragraphs it screws up at the newline separating the two. I've also tried <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || !Char.IsLetterOrDigit(checkedWord, 0));</code> but that also doesn't work.</p>

<p><strong>Question 1</strong>: Can you group conditions like <code>(statement1 == true &amp;&amp; count &gt; 0) || (statement1 == false &amp;&amp; Char.IsLetterOrDigit(char))</code>? - Meaning that all of the conditions in the first grouping must be met OR all of the conditions in the second set must be.</p>

<p><strong>Question 2</strong>: I want my loop to continue progressing until an actual spelling error is found, and for it to ignore things like empty queue entries, as well as anything that's not an alpha-numeric character at the beginning of the string.</p>

<p>I suspect that I'm close with the <code>Char.IsLetterOrDigit</code> bit, but have to figure out how to do it correctly.</p>

<p>Let me know if more info is required. </p>

<p>Thanks!</p>",c#|.net|silverlight|silverlight-4.0,"<p>If your goal is to find the first error, you can skip the while loop and do the following:</p>

<pre><code>var firstError = tokens.Where(t =&gt; t.All(Char.IsLetterOrDigit) &amp;&amp; !_spellChecker.CheckWord(t)).FirstOrDefault();
</code></pre>",1
4835979,Grouping Logical Operators (Multiple Sets of Conditions) in a do {} while () loop?,"<p>I currently have the following loop:</p>

<pre><code>do {
       checkedWord = articleWords.Dequeue().TrimEnd('?', '.', ',', '!');
       correct = _spellChecker.CheckWord(checkedWord);
   } while (correct &amp;&amp; articleWords.Count &gt; 0);
</code></pre>

<p>I am queuing up the words from an array that was split from a textbox with <code>' '</code> as the separator. The loop works fine, except for I don't want any blank entries <code>""""</code> or really anything non alpha-numeric to stop the loop. Currently if there's more than one space between the words then the loop ends and it continues on to get word suggestions from the spellchecker.</p>

<p>If I do <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || checkedWord == """");</code> then it'll skip any blank queue entries, but it still hangs up on things like new lines - so if the textbox that it loads from contains a couple of paragraphs it screws up at the newline separating the two. I've also tried <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || !Char.IsLetterOrDigit(checkedWord, 0));</code> but that also doesn't work.</p>

<p><strong>Question 1</strong>: Can you group conditions like <code>(statement1 == true &amp;&amp; count &gt; 0) || (statement1 == false &amp;&amp; Char.IsLetterOrDigit(char))</code>? - Meaning that all of the conditions in the first grouping must be met OR all of the conditions in the second set must be.</p>

<p><strong>Question 2</strong>: I want my loop to continue progressing until an actual spelling error is found, and for it to ignore things like empty queue entries, as well as anything that's not an alpha-numeric character at the beginning of the string.</p>

<p>I suspect that I'm close with the <code>Char.IsLetterOrDigit</code> bit, but have to figure out how to do it correctly.</p>

<p>Let me know if more info is required. </p>

<p>Thanks!</p>",c#|.net|silverlight|silverlight-4.0,"<ol>
<li><p>So long as you have a valid boolean expression, you can do that without an issue. This is something that is <em>very</em> easy to test.</p></li>
<li><p>To use <code>Char.IsLetterOrDigit</code> you will need to loop over each character in the string and test it.</p></li>
</ol>",0
4835979,Grouping Logical Operators (Multiple Sets of Conditions) in a do {} while () loop?,"<p>I currently have the following loop:</p>

<pre><code>do {
       checkedWord = articleWords.Dequeue().TrimEnd('?', '.', ',', '!');
       correct = _spellChecker.CheckWord(checkedWord);
   } while (correct &amp;&amp; articleWords.Count &gt; 0);
</code></pre>

<p>I am queuing up the words from an array that was split from a textbox with <code>' '</code> as the separator. The loop works fine, except for I don't want any blank entries <code>""""</code> or really anything non alpha-numeric to stop the loop. Currently if there's more than one space between the words then the loop ends and it continues on to get word suggestions from the spellchecker.</p>

<p>If I do <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || checkedWord == """");</code> then it'll skip any blank queue entries, but it still hangs up on things like new lines - so if the textbox that it loads from contains a couple of paragraphs it screws up at the newline separating the two. I've also tried <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || !Char.IsLetterOrDigit(checkedWord, 0));</code> but that also doesn't work.</p>

<p><strong>Question 1</strong>: Can you group conditions like <code>(statement1 == true &amp;&amp; count &gt; 0) || (statement1 == false &amp;&amp; Char.IsLetterOrDigit(char))</code>? - Meaning that all of the conditions in the first grouping must be met OR all of the conditions in the second set must be.</p>

<p><strong>Question 2</strong>: I want my loop to continue progressing until an actual spelling error is found, and for it to ignore things like empty queue entries, as well as anything that's not an alpha-numeric character at the beginning of the string.</p>

<p>I suspect that I'm close with the <code>Char.IsLetterOrDigit</code> bit, but have to figure out how to do it correctly.</p>

<p>Let me know if more info is required. </p>

<p>Thanks!</p>",c#|.net|silverlight|silverlight-4.0,"<p>When it comes to text selections you should use regular expressions. It is very powerfull and fast framework for text queries. It is capable of doing it's job with O(n) complexity.  It helps you because you don't have to think how you will select your text values you just specify what you need</p>

<p>Try this code. The pattern part @""\w+"" means that I want to select all groups of alphanumeric symbols whose length > 1. If I'd wanted to select all words that start with letter 't' than I would write @""t\w+"". </p>

<pre><code>using System;
using System.Text;
using System.Text.RegularExpressions;

namespace Test
{
    class Program
    {
        static void Main(string[] args)
        {
            string str = ""The quick brown fox jumps over the lazy dog"";

            Regex regex = new Regex(@""\w+"", RegexOptions.Compiled);


            for (Match match = regex.Match(str); match.Success; match = match.NextMatch())
            {
                Console.WriteLine(match.Value);
            }
        }
    }
}
</code></pre>",0
4835979,Grouping Logical Operators (Multiple Sets of Conditions) in a do {} while () loop?,"<p>I currently have the following loop:</p>

<pre><code>do {
       checkedWord = articleWords.Dequeue().TrimEnd('?', '.', ',', '!');
       correct = _spellChecker.CheckWord(checkedWord);
   } while (correct &amp;&amp; articleWords.Count &gt; 0);
</code></pre>

<p>I am queuing up the words from an array that was split from a textbox with <code>' '</code> as the separator. The loop works fine, except for I don't want any blank entries <code>""""</code> or really anything non alpha-numeric to stop the loop. Currently if there's more than one space between the words then the loop ends and it continues on to get word suggestions from the spellchecker.</p>

<p>If I do <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || checkedWord == """");</code> then it'll skip any blank queue entries, but it still hangs up on things like new lines - so if the textbox that it loads from contains a couple of paragraphs it screws up at the newline separating the two. I've also tried <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || !Char.IsLetterOrDigit(checkedWord, 0));</code> but that also doesn't work.</p>

<p><strong>Question 1</strong>: Can you group conditions like <code>(statement1 == true &amp;&amp; count &gt; 0) || (statement1 == false &amp;&amp; Char.IsLetterOrDigit(char))</code>? - Meaning that all of the conditions in the first grouping must be met OR all of the conditions in the second set must be.</p>

<p><strong>Question 2</strong>: I want my loop to continue progressing until an actual spelling error is found, and for it to ignore things like empty queue entries, as well as anything that's not an alpha-numeric character at the beginning of the string.</p>

<p>I suspect that I'm close with the <code>Char.IsLetterOrDigit</code> bit, but have to figure out how to do it correctly.</p>

<p>Let me know if more info is required. </p>

<p>Thanks!</p>",c#|.net|silverlight|silverlight-4.0,"<p>Q1: Sure, it's possible to group conditions like that.</p>

<p>Q2: What about something like this?</p>

<pre><code>string[] articleWords = textBoxText.Split(' ');
articleWords = articleWords.Select(a =&gt; a.Trim()).ToArray();    // remove all whitespaces (blanks, linebreaks)
articleWords = articleWords.Where(a =&gt; !string.IsNullOrEmpty(a)).ToArray(); // remove empty strings

bool correct = false;
bool spellingErrorFound = false;
for (int i = 0; i &lt; articleWords.Length; i++)
{
    string checkedWord = articleWords[i].TrimEnd('?', '.', ',', '!');
    correct = _spellChecker.CheckWord(checkedWord);

    if (!correct)
        spellingErrorFound = true;
}
</code></pre>",0
4835979,Grouping Logical Operators (Multiple Sets of Conditions) in a do {} while () loop?,"<p>I currently have the following loop:</p>

<pre><code>do {
       checkedWord = articleWords.Dequeue().TrimEnd('?', '.', ',', '!');
       correct = _spellChecker.CheckWord(checkedWord);
   } while (correct &amp;&amp; articleWords.Count &gt; 0);
</code></pre>

<p>I am queuing up the words from an array that was split from a textbox with <code>' '</code> as the separator. The loop works fine, except for I don't want any blank entries <code>""""</code> or really anything non alpha-numeric to stop the loop. Currently if there's more than one space between the words then the loop ends and it continues on to get word suggestions from the spellchecker.</p>

<p>If I do <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || checkedWord == """");</code> then it'll skip any blank queue entries, but it still hangs up on things like new lines - so if the textbox that it loads from contains a couple of paragraphs it screws up at the newline separating the two. I've also tried <code>while (correct &amp;&amp; articleWords.Count &gt; 0 || !Char.IsLetterOrDigit(checkedWord, 0));</code> but that also doesn't work.</p>

<p><strong>Question 1</strong>: Can you group conditions like <code>(statement1 == true &amp;&amp; count &gt; 0) || (statement1 == false &amp;&amp; Char.IsLetterOrDigit(char))</code>? - Meaning that all of the conditions in the first grouping must be met OR all of the conditions in the second set must be.</p>

<p><strong>Question 2</strong>: I want my loop to continue progressing until an actual spelling error is found, and for it to ignore things like empty queue entries, as well as anything that's not an alpha-numeric character at the beginning of the string.</p>

<p>I suspect that I'm close with the <code>Char.IsLetterOrDigit</code> bit, but have to figure out how to do it correctly.</p>

<p>Let me know if more info is required. </p>

<p>Thanks!</p>",c#|.net|silverlight|silverlight-4.0,"<p>Q1. Absolutely. Just make sure your groupings are properly separated.</p>

<p>Q2. For performance and clarity, I would use REGEX to clean your input before queuing:</p>

<pre><code>using System.Text.RegularExpressions;
...
string input = GetArticle(); // or however you get your input

input = Regex.Replace(input, @""[^0-9\w\s]"", string.Empty);

// not sure what your separators but you can always
// reduce multiple spaces to a single space and just split
// on the single space
var articleWords = new Queue&lt;string&gt;(input.Split( ... ));

do {
     checkedWord = articleWords.Dequeue();

     // put your conditional grouping here if you want
     if(!_spellChecker.CheckWord(checkedWord)) {
          // only update ""correct"" if necessary - writes are more expensive =)
          // although with the ""break"" below you shouldn't need ""correct"" anymore
          // correct = false;

          // in case you want to raise an event - it's cleaner =)
          OnSpellingError(checkWord);

          // if you want to stop looping because of the error
          break;
     }
}
while(articleWords.Count &gt; 0);
</code></pre>

<p>I wouldn't use <code>Char.IsLetterOrDigit</code> as I think that would be slower...besides, with the REGEX in the beginning you should have taken care of the entries that aren't characters or digits.</p>

<p><strong>EDIT</strong> Adding LINQ response</p>

<p>On second thought, I think you're just trying to find spelling errors so how about this?</p>

<pre><code>using System.Text.RegularExpressions;
...
string input = GetArticle(); // or however you get your input

// clean up words from punctuation
input = Regex.Replace(input, @""[^0-9\w\s]"", string.Empty);

// trim whitespace
input = Regex.Replace(c, @""\s+"", @"" "");

var errors = input.Split(new char[] { ' ' }, StringSplitOptions.RemoveEmptyEntries).All(w =&gt; !_spellChecker.CheckWord(w));
</code></pre>

<p>Then you can just do whatever you want with the errors =) Or you can just use a <code>.Any</code> if you just want to know whether there exists a spelling mistake at all.</p>",0
4739795,How can I test for negative zero?,<p>Initially I thought <code>Math.Sign</code> would be the proper way to go but after running a test it seems that it treats <code>-0.0</code> and <code>+0.0</code> the same.</p>,c#|.net|floating-point,"<p>More generally, you can do,</p>

<pre><code>bool IsNegative(double value)
{
    const ulong SignBit = 0x8000000000000000;
    return ((ulong)BitConverter.DoubleToInt64Bits(value) &amp; SignBit) == SignBit;
}
</code></pre>

<hr>

<p>or alternatively, if you prefer,</p>

<pre><code>[StructLayout(LayoutKind.Explicit)]
private struct DoubleULong
{
    [FieldOffset(0)]
    public double Double;

    [FieldOffset(0)]
    public readonly ulong ULong;
}

bool IsNegative(double value)
{
    var du = new DoubleULong { Double = value };
    return ((du.ULong &gt;&gt; 62) &amp; 2) == 2;
}
</code></pre>

<p>The later gives an approximate 50% performance improvment in debug but. Once compiled in release mode and run from the command line <strong>there is no significant difference</strong>.</p>

<p>I couldn't generate a performance improvement using unsafe code either but this may be due to my inexperience.</p>",1
4739795,How can I test for negative zero?,<p>Initially I thought <code>Math.Sign</code> would be the proper way to go but after running a test it seems that it treats <code>-0.0</code> and <code>+0.0</code> the same.</p>,c#|.net|floating-point,"<p>Here's another hack. It takes advantage of the fact that <code>Equals</code> on a <code>struct</code> will do a bitwise comparison instead of calling <code>Equals</code> on its members:</p>

<pre><code>struct Negative0
{
    double val;
    public static bool Equals(double d)
    {
        return new Negative0 { val = -0d }.Equals(new Negative0 { val = d });
    }
}
</code></pre>

<p><code>Negative0.Equals(0); // false</code><br>
<code>Negative0.Equals(-0.0); // true</code></p>",7
4739795,How can I test for negative zero?,<p>Initially I thought <code>Math.Sign</code> would be the proper way to go but after running a test it seems that it treats <code>-0.0</code> and <code>+0.0</code> the same.</p>,c#|.net|floating-point,"<pre><code>x == 0 &amp;&amp; 1 / x &lt; 0
</code></pre>",8
4739795,How can I test for negative zero?,<p>Initially I thought <code>Math.Sign</code> would be the proper way to go but after running a test it seems that it treats <code>-0.0</code> and <code>+0.0</code> the same.</p>,c#|.net|floating-point,"<p>Negative zero has the sign bit set.  Thus:</p>

<pre><code>    public static bool IsNegativeZero(double value) {
        if (value != 0) return false;
        int index = BitConverter.IsLittleEndian ? 7 : 0;
        return BitConverter.GetBytes(value)[index] == 0x80;
    }
</code></pre>

<p>Edit: as the OP pointed out, this doesn't work in Release mode.  The x86 JIT optimizer takes the if() statement seriously and loads zero directly rather than loading <em>value</em>.  Which is indeed more performant.  But that causes the negative zero to be lost.  The code needs to be de-tuned to prevent this:</p>

<pre><code>    public static bool IsNegativeZero(double value) {
        int index = BitConverter.IsLittleEndian ? 7 : 0;
        if (BitConverter.GetBytes(value)[index] != 0x80) return false;
        return value == 0;
    }
</code></pre>

<p>This is quite typical behavior for the x86 jitter btw, it doesn't handle corner cases really well when it optimizes floating point code.  The x64 jitter is much better in that respect.  Although there's arguably no worse corner case than giving meaning to negative zero.  Be forewarned.</p>",8
4739795,How can I test for negative zero?,<p>Initially I thought <code>Math.Sign</code> would be the proper way to go but after running a test it seems that it treats <code>-0.0</code> and <code>+0.0</code> the same.</p>,c#|.net|floating-point,"<p>After a bit of searching I finally made it to <a href=""http://msdn.microsoft.com/en-us/library/aa691373"" rel=""noreferrer"">Section 7.7.2</a> of the C# specification and came up with this solution.</p>

<pre><code>private static bool IsNegativeZero(double x)
{
    return x == 0.0 &amp;&amp; double.IsNegativeInfinity(1.0 / x);
}
</code></pre>",14
4739795,How can I test for negative zero?,<p>Initially I thought <code>Math.Sign</code> would be the proper way to go but after running a test it seems that it treats <code>-0.0</code> and <code>+0.0</code> the same.</p>,c#|.net|floating-point,"<p>Here's a grotty hack way of doing it:</p>

<pre><code>private static readonly long NegativeZeroBits =
    BitConverter.DoubleToInt64Bits(-0.0);

public static bool IsNegativeZero(double x)
{
    return BitConverter.DoubleToInt64Bits(x) == NegativeZeroBits;
}
</code></pre>

<p>Basically that's testing for the exact bit pattern of -0.0, but without having to hardcode it.</p>",46
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>Very clean and MVVM way is to use <code>InteractionTrigger</code> and <code>CallMethodAction</code> defined in <code>Microsoft.Interactivity.Core</code></p>

<p>You will need to add two namespaces as below </p>

<pre><code>xmlns:i=""http://schemas.microsoft.com/expression/2010/interactivity""
xmlns:ei=""http://schemas.microsoft.com/expression/2010/interactions""
</code></pre>

<p>And Assemblies <strong>System.Windows.Interactivity</strong> and <strong>Microsoft.Expression.Interactions</strong> and then Below xaml code will work.</p>

<pre><code>&lt;Button Content=""Save"" Command=""{Binding SaveCommand}""&gt;
  &lt;i:Interaction.Triggers&gt;
    &lt;i:EventTrigger EventName=""Click""&gt;
      &lt;ei:CallMethodAction MethodName=""Close""
                           TargetObject=""{Binding RelativeSource={RelativeSource
                                                  Mode=FindAncestor,
                                                  AncestorType=Window}}"" /&gt;
    &lt;/i:EventTrigger&gt;
  &lt;/i:Interaction.Triggers&gt;
&lt;/Button&gt;
</code></pre>

<p>You don't need any code behind or anything else and can also call any other method of <code>Window</code>.</p>",12
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>I found myself having to do this on a WPF application based on .Net Core 3.0, where unfortunately behaviour support was not yet officially available in the <strong>Microsoft.Xaml.Behaviors.Wpf</strong> NuGet package.</p>

<p>Instead, I went with a solution that made use of the Façade design pattern.</p>

<p>Interface:</p>

<pre><code>public interface IWindowFacade
{
    void Close();
}
</code></pre>

<p>Window:</p>

<pre><code>public partial class MainWindow : Window, IWindowFacade
…
</code></pre>

<p>Standard command property on the view model:</p>

<pre><code>public ICommand ExitCommand
…
</code></pre>

<p>Control binding:</p>

<pre><code>&lt;MenuItem Header=""E_xit"" Command=""{Binding ExitCommand}"" CommandParameter=""{Binding RelativeSource={RelativeSource AncestorType=Window}}""/&gt;
</code></pre>

<p>Command:</p>

<pre><code>public class ExitCommand : ICommand
{
    …
    public void Execute(object parameter)
    {
        var windowFacade = parameter as IWindowFacade;
        windowFacade?.Close();
    }
    …
}
</code></pre>

<p>Because the <code>Close()</code> method is already implemented by the <code>Window</code> class, applying the façade interface to the window is the only required code behind in the UI layer (for this simple example).  The command in the presentation layer avoids any dependencies on the view/UI layer as it has no idea what it is talking to when it calls the <code>Close</code> method on the façade.</p>",1
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>This might helps you, closing a wpf window using mvvm with minimal code behind:  <a href=""http://jkshay.com/closing-a-wpf-window-using-mvvm-and-minimal-code-behind/"" rel=""nofollow"">http://jkshay.com/closing-a-wpf-window-using-mvvm-and-minimal-code-behind/</a></p>",0
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>I have following solution in Silverlight. Would also be in WPF.</p>

<p>ChildWindowExt.cs:</p>

<pre><code>namespace System.Windows.Controls
{
    public class ChildWindowExt : ChildWindow
    {
        public static readonly DependencyProperty IsOpenedProperty =
          DependencyProperty.Register(
          ""IsOpened"",
          typeof(bool),
          typeof(ChildWindowExt),
          new PropertyMetadata(false, IsOpenedChanged));

        private static void IsOpenedChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
        {
            if ((bool)e.NewValue == false)
            {
                ChildWindowExt window = d as ChildWindowExt;
                window.Close();
            }
            else if ((bool)e.NewValue == true)
            {
                ChildWindowExt window = d as ChildWindowExt;
                window.Show();
            }
        }

        public bool IsOpened
        {
            get { return (bool)GetValue(IsOpenedProperty); }
            set { SetValue(IsOpenedProperty, value); }
        }

        protected override void OnClosing(ComponentModel.CancelEventArgs e)
        {
            this.IsOpened = false;
            base.OnClosing(e);
        }

        protected override void OnOpened()
        {
            this.IsOpened = true;
            base.OnOpened();
        }
    }
}
</code></pre>

<p>ItemWindow.xaml:</p>

<pre><code>&lt;extControls:ChildWindowExt  
    x:Class=""MyProject.ItemWindow""
    xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation"" 
    xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml"" 
    xmlns:extControls=""clr-namespace:System.Windows.Controls""
    Title=""{Binding Title}"" IsOpened=""{Binding IsOpened, Mode=TwoWay}"" Width=""640"" Height=""480""&gt;

    &lt;Grid x:Name=""LayoutRoot""&gt;
        &lt;Button Command=""{Binding UpdateCommand}"" Content=""OK"" Width=""70"" HorizontalAlignment=""Center"" VerticalAlignment=""Center""/&gt;
    &lt;/Grid&gt;

&lt;/extControls:ChildWindowExt&gt;
</code></pre>

<p>ItemViewModel.cs:</p>

<pre><code>private bool _IsOpened;
public bool IsOpened
{
    get
    {
        return _IsOpened;
    }
    set
    {
        if (!Equals(_IsOpened, value))
        {
            _IsOpened = value;
            RaisePropertyChanged(""IsOpened"");
        }
    }
}

private RelayCommand _UpdateCommand;
/// &lt;summary&gt;
/// Insert / Update data entity
/// &lt;/summary&gt;
public RelayCommand UpdateCommand
{
    get
    {
        if (_UpdateCommand == null)
        {
            _UpdateCommand = new RelayCommand(
                () =&gt;
                {
                    // Insert / Update data entity
                    ...

                    IsOpened = false;
                },
                () =&gt;
                {
                    return true;
                });
        }
        return _UpdateCommand;
    }
}
</code></pre>

<p>ItemsViewModel.cs:</p>

<pre><code>    private RelayCommand _InsertItemCommand;
    /// &lt;summary&gt;
    /// 
    /// &lt;/summary&gt;
    public RelayCommand InsertItemCommand
    {
        get
        {
            if (_InsertItemCommand == null)
            {
                _InsertItemCommand = new RelayCommand(
                    () =&gt;
                    {
                        ItemWindow itemWin = new ItemWindow();
                        itemWin.DataContext = new ItemViewModel();
                        itemWin.Show();

                        // OR

                        // ItemWindow itemWin = new ItemWindow();
                        // ItemViewModel newItem = new ItemViewModel();
                        // itemWin.DataContext = newItem;
                        // newItem.IsOpened = true;

                    },
                    () =&gt;
                    {
                        return true;
                    });
            }
            return _InsertItemCommand;
        }
    }
</code></pre>

<p>MainPage.xaml:</p>

<pre><code>&lt;Grid x:Name=""LayoutRoot""&gt;
    &lt;Button Command=""{Binding InsertItemCommand}"" Content=""Add New"" Width=""70"" HorizontalAlignment=""Left"" VerticalAlignment=""Center"" /&gt;
&lt;/Grid&gt;
</code></pre>

<p><strong>I wish you all good ideas and projects ;-)</strong></p>",0
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>You could rephrase the question, and by doing so - coming up with another solution. 
How can I enable communication between views, viewmodels and whatnot in an MVVM environment?
You could use the Mediator pattern. It's basically a notification system. For the actual Mediator implementation, google for it or ask me and I can email it.</p>

<p>Make a Command whose purpose is to close the view. </p>



<pre class=""lang-cs prettyprint-override""><code>public void Execute( object parameter )
{
    this.viewModel.DisposeMyStuff();
    Mediator.NotifyColleagues(Mediator.Token.ConfigWindowShouldClose);
}
</code></pre>

<p>The Mediator will raise a notification (a token)</p>

<p>Listen to this notification (token) like this in the View codebehind constructor:</p>

<pre class=""lang-cs prettyprint-override""><code>public ClientConfigView()
{
    InitializeComponent();
    Mediator.ListenOn(Mediator.Token.ConfigWindowShouldClose, callback =&gt; this.Close() );
}
</code></pre>",0
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>I've been searching for a solution to the same problem and found that doing following works fine. The solution is similar to what OP has mentioned in his question with some differences:</p>

<ol>
<li><p>No need of <code>IsCancel</code> property.</p></li>
<li><p>Code behind should not close window. Just set <code>DialogResult</code></p></li>
</ol>

<p>In my case it first executes code behind and then view model command bound to the button.</p>

<p>XAML</p>

<pre><code>&lt;Button x:Name=""buttonOk"" Click=""Save_Click"" Command=""{Binding SaveCommand}""&gt;OK&lt;/Button&gt;
</code></pre>

<p>Code Behind</p>

<pre><code>private void Apply_OnClick(object sender, RoutedEventArgs e)
{
    this.DialogResult = true;
}
</code></pre>

<p>View Model</p>

<pre><code>private void Save()
{
 // Save data.
}
</code></pre>

<p>Hope this helps.</p>",0
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>For small apps, I use my own Application Controller for showing, closing and disposing windows and DataContexts. It's a central point in UI of an application. </p>

<p>It's something like this:</p>

<pre><code>//It is singleton, I will just post 2 methods and their invocations
public void ShowNewWindow(Window window, object dataContext = null, bool dialog = true)
{
    window.DataContext = dataContext;
    addToWindowRegistry(dataContext, window);

    if (dialog)
        window.ShowDialog();
    else
        window.Show();

}

public void CloseWindow(object dataContextSender)
{
    var correspondingWindows = windowRegistry.Where(c =&gt; c.DataContext.Equals(dataContextSender)).ToList();
    foreach (var pair in correspondingWindows)
    {
        pair.Window.Close();              
    }
}
</code></pre>

<p>and their invocations from <strong>ViewModels</strong>:</p>

<pre><code>// Show new Window with DataContext
ApplicationController.Instance.ShowNewWindow(
                new ClientCardsWindow(),
                new ClientCardsVM(),
                false);

// Close Current Window from viewModel
ApplicationController.Instance.CloseWindow(this);
</code></pre>

<p>Of course you can find some restrictions in my solution. Again: I use it for small projects, and it's enough. If you're interested, I can post full code here or somewhere else/</p>",7
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>We have the name property in the .xaml definition:</p>

<pre><code>x:Name=""WindowsForm""
</code></pre>

<p>Then we have the button: </p>

<pre><code>&lt;Button Command=""{Binding CloseCommand}"" 
CommandParameter=""{Binding ElementName=WindowsForm}"" /&gt;
</code></pre>

<p>Then in the ViewModel:</p>

<pre><code>public DelegateCommand &lt;Object&gt;  CloseCommand { get; private set; }

Constructor for that view model:
this.CloseCommand = new DelegateCommand&lt;object&gt;(this.CloseAction);
</code></pre>

<p>Then at last, the action method:</p>

<pre><code>private void CloseAction (object obj)
{
  Window Win = obj as Window;
  Win.Close();

}
</code></pre>

<p>I used this code to close a pop-up window from an application..</p>",2
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>The solution to close a window in wpf that that worked for me is not answered here so i thought i would add my solution too.</p>

<pre><code>        private static Window GetWindow(DependencyObject sender)
        {
            Window window = null;
            if (sender is Window)
                window = (Window)sender;
            if (window == null)
                window = Window.GetWindow(sender);
            return window;
        }
        private void CloseWindow(object sender, RoutedEventArgs e)
        {
            var button = (Button)sender as DependencyObject;

            Window window = GetWindow(button);
                if (window != null)
                    window.Close();
                   // window.Visibility = Visibility.Hidden; 
           // choose between window.close or set window.visibility to close or hide the window.

            //            }
        }

</code></pre>

<p>Add CloseWindow event to the button in you window as following.</p>

<pre><code>&lt;Button Content=""Cancel"" Click=""CloseWindow"" &gt;
</code></pre>",0
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>I think the most simple way has not been included already (almost). Instead of using Behaviours which adds new dependencies just use attached properties:</p>

<pre><code>    using System;
    using System.Windows;
    using System.Windows.Controls;

    public class DialogButtonManager
    {
        public static readonly DependencyProperty IsAcceptButtonProperty = DependencyProperty.RegisterAttached(""IsAcceptButton"", typeof(bool), typeof(DialogButtonManager), new FrameworkPropertyMetadata(OnIsAcceptButtonPropertyChanged));
        public static readonly DependencyProperty IsCancelButtonProperty = DependencyProperty.RegisterAttached(""IsCancelButton"", typeof(bool), typeof(DialogButtonManager), new FrameworkPropertyMetadata(OnIsCancelButtonPropertyChanged));

        public static void SetIsAcceptButton(UIElement element, bool value)
        {
            element.SetValue(IsAcceptButtonProperty, value);
        }

        public static bool GetIsAcceptButton(UIElement element)
        {
            return (bool)element.GetValue(IsAcceptButtonProperty);
        }

        public static void SetIsCancelButton(UIElement element, bool value)
        {
            element.SetValue(IsCancelButtonProperty, value);
        }

        public static bool GetIsCancelButton(UIElement element)
        {
            return (bool)element.GetValue(IsCancelButtonProperty);
        }

        private static void OnIsAcceptButtonPropertyChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
        {
            Button button = sender as Button;

            if (button != null)
            {
                if ((bool)e.NewValue)
                {
                    SetAcceptButton(button);
                }
                else
                {
                    ResetAcceptButton(button);
                }
            }
        }

        private static void OnIsCancelButtonPropertyChanged(DependencyObject sender, DependencyPropertyChangedEventArgs e)
        {
            Button button = sender as Button;

            if (button != null)
            {
                if ((bool)e.NewValue)
                {
                    SetCancelButton(button);
                }
                else
                {
                    ResetCancelButton(button);
                }
            }
        }

        private static void SetAcceptButton(Button button)
        {
            Window window = Window.GetWindow(button);
            button.Command = new RelayCommand(new Action&lt;object&gt;(ExecuteAccept));
            button.CommandParameter = window;
        }

        private static void ResetAcceptButton(Button button)
        {
            button.Command = null;
            button.CommandParameter = null;
        }

        private static void ExecuteAccept(object buttonWindow)
        {
            Window window = (Window)buttonWindow;

            window.DialogResult = true;
        }

        private static void SetCancelButton(Button button)
        {
            Window window = Window.GetWindow(button);
            button.Command = new RelayCommand(new Action&lt;object&gt;(ExecuteCancel));
            button.CommandParameter = window;
        }

        private static void ResetCancelButton(Button button)
        {
            button.Command = null;
            button.CommandParameter = null;
        }

        private static void ExecuteCancel(object buttonWindow)
        {
            Window window = (Window)buttonWindow;

            window.DialogResult = false;
        }
    }
</code></pre>

<p>Then just set it on your dialog buttons:</p>

<pre><code>&lt;UniformGrid Grid.Row=""2"" Grid.Column=""1"" Rows=""1"" Columns=""2"" Margin=""3"" &gt;
    &lt;Button Content=""Accept"" IsDefault=""True"" Padding=""3"" Margin=""3,0,3,0"" DialogButtonManager.IsAcceptButton=""True"" /&gt;
    &lt;Button Content=""Cancel"" IsCancel=""True"" Padding=""3"" Margin=""3,0,3,0"" DialogButtonManager.IsCancelButton=""True"" /&gt;
&lt;/UniformGrid&gt;
</code></pre>",0
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>I'd personally use a behaviour to do this sort of thing:</p>

<pre><code>public class WindowCloseBehaviour : Behavior&lt;Window&gt;
{
    public static readonly DependencyProperty CommandProperty =
      DependencyProperty.Register(
        ""Command"",
        typeof(ICommand),
        typeof(WindowCloseBehaviour));

    public static readonly DependencyProperty CommandParameterProperty =
      DependencyProperty.Register(
        ""CommandParameter"",
        typeof(object),
        typeof(WindowCloseBehaviour));

    public static readonly DependencyProperty CloseButtonProperty =
      DependencyProperty.Register(
        ""CloseButton"",
        typeof(Button),
        typeof(WindowCloseBehaviour),
        new FrameworkPropertyMetadata(null, OnButtonChanged));

    public ICommand Command
    {
        get { return (ICommand)GetValue(CommandProperty); }
        set { SetValue(CommandProperty, value); }
    }

    public object CommandParameter
    {
        get { return GetValue(CommandParameterProperty); }
        set { SetValue(CommandParameterProperty, value); }
    }

    public Button CloseButton
    {
        get { return (Button)GetValue(CloseButtonProperty); }
        set { SetValue(CloseButtonProperty, value); }
    }

    private static void OnButtonChanged(DependencyObject d, DependencyPropertyChangedEventArgs e)
    {
        var window = (Window)((WindowCloseBehaviour)d).AssociatedObject;
        ((Button) e.NewValue).Click +=
            (s, e1) =&gt;
            {
                var command = ((WindowCloseBehaviour)d).Command;
                var commandParameter = ((WindowCloseBehaviour)d).CommandParameter;
                if (command != null)
                {
                    command.Execute(commandParameter);                                                      
                }
                window.Close();
            };
        }
    }
</code></pre>

<p>You can then attach this to your <code>Window</code> and <code>Button</code> to do the work:</p>

<pre><code>&lt;Window x:Class=""WpfApplication6.Window1""
        xmlns=""http://schemas.microsoft.com/winfx/2006/xaml/presentation""
        xmlns:x=""http://schemas.microsoft.com/winfx/2006/xaml""
        xmlns:i=""http://schemas.microsoft.com/expression/2010/interactivity""
        xmlns:local=""clr-namespace:WpfApplication6""
        Title=""Window1"" Height=""300"" Width=""300""&gt;
    &lt;i:Interaction.Behaviors&gt;
        &lt;local:WindowCloseBehaviour CloseButton=""{Binding ElementName=closeButton}""/&gt;
    &lt;/i:Interaction.Behaviors&gt;
    &lt;Grid&gt;
        &lt;Button Name=""closeButton""&gt;Close&lt;/Button&gt;
    &lt;/Grid&gt;
&lt;/Window&gt;
</code></pre>

<p>I've added <code>Command</code> and <code>CommandParameter</code> here so you can run a command before the <code>Window</code> closes.</p>",12
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>There is a useful behavior for this task which doesn't break MVVM, a Behavior, introduced with Expression Blend 3, to allow the View to hook into commands defined completely within the ViewModel.  </p>

<blockquote>
  <p>This behavior demonstrates a simple technique for allowing the
  ViewModel to manage the closing events of the View in a
  Model-View-ViewModel application.  </p>
  
  <p>This allows you to hook up a behavior in your View (UserControl) which
  will provide control over the control's Window, allowing the ViewModel
  to control whether the window can be closed via standard ICommands.</p>
  
  <p><a href=""http://reedcopsey.com/2009/10/09/using-behaviors-to-allow-the-viewmodel-to-manage-view-lifetime-in-m-v-vm/"" rel=""nofollow"">Using Behaviors to Allow the ViewModel to Manage View Lifetime in M-V-VM</a></p>
  
  <p><a href=""http://gallery.expression.microsoft.com/WindowCloseBehavior/"" rel=""nofollow"">http://gallery.expression.microsoft.com/WindowCloseBehavior/</a></p>
</blockquote>

<p>Above link has been archived to <a href=""http://code.msdn.microsoft.com/Window-Close-Attached-fef26a66#content"" rel=""nofollow"">http://code.msdn.microsoft.com/Window-Close-Attached-fef26a66#content</a></p>",3
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>I just completed a <a href=""http://jkshay.com/closing-a-wpf-window-using-mvvm-and-minimal-code-behind/"">blog post</a> on this very topic.  In a nutshell, add an <code>Action</code> property to your ViewModel with <code>get</code> and <code>set</code> accessors.  Then define the <code>Action</code> from your <code>View</code> constructor.  Finally, invoke your action in the bound command that should close the window.</p>

<p>In the ViewModel:</p>

<pre><code>public Action CloseAction  { get; set;}
</code></pre>

<p>and in the <code>View</code> constructor:</p>

<pre><code>private View()
{
    InitializeComponent();
    ViewModel vm = new ViewModel();
    this.DataContext = vm;
    if ( vm.CloseAction == null )
        vm.CloseAction = new Action(this.Close);
}
</code></pre>

<p>Finally, in whatever bound command that should close the window, we can simply invoke</p>

<pre><code>CloseAction(); // Calls Close() method of the View
</code></pre>

<p>This worked for me, seemed like a fairly elegant solution, and saved me a bunch of coding.</p>",54
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>I also had to deal with this problem, so here my solution. It works great for me.</p>

<p><b>1. Create class DelegateCommand</b></p>

<pre><code>    public class DelegateCommand&lt;T&gt; : ICommand
{
    private Predicate&lt;T&gt; _canExecuteMethod;
    private readonly Action&lt;T&gt; _executeMethod;
    public event EventHandler CanExecuteChanged;

    public DelegateCommand(Action&lt;T&gt; executeMethod) : this(executeMethod, null)
    {
    }
    public DelegateCommand(Action&lt;T&gt; executeMethod, Predicate&lt;T&gt; canExecuteMethod)
    {
        this._canExecuteMethod = canExecuteMethod;
        this._executeMethod = executeMethod ?? throw new ArgumentNullException(nameof(executeMethod), ""Command is not specified.""); 
    }


    public void RaiseCanExecuteChanged()
    {
        if (this.CanExecuteChanged != null)
            CanExecuteChanged(this, null);
    }
    public bool CanExecute(object parameter)
    {
        return _canExecuteMethod == null || _canExecuteMethod((T)parameter) == true;
    }

    public void Execute(object parameter)
    {
        _executeMethod((T)parameter);
    }
}
</code></pre>

<p><b>2. Define your command</b></p>

<pre><code>        public DelegateCommand&lt;Window&gt; CloseWindowCommand { get; private set; }


    public MyViewModel()//ctor of your viewmodel
    {
        //do something

        CloseWindowCommand = new DelegateCommand&lt;Window&gt;(CloseWindow);


    }
        public void CloseWindow(Window win) // this method is also in your viewmodel
    {
        //do something
        win?.Close();
    }
</code></pre>

<p><b>3. Bind your command in the view</b></p>

<pre><code>public MyView(Window win) //ctor of your view, window as parameter
    {
        InitializeComponent();
        MyButton.CommandParameter = win;
        MyButton.Command = ((MyViewModel)this.DataContext).CloseWindowCommand;
    }
</code></pre>

<p><b>4. And now the window </b></p>

<pre><code>  Window win = new Window()
        {
            Title = ""My Window"",
            Height = 800,
            Width = 800,
            WindowStartupLocation = WindowStartupLocation.CenterScreen,

        };
        win.Content = new MyView(win);
        win.ShowDialog();
</code></pre>

<p>so thats it, you can also bind the command in the xaml file and find the window with FindAncestor and bind it to the command parameter.</p>",0
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>I've tried to resolve this issue in some generic, MVVM way, but I always find that I end up unnecessary complex logic. To achieve close behavior I have made an exception from the rule of no code behind and resorted to simply using good ol' events in code behind:</p>

<p>XAML:</p>

<pre><code>&lt;Button Content=""Close"" Click=""OnCloseClicked"" /&gt;
</code></pre>

<p>Code behind:</p>

<pre><code>private void OnCloseClicked(object sender, EventArgs e)
{
    Visibility = Visibility.Collapsed;
}
</code></pre>

<p>Although I wish this would be better supported using commands/MVVM, I simply think that there is no simpler and more clear solution than using events.</p>",5
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>You can do it without code behind. Create command, in Execute method call ""Save"" method on viewmodel and after that call close method on edit window, which you can pass to the command by parameter:</p>

<pre><code>public void Execute(object parameter)
{
    _mainViewModel.SaveSomething();
    var editWindow = parameter as MyEditWindow;
    editWindow?.Close();
}
</code></pre>

<p>Save&amp;Close button XAML:</p>

<pre><code>&lt;Button Content""Save&amp;Close"" Command=""{Binding SaveCmd}"" CommandParameter=""{Binding RelativeSource={RelativeSource FindAncestor, AncestorType=Window}}""  IsDefault=""True"" /&gt;
</code></pre>",-1
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>I struggled with this topic for some time, and eventually went with the simplest approach that is still consistent with MVVM: Have the button execute the Command that does all the heavy lifting and have the button's Click handler close the window.</p>

<p><strong>XAML</strong></p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" /&gt;
</code></pre>

<p><strong>XAML.cs</strong></p>

<pre><code>public void closeWindow() 
{
    this.DialogResult = true;
}
</code></pre>

<p><strong>SaveCommand.cs</strong></p>

<pre><code> // I'm in my own file, not the code-behind!
</code></pre>

<p>True, there is still code-behind, but there isn't anything inherently bad about that. And it makes the most sense to me, from an OO perspective, to just tell the window to close itself.</p>",3
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>As someone commented, the code I have posted is not MVVM friendly, how about the second solution?</p>

<p>1st, not MVVM solution (I will not delete this as a reference) </p>

<p>XAML:</p>

<pre><code>&lt;Button Name=""okButton"" Command=""{Binding OkCommand}"" CommandParameter=""{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type Window}}}""&gt;OK&lt;/Button&gt;
</code></pre>

<p>ViewModel:</p>

<pre><code>public ICommand OkCommand
{
    get
    {
        if (_okCommand == null)
        {
            _okCommand = new ActionCommand&lt;Window&gt;(DoOk, CanDoOk);
        }
        return _okCommand ;
    }
}

void DoOk(Window win)
{
    // Your Code
    win.DialogResult = true;
    win.Close();
}

bool CanDoOk(Window win) { return true; }
</code></pre>

<p><strong>2nd, probably better solution:</strong>
Using attached behaviours</p>

<p>XAML</p>

<pre><code>&lt;Button Content=""Ok and Close"" Command=""{Binding OkCommand}"" b:CloseOnClickBehaviour.IsEnabled=""True"" /&gt;
</code></pre>

<p>View Model</p>

<pre><code>public ICommand OkCommand
{
    get { return _okCommand; }
}
</code></pre>

<p>Behaviour Class
Something similar to this:</p>

<pre><code>public static class CloseOnClickBehaviour
{
    public static readonly DependencyProperty IsEnabledProperty =
        DependencyProperty.RegisterAttached(
            ""IsEnabled"",
            typeof(bool),
            typeof(CloseOnClickBehaviour),
            new PropertyMetadata(false, OnIsEnabledPropertyChanged)
        );

    public static bool GetIsEnabled(DependencyObject obj)
    {
        var val = obj.GetValue(IsEnabledProperty);
        return (bool)val;
    }

    public static void SetIsEnabled(DependencyObject obj, bool value)
    {
        obj.SetValue(IsEnabledProperty, value);
    }

    static void OnIsEnabledPropertyChanged(DependencyObject dpo, DependencyPropertyChangedEventArgs args)
    {
        var button = dpo as Button;
        if (button == null)
            return;

        var oldValue = (bool)args.OldValue;
        var newValue = (bool)args.NewValue;

        if (!oldValue &amp;&amp; newValue)
        {
            button.Click += OnClick;
        }
        else if (oldValue &amp;&amp; !newValue)
        {
            button.PreviewMouseLeftButtonDown -= OnClick;
        }
    }

    static void OnClick(object sender, RoutedEventArgs e)
    {
        var button = sender as Button;
        if (button == null)
            return;

        var win = Window.GetWindow(button);
        if (win == null)
            return;

        win.Close();
    }

}
</code></pre>",15
4376475,WPF MVVM: How to close a window,"<p>I have a <code>Button</code> that closes my window when it's clicked:</p>

<pre><code>&lt;Button x:Name=""buttonOk""  IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>That's fine until I add a <code>Command</code> to the <code>Button</code> i.e.</p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>Now it doesn't close presumably because I am handling the <code>Command</code>. I can fix this by putting an <code>EventHandler</code> in and calling <code>this.Close()</code> i.e. </p>

<pre><code>&lt;Button x:Name=""buttonOk"" 
        Click=""closeWindow"" 
        Command=""{Binding SaveCommand}"" 
        IsCancel=""True""&gt;Ok&lt;/Button&gt;
</code></pre>

<p>but now I have code in my code behind i.e. the method <code>SaveCommand</code>. I am using the MVVM pattern and <code>SaveCommand</code> is the only code in my code behind. </p>

<p>How can I do this differently so as not to use code behind?</p>",c#|.net|wpf|xaml|mvvm,"<p>I use the <strong><em>Publish Subscribe pattern</em></strong> for complicated class-dependencies:</p>

<p><strong>ViewModel:</strong></p>

<pre><code>    public class ViewModel : ViewModelBase
    {
        public ViewModel()
        {
            CloseComand = new DelegateCommand((obj) =&gt;
                {
                    MessageBus.Instance.Publish(Messages.REQUEST_DEPLOYMENT_SETTINGS_CLOSED, null);
                });
        }
}
</code></pre>

<p><strong>Window:</strong></p>

<pre><code>public partial class SomeWindow : Window
{
    Subscription _subscription = new Subscription();

    public SomeWindow()
    {
        InitializeComponent();

        _subscription.Subscribe(Messages.REQUEST_DEPLOYMENT_SETTINGS_CLOSED, obj =&gt;
            {
                this.Close();
            });
    }
}
</code></pre>

<p>You can leverage <a href=""https://www.nuget.org/packages/Bizmonger.Patterns/1.0.0"" rel=""nofollow"">Bizmonger.Patterns</a> to get the MessageBus.</p>

<p><strong>MessageBus</strong></p>

<pre><code>public class MessageBus
{
    #region Singleton
    static MessageBus _messageBus = null;
    private MessageBus() { }

    public static MessageBus Instance
    {
        get
        {
            if (_messageBus == null)
            {
                _messageBus = new MessageBus();
            }

            return _messageBus;
        }
    }
    #endregion

    #region Members
    List&lt;Observer&gt; _observers = new List&lt;Observer&gt;();
    List&lt;Observer&gt; _oneTimeObservers = new List&lt;Observer&gt;();
    List&lt;Observer&gt; _waitingSubscribers = new List&lt;Observer&gt;();
    List&lt;Observer&gt; _waitingUnsubscribers = new List&lt;Observer&gt;();

    int _publishingCount = 0;
    #endregion

    public void Subscribe(string message, Action&lt;object&gt; response)
    {
        Subscribe(message, response, _observers);
    }

    public void SubscribeFirstPublication(string message, Action&lt;object&gt; response)
    {
        Subscribe(message, response, _oneTimeObservers);
    }

    public int Unsubscribe(string message, Action&lt;object&gt; response)
    {
        var observers = new List&lt;Observer&gt;(_observers.Where(o =&gt; o.Respond == response).ToList());
        observers.AddRange(_waitingSubscribers.Where(o =&gt; o.Respond == response));
        observers.AddRange(_oneTimeObservers.Where(o =&gt; o.Respond == response));

        if (_publishingCount == 0)
        {
            observers.ForEach(o =&gt; _observers.Remove(o));
        }

        else
        {
            _waitingUnsubscribers.AddRange(observers);
        }

        return observers.Count;
    }

    public int Unsubscribe(string subscription)
    {
        var observers = new List&lt;Observer&gt;(_observers.Where(o =&gt; o.Subscription == subscription).ToList());
        observers.AddRange(_waitingSubscribers.Where(o =&gt; o.Subscription == subscription));
        observers.AddRange(_oneTimeObservers.Where(o =&gt; o.Subscription == subscription));

        if (_publishingCount == 0)
        {
            observers.ForEach(o =&gt; _observers.Remove(o));
        }

        else
        {
            _waitingUnsubscribers.AddRange(observers);
        }

        return observers.Count;
    }

    public void Publish(string message, object payload)
    {
        _publishingCount++;

        Publish(_observers, message, payload);
        Publish(_oneTimeObservers, message, payload);
        Publish(_waitingSubscribers, message, payload);

        _oneTimeObservers.RemoveAll(o =&gt; o.Subscription == message);
        _waitingUnsubscribers.Clear();

        _publishingCount--;
    }

    private void Publish(List&lt;Observer&gt; observers, string message, object payload)
    {
        Debug.Assert(_publishingCount &gt;= 0);

        var subscribers = observers.Where(o =&gt; o.Subscription.ToLower() == message.ToLower());

        foreach (var subscriber in subscribers)
        {
            subscriber.Respond(payload);
        }
    }

    public IEnumerable&lt;Observer&gt; GetObservers(string subscription)
    {
        var observers = new List&lt;Observer&gt;(_observers.Where(o =&gt; o.Subscription == subscription));
        return observers;
    }

    public void Clear()
    {
        _observers.Clear();
        _oneTimeObservers.Clear();
    }

    #region Helpers
    private void Subscribe(string message, Action&lt;object&gt; response, List&lt;Observer&gt; observers)
    {
        Debug.Assert(_publishingCount &gt;= 0);

        var observer = new Observer() { Subscription = message, Respond = response };

        if (_publishingCount == 0)
        {
            observers.Add(observer);
        }
        else
        {
            _waitingSubscribers.Add(observer);
        }
    }
    #endregion
}
</code></pre>

<p>}</p>

<p><strong>Subscription</strong></p>

<pre><code>public class Subscription
{
    #region Members
    List&lt;Observer&gt; _observerList = new List&lt;Observer&gt;();
    #endregion

    public void Unsubscribe(string subscription)
    {
        var observers = _observerList.Where(o =&gt; o.Subscription == subscription);

        foreach (var observer in observers)
        {
            MessageBus.Instance.Unsubscribe(observer.Subscription, observer.Respond);
        }

        _observerList.Where(o =&gt; o.Subscription == subscription).ToList().ForEach(o =&gt; _observerList.Remove(o));
    }

    public void Subscribe(string subscription, Action&lt;object&gt; response)
    {
        MessageBus.Instance.Subscribe(subscription, response);
        _observerList.Add(new Observer() { Subscription = subscription, Respond = response });
    }

    public void SubscribeFirstPublication(string subscription, Action&lt;object&gt; response)
    {
        MessageBus.Instance.SubscribeFirstPublication(subscription, response);
    }
}
</code></pre>",5
27972388,C# how swap object to object of inherite class with only their reference - It is posible?,"<p><strong>EDIT: In considerations i didn't have access to list</strong></p>

<p><strong>EDIT: I changed example to more advanced</strong></p>

<p><strong>EDIT: Fixed example ;P</strong></p>

<p><strong>EDIT: Again edited</strong>
I'm sure that i got vote down cause you guys didn't understand orgin of my considerations. I know it is posible with pointers in C++ but not sure it is still posible in C#. And i didnt ask cuase i don't know how to change element in List! I just want to make it without access to that LIST! This is only example cuase real live example is to complicated to introduce here...</p>

<p>I Wonder if it's posible to do something like this
        class Foo
        {
            public int foo = 100;
            EventHandler something;</p>

<pre><code>        public Foo()
        {
            something += smth;
        }

        public void doSmth()
        {
            something(this, EventArgs.Empty);
        }

        public static void smth(object sender, EventArgs e)
        {
            sender = new Foo();
        }
    }

    class Boo : Foo
    {
        EventHandler&lt;EventArgs&gt; something;

        public Boo()
        {
            foo = 1;
            something += smth;
        }           

    }
    static void Main(string[] args)
    {
        List&lt;Foo&gt; list = new List&lt;Foo&gt;();

        Foo foo = new Boo();
        list.Add(foo);

        foreach (Foo f in list)
            f.doSmth();

        foreach (Foo f in list)
            Console.WriteLine(f.foo);

        Console.ReadKey();
    }
</code></pre>

<p>My output is 1 but i want to get 100. It is posible to change object from list by its reference ?</p>",c#|pointers|reference,"<p>No it is not possible. When you assign a new reference <code>boo</code> is no longer referencing the old location, but <code>list[0]</code> still holds a reference there and changing <code>boo</code>'s reference doesn't affect it. Because there is no connection between them, you can think them as two different variables that holds a reference to the same location. Like this:</p>

<pre><code>string foo = ""foo"";
string bar = foo;
bar = ""bar"";
</code></pre>

<p>Changing the reference of <code>bar</code> does not affect <code>foo</code>. That's the behaviour or reference types. Changing a variables reference would be only possible when you use <code>ref</code> modifier in function parameters.Have a look at this question for more info about that: <a href=""https://stackoverflow.com/questions/961717/what-is-the-use-of-ref-for-reference-type-variables-in-c"">What is the use of “ref” for reference-type variables in C#?</a></p>",1
27972388,C# how swap object to object of inherite class with only their reference - It is posible?,"<p><strong>EDIT: In considerations i didn't have access to list</strong></p>

<p><strong>EDIT: I changed example to more advanced</strong></p>

<p><strong>EDIT: Fixed example ;P</strong></p>

<p><strong>EDIT: Again edited</strong>
I'm sure that i got vote down cause you guys didn't understand orgin of my considerations. I know it is posible with pointers in C++ but not sure it is still posible in C#. And i didnt ask cuase i don't know how to change element in List! I just want to make it without access to that LIST! This is only example cuase real live example is to complicated to introduce here...</p>

<p>I Wonder if it's posible to do something like this
        class Foo
        {
            public int foo = 100;
            EventHandler something;</p>

<pre><code>        public Foo()
        {
            something += smth;
        }

        public void doSmth()
        {
            something(this, EventArgs.Empty);
        }

        public static void smth(object sender, EventArgs e)
        {
            sender = new Foo();
        }
    }

    class Boo : Foo
    {
        EventHandler&lt;EventArgs&gt; something;

        public Boo()
        {
            foo = 1;
            something += smth;
        }           

    }
    static void Main(string[] args)
    {
        List&lt;Foo&gt; list = new List&lt;Foo&gt;();

        Foo foo = new Boo();
        list.Add(foo);

        foreach (Foo f in list)
            f.doSmth();

        foreach (Foo f in list)
            Console.WriteLine(f.foo);

        Console.ReadKey();
    }
</code></pre>

<p>My output is 1 but i want to get 100. It is posible to change object from list by its reference ?</p>",c#|pointers|reference,"<p>This has nothing to do with inheritance.  You simply never modified the list.  Look at this code:</p>

<pre><code>Foo boo = list[0];
boo = new Boo();
</code></pre>

<p>After the first line, <code>boo</code> refers to the same in-memory object as the first element in <code>list</code>.  But after the <em>second</em> line, it refers to a <em>new</em> in-memory object.  <em>Not</em> the first element in the list.  Stop there in a debugger and examine both the object and the list, they're different.</p>

<p>Afterward you then go on to print the elements from the list.  You never print the value of <code>boo</code>, and never modify the list.  To update the element in the list, you need to set it:</p>

<pre><code>list[0] = boo;
</code></pre>

<p><strong>Edit:</strong> Your updated example doesn't even compile.  This code won't work:</p>

<pre><code>foreach (Foo f in list)
    f.doSmth();
</code></pre>

<p>Because there is no method called <code>doSmth()</code> on <code>Foo</code>.  Are you trying to check if any given element in the collection is an instance of <code>Boo</code> and invoke the method if it is?  In that case you can check the type:</p>

<pre><code>foreach (Foo f in list)
    if (f is Boo)
        (f as Boo).doSmth();
</code></pre>

<p>Though in <em>most</em> cases I'd argue that isn't really good design.  There are cases which call for it, sure.  But it's more likely that your <code>Foo</code> and <code>Boo</code> modeling are breaking an abstraction somewhere.  If the collection is of type <code>Foo</code> then any operation on that collection <em>should</em> only user operations on type <code>Foo</code>.</p>",0
27972388,C# how swap object to object of inherite class with only their reference - It is posible?,"<p><strong>EDIT: In considerations i didn't have access to list</strong></p>

<p><strong>EDIT: I changed example to more advanced</strong></p>

<p><strong>EDIT: Fixed example ;P</strong></p>

<p><strong>EDIT: Again edited</strong>
I'm sure that i got vote down cause you guys didn't understand orgin of my considerations. I know it is posible with pointers in C++ but not sure it is still posible in C#. And i didnt ask cuase i don't know how to change element in List! I just want to make it without access to that LIST! This is only example cuase real live example is to complicated to introduce here...</p>

<p>I Wonder if it's posible to do something like this
        class Foo
        {
            public int foo = 100;
            EventHandler something;</p>

<pre><code>        public Foo()
        {
            something += smth;
        }

        public void doSmth()
        {
            something(this, EventArgs.Empty);
        }

        public static void smth(object sender, EventArgs e)
        {
            sender = new Foo();
        }
    }

    class Boo : Foo
    {
        EventHandler&lt;EventArgs&gt; something;

        public Boo()
        {
            foo = 1;
            something += smth;
        }           

    }
    static void Main(string[] args)
    {
        List&lt;Foo&gt; list = new List&lt;Foo&gt;();

        Foo foo = new Boo();
        list.Add(foo);

        foreach (Foo f in list)
            f.doSmth();

        foreach (Foo f in list)
            Console.WriteLine(f.foo);

        Console.ReadKey();
    }
</code></pre>

<p>My output is 1 but i want to get 100. It is posible to change object from list by its reference ?</p>",c#|pointers|reference,"<p>Yes, but you didn't get the reference you thought:</p>

<pre><code>Foo boo = list[0];
boo = new Boo;      
</code></pre>

<p>This makes a <em>new</em> reference (called boo) and assigns the reference in <code>list[0]</code> to it. You then assign a <code>Boo</code> object to that <em>new, local</em> reference. When you iterate over the <code>List</code>, the reference stored <em>there</em> hasn't been changed at all, so you see the behavior.</p>

<p>Instead, just write:</p>

<pre><code>list[0] = new Boo();
</code></pre>

<p><strong>Note</strong> I actually wasn't sure that would work, so I tested it, and it does! Because the code is kind of odd, I would reccommend finding a different way to mutate it (like removing the old object and adding a new one) in order to improve readability/maintainability.</p>

<pre><code>        List&lt;FancyText&gt; test = new List&lt;FancyText&gt;();
        test.Add(new FancyText { Text = ""test"" });
        test[0] = new FancyText() { Text = ""final"" };
</code></pre>

<p>The collection holds the object with ""final"" in it.</p>

<p><strong>Update</strong> To your edit, you can <em>almost</em> do that:</p>

<pre><code>private delegate void refHandler (ref Award sender);
private event refHandler test;
</code></pre>

<p>However, you can't pass <code>this</code> as a <code>ref</code> parameter, as it is read-only (makes sense, right? you can't assign yourself to something else, that would be weird).</p>",2
27972388,C# how swap object to object of inherite class with only their reference - It is posible?,"<p><strong>EDIT: In considerations i didn't have access to list</strong></p>

<p><strong>EDIT: I changed example to more advanced</strong></p>

<p><strong>EDIT: Fixed example ;P</strong></p>

<p><strong>EDIT: Again edited</strong>
I'm sure that i got vote down cause you guys didn't understand orgin of my considerations. I know it is posible with pointers in C++ but not sure it is still posible in C#. And i didnt ask cuase i don't know how to change element in List! I just want to make it without access to that LIST! This is only example cuase real live example is to complicated to introduce here...</p>

<p>I Wonder if it's posible to do something like this
        class Foo
        {
            public int foo = 100;
            EventHandler something;</p>

<pre><code>        public Foo()
        {
            something += smth;
        }

        public void doSmth()
        {
            something(this, EventArgs.Empty);
        }

        public static void smth(object sender, EventArgs e)
        {
            sender = new Foo();
        }
    }

    class Boo : Foo
    {
        EventHandler&lt;EventArgs&gt; something;

        public Boo()
        {
            foo = 1;
            something += smth;
        }           

    }
    static void Main(string[] args)
    {
        List&lt;Foo&gt; list = new List&lt;Foo&gt;();

        Foo foo = new Boo();
        list.Add(foo);

        foreach (Foo f in list)
            f.doSmth();

        foreach (Foo f in list)
            Console.WriteLine(f.foo);

        Console.ReadKey();
    }
</code></pre>

<p>My output is 1 but i want to get 100. It is posible to change object from list by its reference ?</p>",c#|pointers|reference,"<p>The following will create a variable <code>boo</code> with a reference to the <code>Foo</code> object in the first spot in <code>list</code>, i.e., the first <code>new Foo()</code> you did.</p>

<pre><code>Foo boo = list[0];
</code></pre>

<p>When you do the following you overwrite the variable <code>boo</code>'s reference to the <code>Foo</code> object with a reference to your newly constructed <code>Boo</code> object.</p>

<pre><code>boo = new Boo;
</code></pre>

<p>To do what your manual test specifically is asking for, you could do the following</p>

<pre><code>Foo boo = list[0] == new Boo();
</code></pre>

<p>This will update both the variable <code>boo</code> and the first spot in <code>list</code> with a new reference to your newly created Boo object. This will output:</p>

<pre><code>1
100
</code></pre>

<p>Now, when this is said. It is technically possible to use references directly using the <code>unsafe</code> and <code>fixed</code> keywords. This will add several restrictions. Here is my best attempt at replicating your code using unsafe code:</p>

<pre><code>//Requres project properties be set to Allow Unsafe Code
struct Foo
{
    public int Bar { get; set; }
}

static unsafe void Main(string[] args)
{
    Foo[] list = new Foo[2];
    list[0] = new Foo { Bar = 100 };
    Foo foo = new Foo { Bar = 100 };
    list[1] = foo;

    fixed (Foo* boo = list)
        *boo = new Foo { Bar = 1 };

    foreach (Foo f in list)
        Console.WriteLine(f.Bar); //Prints 1 then 100

    Console.ReadKey();
}
</code></pre>

<p>This will also output:</p>

<pre><code>1
100
</code></pre>

<p>However, it isn't really a general example. What happens if you want to point to an index other than 0 of the list. You'd have to swap out the <code>fixed</code> part with something like the following:</p>

<pre><code>fixed (Foo* plist = list)
{
    const int offset = 1;
    Foo* boo = plist + offset;
    *boo = new Foo { Bar = 1 };
}
</code></pre>

<p>This would output:</p>

<pre><code>100
1
</code></pre>

<p>What you lose is referencing class objects, only structs, this means no inheritance, and having to use the fixed keyword, and probably much more.</p>",0
28168382,LINQ Filter rows based on LEFT JOIN,"<p>I want a LINQ query to have two behaviours, dependant on a parameter.</p>

<p>If param = -1, return all rows</p>

<p>If param > -1, return select rows</p>

<p>This is what I have tried. It emulates how I'd write it in SQL server (a left join with a where clause to force it to an inner join if param > -1), but it does not behave the same. It always returns filtered rows, behaving as if the RTA join is an inner join.</p>

<pre><code>                // Get attributes filtered to the template (-1 = all)
            var result2 = from RA in ent.ReportAttributes 
                          join FT in ent.FilterTypes on RA.FilterTypeID equals FT.FilterTypeID
                          join DS in ent.DataSources on RA.DataSourceID equals DS.DataSourceID
                          join RTA in ent.ReportTemplateAttributes.DefaultIfEmpty() on RA.AttributeID equals RTA.AttributeID
                          where templateID == -1 || (templateID != -1 &amp;&amp; RTA.TemplateID == templateID)
                          select new HRFWeb.Models.ReportAttributeModel()
                         {
                             AttributeGroupID = RA.AttributeGroupID,
                             AttributeID = RA.AttributeID,
                             ParentID = RA.ParentID,
                             Name = RA.Name,
                             Alias = RA.Alias,
                             IsCalculated = RA.IsCalculated,
                             FilterTypeID = RA.FilterTypeID,
                             FilterType = FT.Name,
                             DataSourceID = RA.DataSourceID,
                             DBName = DS.DBName,
                             ServerName = DS.ServerName,
                             ServerIP = DS.ServerIP,
                             DataSourceTable = RA.DataSourceTable,
                             LogiDataType = RA.LogiDataType
                         };
</code></pre>

<p>And to further demonstrate, here is the working SQL equivalent:</p>

<pre>

DECLARE @TemplateID INT = -1
-- Returns 53 rows (correct)
SELECT * FROM dbo.ReportAttribute RA
JOIN dbo.FilterType FT ON FT.FilterTypeID = RA.FilterTypeID
JOIN dbo.DataSource DS ON DS.DataSourceID = RA.DataSourceID
LEFT JOIN dbo.ReportTemplateAttribute RTA ON RTA.AttributeID = RA.AttributeID
WHERE @TemplateID = -1 OR (@TemplateID > -1 AND RTA.TemplateID = @TemplateID)


SET @TemplateID = 0
-- Returns 32 rows (correct)
SELECT * FROM dbo.ReportAttribute RA
JOIN dbo.FilterType FT ON FT.FilterTypeID = RA.FilterTypeID
JOIN dbo.DataSource DS ON DS.DataSourceID = RA.DataSourceID
LEFT JOIN dbo.ReportTemplateAttribute RTA ON RTA.AttributeID = RA.AttributeID
WHERE @TemplateID = -1 OR (@TemplateID > -1 AND RTA.TemplateID = @TemplateID)</pre>",c#|linq,"<p>Try this. The idea is to filter ReportTemplateAttributes after joining. And to make a left join, combination of <code>into group</code> and <code>select xxx from group.DefaultIfEmpty()</code> is required.</p>

<pre><code>var result2 = from RA in ent.ReportAttributes 
                          join FT in ent.FilterTypes on RA.FilterTypeID equals FT.FilterTypeID
                          join DS in ent.DataSources on RA.DataSourceID equals DS.DataSourceID
                          join RTA in ent.ReportTemplateAttributes on RA.AttributeID equals RTA.AttributeID into g1
                          from g in g1 
                          select new HRFWeb.Models.ReportAttributeModel()
                          {
                             AttributeGroupID = RA.AttributeGroupID,
                             AttributeID = RA.AttributeID,
                             ParentID = RA.ParentID,
                             Name = RA.Name,
                             Alias = RA.Alias,
                             IsCalculated = RA.IsCalculated,
                             FilterTypeID = RA.FilterTypeID,
                             FilterType = FT.Name,
                             DataSourceID = RA.DataSourceID,
                             DBName = DS.DBName,
                             ServerName = DS.ServerName,
                             ServerIP = DS.ServerIP,
                             DataSourceTable = RA.DataSourceTable,
                             LogiDataType = RA.LogiDataType,
                             TemplateID = g.TemplateID
                           };

   if (FilterTemplateId != -1) {
     result2 = from r in result2
               where r.TemplateID == FilterTemplateID
               select r;
     }
</code></pre>",0
28168382,LINQ Filter rows based on LEFT JOIN,"<p>I want a LINQ query to have two behaviours, dependant on a parameter.</p>

<p>If param = -1, return all rows</p>

<p>If param > -1, return select rows</p>

<p>This is what I have tried. It emulates how I'd write it in SQL server (a left join with a where clause to force it to an inner join if param > -1), but it does not behave the same. It always returns filtered rows, behaving as if the RTA join is an inner join.</p>

<pre><code>                // Get attributes filtered to the template (-1 = all)
            var result2 = from RA in ent.ReportAttributes 
                          join FT in ent.FilterTypes on RA.FilterTypeID equals FT.FilterTypeID
                          join DS in ent.DataSources on RA.DataSourceID equals DS.DataSourceID
                          join RTA in ent.ReportTemplateAttributes.DefaultIfEmpty() on RA.AttributeID equals RTA.AttributeID
                          where templateID == -1 || (templateID != -1 &amp;&amp; RTA.TemplateID == templateID)
                          select new HRFWeb.Models.ReportAttributeModel()
                         {
                             AttributeGroupID = RA.AttributeGroupID,
                             AttributeID = RA.AttributeID,
                             ParentID = RA.ParentID,
                             Name = RA.Name,
                             Alias = RA.Alias,
                             IsCalculated = RA.IsCalculated,
                             FilterTypeID = RA.FilterTypeID,
                             FilterType = FT.Name,
                             DataSourceID = RA.DataSourceID,
                             DBName = DS.DBName,
                             ServerName = DS.ServerName,
                             ServerIP = DS.ServerIP,
                             DataSourceTable = RA.DataSourceTable,
                             LogiDataType = RA.LogiDataType
                         };
</code></pre>

<p>And to further demonstrate, here is the working SQL equivalent:</p>

<pre>

DECLARE @TemplateID INT = -1
-- Returns 53 rows (correct)
SELECT * FROM dbo.ReportAttribute RA
JOIN dbo.FilterType FT ON FT.FilterTypeID = RA.FilterTypeID
JOIN dbo.DataSource DS ON DS.DataSourceID = RA.DataSourceID
LEFT JOIN dbo.ReportTemplateAttribute RTA ON RTA.AttributeID = RA.AttributeID
WHERE @TemplateID = -1 OR (@TemplateID > -1 AND RTA.TemplateID = @TemplateID)


SET @TemplateID = 0
-- Returns 32 rows (correct)
SELECT * FROM dbo.ReportAttribute RA
JOIN dbo.FilterType FT ON FT.FilterTypeID = RA.FilterTypeID
JOIN dbo.DataSource DS ON DS.DataSourceID = RA.DataSourceID
LEFT JOIN dbo.ReportTemplateAttribute RTA ON RTA.AttributeID = RA.AttributeID
WHERE @TemplateID = -1 OR (@TemplateID > -1 AND RTA.TemplateID = @TemplateID)</pre>",c#|linq,"<pre><code>var result2 = from RA in ent.ReportAttributes 
                      join FT in ent.FilterTypes on RA.FilterTypeID equals FT.FilterTypeID
                      join DS in ent.DataSources on RA.DataSourceID equals DS.DataSourceID               
                      where templateID == -1 || (RA.TemplateAttributes != null &amp;&amp; RA.TemplateAttributes.Any(rt=&gt; rt.TemplateID == templateID))
                      select new HRFWeb.Models.ReportAttributeModel()
                     {
                         AttributeGroupID = RA.AttributeGroupID,
                         AttributeID = RA.AttributeID,
                         ParentID = RA.ParentID,
                         Name = RA.Name,
                         Alias = RA.Alias,
                         IsCalculated = RA.IsCalculated,
                         FilterTypeID = RA.FilterTypeID,
                         FilterType = FT.Name,
                         DataSourceID = RA.DataSourceID,
                         DBName = DS.DBName,
                         ServerName = DS.ServerName,
                         ServerIP = DS.ServerIP,
                         DataSourceTable = RA.DataSourceTable,
                         LogiDataType = RA.LogiDataType
                     };
</code></pre>

<p>By use of the navigation Property... The second check templateID != -1 seems redundant</p>",0
28103426,How to know when a string changed and do something?,"<p>I apologize in advance for a noob question.
I have a string which is changing without my control (another party's string) lets call it firstString,
every time this string changes I need to carry out an action in my program.</p>

<p>so I made a class that implements the ""INotifyPropertyChanged"" Interface,
and created a string in it with a property, lets call it secondString,
and on the main method of the form I've created a ""PropertyChangedEventHandler"" and an event method which shows a message box with the value of firstString.</p>

<p>everything works well if I manually test and change firstString by clicking a button to change its value and I get a message box with firstString's value after it went through secondString's Property, I set it like this:
<code>SecondString</code>(this is a property) <code>= firstString;</code></p>

<p>but the thing is firstString is changing by itself, and I don't have control over it, so if it is set by code to equal secondString's property what happens is that it only works for the first time that it runs.</p>

<p>so now every time secondString's property is changing, the event fires and that part is working OK. 
but I need to set secondString's value with firstString's value automatically every time that firstString's value changes. and I kind of figure that INotifyPropertyChanged should have somehow worked here for this part as well but I can't understand how. 
so I was trying to figure our how to ""bind"" string's A value to secondString's property, and got into DataBinding, but I couldn't find any example to bind two strings together, only about binding to or from a control. </p>

<p><strong>EDIT:</strong> here is a code to demo, I think the key that I've missed to note is that firstString is a string I get by another party's class library.</p>

<pre><code>Using AnotherPartyLibrary;

FirstClass fc;          

 public Form1()
        {
            InitializeComponent();

            fc = new FirstClass();
            fc.PropertyChanged += new PropertyChangedEventHandler(fc_PropertyChanged);

            fc.SecondString = AnotherPartyLibrary.firstString;

            this.Disposed += new EventHandler(Form1_Disposed);
        }

     void fc_PropertyChanged(object sender, PropertyChangedEventArgs e)
        {
           MessageBox.Show(""Something changed!"" + e.PropertyName);
        }

    public class firstClass :INotifyPropertyChanged
    {
        private string secondString = string.Empty;

        public string SecondString
        {
            get { return this.secondString; }
            set
            {
                this.secondString = value;
                NotifyPropertyChanged(""SecondString"");
            }
        }

        public event PropertyChangedEventHandler PropertyChanged;

        private void NotifyPropertyChanged(string info)
        {
            if (PropertyChanged != null)
            {
                PropertyChanged(this, new PropertyChangedEventArgs(info));
            }
        }
    }
</code></pre>

<p>How is this problem is usually solved? Many Thanks in advance! </p>

<p><strong>Edit: can anybody offer another solution other than what a.azemia has offered?Thanks again!</strong></p>

<p>Ray. </p>",c#|.net|winforms,"<p>Based on the assumption that you do not have control over firstString then you can use BackgroundWorker to monitor firstString value and update SecondString</p>

<pre><code>        BackgroundWorker bw = new BackgroundWorker();
        bw.DoWork += (s, e) =&gt;
            {
                while (true)
                {
                    if (!fc.SecondString.Equals(AnotherPartyLibrary.firstString))
                    {
                        fc.SecondString = AnotherPartyLibrary.firstString;
                    }
                    Thread.Sleep(1000);
                }
            };
        bw.RunWorkerAsync();
</code></pre>

<p>You can also use Microsoft TPL to achieve the same result</p>

<pre><code>public async void YourMethodName() 
{
    await Task.Run(() =&gt; 
        {
                while (true)
                {
                    if (!fc.SecondString.Equals(AnotherPartyLibrary.firstString))
                    {
                        fc.SecondString = AnotherPartyLibrary.firstString;
                    }
                    Thread.Sleep(1000);
                }
        });
}
</code></pre>

<p>However, if you can update the code for firstString then you should implement <code>INotifyPropertyChanged</code> on firstString.</p>",4
17074707,The best overloaded method match for 'System.Collections.Generic.List<Urun>.this[int]' has some invalid arguments,"<pre><code>public Urun(int id)
        {
            this.UrunId = id;

            List&lt;Urun&gt; dr = ManagementLib.UrunBilgisiAl(id, null, null, null, null, null, null, null, null, null, null, null, null, null, null);


            for (int i = 0; i &lt; dr.Count; i++)
            {


                this.UrunId = Convert.ToInt32(dr[""id""].ToString());
</code></pre>

<p>......</p>

<p>Error   1   The best overloaded method match for 'System.Collections.Generic.List.this[int]' has some invalid arguments</p>

<p>Error   2   Argument 1: cannot convert from <code>String</code> to <code>int</code>   </p>",c#|list|generics|collections|system,"<p><code>List&lt;T&gt;</code> does not support lookup by key. You need to use a <code>Dictionary&lt;string, URun&gt;</code></p>",1
17074707,The best overloaded method match for 'System.Collections.Generic.List<Urun>.this[int]' has some invalid arguments,"<pre><code>public Urun(int id)
        {
            this.UrunId = id;

            List&lt;Urun&gt; dr = ManagementLib.UrunBilgisiAl(id, null, null, null, null, null, null, null, null, null, null, null, null, null, null);


            for (int i = 0; i &lt; dr.Count; i++)
            {


                this.UrunId = Convert.ToInt32(dr[""id""].ToString());
</code></pre>

<p>......</p>

<p>Error   1   The best overloaded method match for 'System.Collections.Generic.List.this[int]' has some invalid arguments</p>

<p>Error   2   Argument 1: cannot convert from <code>String</code> to <code>int</code>   </p>",c#|list|generics|collections|system,"<blockquote>
  <p>Error 1 The best overloaded method match for 'System.Collections.Generic.List.this[int]' has some invalid arguments</p>
</blockquote>

<p>You're trying to access items on <code>List&lt;Urun&gt;</code> as a dictionary and that's not possible</p>

<pre><code>dr[""id""] //&lt;-- this is not valid, a position is expected (dr[0], dr[1], etc)
</code></pre>

<p>I assume you're trying to do</p>

<pre><code>this.UrunId = Convert.ToInt32(dr[i].id.ToString());
</code></pre>

<p>But I don't see the point honestly since on every iteration <code>this.UrunId</code> would be overwritten.</p>",1
16698230,"Swapping BindingList<SomeClass> elements takes a lot of time, why is that and what should I do?","<p>I'm writing small C# application mainly for fun, and there is a DataGridView to show some data, it is bound to the BindingList. Fun started from the moment I decided to make the table sortable, that's the reason for using BindingList. As far as I understand, there's no standard implementation of this in the BindingList, but msdn has the article covering this (<a href=""http://msdn.microsoft.com/en-us/library/aa480736.aspx"" rel=""nofollow"">about implementing sort and find for BindingList</a>). Long story short, few lines in their implementation that cause troubles:</p>

<pre><code>SomeClass tmp;
for(...)
{
    tmp = this[i]; //fast
    this[i] = this[position]; //slow
    this[position] = tmp; //slow
}
</code></pre>

<p>As comments show, the first assignment doesn't take much time, but other two are really slow. I fail to understand the reason behind it, but because of it sorting list 50 or so elements takes about two seconds.
Well, I can use some workaround, but it seems to be a bit ugly. Besides, I really want to know what causes such behavior.</p>",c#|list|variable-assignment,"<p>The main issue, if this is a <code>BindingList</code>, is that the <code>DataGridView</code> will try to update every time you set anything within your <code>BindingList</code>.  This means the two lines that you marked as slow are most likely not slow themselves, but slow because they trigger the <code>DataGridView</code> to refresh, which means it's refreshing many times over the sort operation.</p>

<p>You could get around this by encapsulating the <code>BindingList</code> instead of subclassing it, and not raising the events during the sort, but wait until the sort is completed, then refresh the entire list.</p>",1
16698230,"Swapping BindingList<SomeClass> elements takes a lot of time, why is that and what should I do?","<p>I'm writing small C# application mainly for fun, and there is a DataGridView to show some data, it is bound to the BindingList. Fun started from the moment I decided to make the table sortable, that's the reason for using BindingList. As far as I understand, there's no standard implementation of this in the BindingList, but msdn has the article covering this (<a href=""http://msdn.microsoft.com/en-us/library/aa480736.aspx"" rel=""nofollow"">about implementing sort and find for BindingList</a>). Long story short, few lines in their implementation that cause troubles:</p>

<pre><code>SomeClass tmp;
for(...)
{
    tmp = this[i]; //fast
    this[i] = this[position]; //slow
    this[position] = tmp; //slow
}
</code></pre>

<p>As comments show, the first assignment doesn't take much time, but other two are really slow. I fail to understand the reason behind it, but because of it sorting list 50 or so elements takes about two seconds.
Well, I can use some workaround, but it seems to be a bit ugly. Besides, I really want to know what causes such behavior.</p>",c#|list|variable-assignment,"<p>The slow down happens because the assignment will cause anything that is bound to that list to redraw (for example, the DataGridView).</p>

<p>You should modify your sort method to disable raising events while the list is being changed.</p>

<pre><code>var origRaiseEvents = this.RaiseListChangedEvents;
this.RaiseListChangedEvents = false;
try
{
    // here goes your original code.
}
finally
{
    this.RaiseListChangedEvents = origRaiseEvents;
}
</code></pre>",1
17013947,Dropdown Returning Wrong value asp.net server control,"<p>I have a drop down web server control which is binded with datasource from database ..when i select a value it always return value of first item in list on button click please resolve this issue..here is the code using </p>

<pre><code>using JobPortel.DTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace JobPortel
{
    public partial class receivedresume : System.Web.UI.Page
    {
        MemberDTO memberobj;
        int orgid;
        Utilities util;
        String jobidString;
        List&lt;JobDto&gt; joblist;
        protected void Page_Load(object sender, EventArgs e)
        {
            String UserName = (String)Session[""UserName""];
            util = new Utilities();
            memberobj = util.getMember(UserName);
            orgid = util.getOrganizationIdFromMember(memberobj.ID);

                joblist = util.getJobList(orgid);
                this.joblistdropdown.DataSource = joblist;
                joblistdropdown.DataTextField = ""Jobtitle"";
                joblistdropdown.DataValueField = ""Id"";
                this.joblistdropdown.DataBind();
            }

            if (IsPostBack) {

                 jobidString = this.joblistdropdown.SelectedValue;
            }
        }
        protected void savebtn_Click(object sender, EventArgs e)
        {
            int jobid = 0;

             jobid = Convert.ToInt32(jobidString);


            List&lt;MemberDTO&gt; cvlist = new List&lt;MemberDTO&gt;();

            using (var db = new jobportaldatabaseEntities1()) {

                var query = from m in db.Members
                            join p in db.applyjobtables on m.Id equals p.applicantid
                            where p.jobid == jobid
                            select m;
                foreach (var item in query)
                {
                    MemberDTO member = new MemberDTO();
                    member.ID = item.Id;
                    member.FirstName = item.firstname;
                    member.Lastname = item.lastname;
                    member.Location = item.location;
                    member.Mobile = item.mobile;
                    member.Email = item.email;
                    cvlist.Add(member);
                }
            }
            this.cvgridview.DataSource = cvlist;
            this.cvgridview.DataBind();
        }


    }
}
</code></pre>",c#|asp.net|.net,"<p>It's very common issue related to binding of dropdown list. Here your list is binding every time your page loads which makes selected value as first item of the dropdown, So you just need to bind it when it is not postback from server like this.</p>

<pre><code>if(!IsPostBack)
{
  joblist = util.getJobList(orgid);
  this.joblistdropdown.DataSource = joblist;
  joblistdropdown.DataTextField = ""Jobtitle"";
  joblistdropdown.DataValueField = ""Id"";
  this.joblistdropdown.DataBind();
}
</code></pre>",1
17013947,Dropdown Returning Wrong value asp.net server control,"<p>I have a drop down web server control which is binded with datasource from database ..when i select a value it always return value of first item in list on button click please resolve this issue..here is the code using </p>

<pre><code>using JobPortel.DTO;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;

namespace JobPortel
{
    public partial class receivedresume : System.Web.UI.Page
    {
        MemberDTO memberobj;
        int orgid;
        Utilities util;
        String jobidString;
        List&lt;JobDto&gt; joblist;
        protected void Page_Load(object sender, EventArgs e)
        {
            String UserName = (String)Session[""UserName""];
            util = new Utilities();
            memberobj = util.getMember(UserName);
            orgid = util.getOrganizationIdFromMember(memberobj.ID);

                joblist = util.getJobList(orgid);
                this.joblistdropdown.DataSource = joblist;
                joblistdropdown.DataTextField = ""Jobtitle"";
                joblistdropdown.DataValueField = ""Id"";
                this.joblistdropdown.DataBind();
            }

            if (IsPostBack) {

                 jobidString = this.joblistdropdown.SelectedValue;
            }
        }
        protected void savebtn_Click(object sender, EventArgs e)
        {
            int jobid = 0;

             jobid = Convert.ToInt32(jobidString);


            List&lt;MemberDTO&gt; cvlist = new List&lt;MemberDTO&gt;();

            using (var db = new jobportaldatabaseEntities1()) {

                var query = from m in db.Members
                            join p in db.applyjobtables on m.Id equals p.applicantid
                            where p.jobid == jobid
                            select m;
                foreach (var item in query)
                {
                    MemberDTO member = new MemberDTO();
                    member.ID = item.Id;
                    member.FirstName = item.firstname;
                    member.Lastname = item.lastname;
                    member.Location = item.location;
                    member.Mobile = item.mobile;
                    member.Email = item.email;
                    cvlist.Add(member);
                }
            }
            this.cvgridview.DataSource = cvlist;
            this.cvgridview.DataBind();
        }


    }
}
</code></pre>",c#|asp.net|.net,"<p>Whenever your page loads again(Post Back) the DropdownList gets binded with the DataSource Again and that Flushes the Selected Index of the DropDownList.
Please put a Breakpoint on the Page_Load Event and run your Code. You will understand it </p>

<p>Cheers,
Gagan</p>",0
16956181,Listing sql data in C#,"<p>I'm trying to list all the Members in my database on a grid through a list. I don't know if I'm in the right track. </p>

<p>I'm using this :</p>

<pre><code>        public List&lt;Member&gt; Members()
        {
            List&lt;Member&gt; list = new List&lt;Member&gt;();

            string SelectMembers = ""SELECT * FROM Members"";

            using (sqlCommand = new SqlCommand(SelectMembers, sqlConnection))
            {

            }

            return list;
        }
</code></pre>

<p>But ""IF"" I'm on the right track... in the <code>using</code> section, I don't really know what to do... I'm not asking for code, but I want someone to tell me what I should do. Thanks :)</p>",c#|sql-server-2008-r2,"<p><code>using</code> is a good place to start.  What I would do is then loop through the result set assigning the <code>properties</code> of the <code>Member</code> class with the columns from the dataset.  You have a variety of options when you want to read through your data.  You can use <code>DataSet</code>, <code>DataTable</code> or <code>SqlDataReader</code>.</p>",0
16956181,Listing sql data in C#,"<p>I'm trying to list all the Members in my database on a grid through a list. I don't know if I'm in the right track. </p>

<p>I'm using this :</p>

<pre><code>        public List&lt;Member&gt; Members()
        {
            List&lt;Member&gt; list = new List&lt;Member&gt;();

            string SelectMembers = ""SELECT * FROM Members"";

            using (sqlCommand = new SqlCommand(SelectMembers, sqlConnection))
            {

            }

            return list;
        }
</code></pre>

<p>But ""IF"" I'm on the right track... in the <code>using</code> section, I don't really know what to do... I'm not asking for code, but I want someone to tell me what I should do. Thanks :)</p>",c#|sql-server-2008-r2,"<p>With sqlcommand try to bind datareader object and than loop into this datareader to bind your list something like</p>

<pre><code>while (objDataReader.Read())
                {
                    objM = new Member();

                    if(objDataReader[""Id""] != DBNull.Value)
                        objM.Id = Convert.ToInt32(objDataReader[""Id""]);

                    list.Add(objM );
                }

             return list;
</code></pre>",0
16956181,Listing sql data in C#,"<p>I'm trying to list all the Members in my database on a grid through a list. I don't know if I'm in the right track. </p>

<p>I'm using this :</p>

<pre><code>        public List&lt;Member&gt; Members()
        {
            List&lt;Member&gt; list = new List&lt;Member&gt;();

            string SelectMembers = ""SELECT * FROM Members"";

            using (sqlCommand = new SqlCommand(SelectMembers, sqlConnection))
            {

            }

            return list;
        }
</code></pre>

<p>But ""IF"" I'm on the right track... in the <code>using</code> section, I don't really know what to do... I'm not asking for code, but I want someone to tell me what I should do. Thanks :)</p>",c#|sql-server-2008-r2,"<p>With a code example it's easier:</p>

<pre><code>using (var sqlCommand = new SqlCommand(SelectMembers, sqlConnection)) {
    // fetch data and iterate through results
    var reader = sqlCommand.ExecuteReader();
    while (reader.Read()) { 
        // create an object, set its properties and add it to the return list
        Member member = new Member();
        member.SomeProperty = reader[""MY_COLUMN""];
        list.Add(member);
    }
}
</code></pre>

<p>Otherwise you could use LINQ to SQL, there's a great tutorial on Scott Gu's blog: <a href=""http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx"" rel=""nofollow"">http://weblogs.asp.net/scottgu/archive/2007/05/19/using-linq-to-sql-part-1.aspx</a></p>",2
16956181,Listing sql data in C#,"<p>I'm trying to list all the Members in my database on a grid through a list. I don't know if I'm in the right track. </p>

<p>I'm using this :</p>

<pre><code>        public List&lt;Member&gt; Members()
        {
            List&lt;Member&gt; list = new List&lt;Member&gt;();

            string SelectMembers = ""SELECT * FROM Members"";

            using (sqlCommand = new SqlCommand(SelectMembers, sqlConnection))
            {

            }

            return list;
        }
</code></pre>

<p>But ""IF"" I'm on the right track... in the <code>using</code> section, I don't really know what to do... I'm not asking for code, but I want someone to tell me what I should do. Thanks :)</p>",c#|sql-server-2008-r2,"<p>You could use <a href=""http://msdn.microsoft.com/en-us/library/awzk4kc1.aspx"" rel=""nofollow""><code>SqlDataAdapter</code></a> to query this data.</p>

<pre><code>DataSet members = new DataSet();
ufing(SqlDataAdapter adapter = new SqlDataAdapter(sqlCommand))
{
    adapter.Fill(members, ""Members"");
    //Fill your list there from the DataSets's DataTable
}
</code></pre>",0
16823017,SelectedIndexChanged event not firing for 1 list item,"<p>I have a radiobuttonlist, a label, and a dropdown as follows:</p>

<pre><code>&lt;asp:RadioButtonList id=""rbList"" runat=""server"" AutoPostBack=""true"" EnableViewState=""false"" 
            OnSelectedIndexChanged=""rbList_SelectedIndexChanged"" 
RepeatLayout=""Table"" RepeatDirection=""Horizontal"" RepeatColumns=""3""&gt;
&lt;asp:ListItem Selected=""True""&gt; Radio 1 &lt;/asp:ListItem&gt;
            &lt;asp:ListItem&gt; Radio 2 &lt;/asp:ListItem&gt;
            &lt;asp:ListItem&gt; Radio 3 &lt;/asp:ListItem&gt;
            &lt;/asp:RadioButtonList&gt;

&lt;asp:Label runat=""server"" ID=""lbl"" text=""1,2"" EnableViewState=""false""&gt;&lt;/asp:Label&gt;

&lt;asp:DropDownList runat=""server"" ID=""ddl"" Visible=""false""&gt;                    
            &lt;/asp:DropDownList&gt; 
</code></pre>

<p>My rbList_SelectedIndexChanged is as follows:</p>

<pre><code>protected void rbList_SelectedIndexChanged(object sender, EventArgs e)
{
    if (rbList.SelectedIndex == 0 | rbList.SelectedIndex==1)
    {
        lbl.Text = ""1,2"";
        ddl.Visible = false;
        //ddl.Attributes.Add(""style"", ""display:none"");
    }
    else if (rbList.SelectedIndex == 2)
    {
        lbl.Text = ""3"";
        ddl.Visible = true;
        //ddl.Attributes.Add(""style"", """");
     }
}
</code></pre>

<p>Now when I change from radio3 to radio2, the event is getting fired as usual and everything looks good. But when I change from radio3 to radio1, I don't see the event getting fired (I inserted a breakpoint) the ddl stays visible but the value of lbl changes to 1,2.</p>

<p>My 2 questions are as follows:</p>

<p>1) Why is the event not getting fired on changing from radio3 to radio1?</p>

<p>2) How is the label value getting changed when the event is not firing?</p>

<p>Any help or comments are much appreciated..Thanks in advance!</p>",c#|asp.net|radiobuttonlist|selectedindexchanged,"<p>Preselecting a radio button in your markup is causing your problems. going from any other option back to option 1 will not trigger the  changed event.</p>

<p>this line is your culprit.</p>

<pre><code>&lt;asp:ListItem Selected=""True""&gt; Radio 1 &lt;/asp:ListItem&gt;
</code></pre>

<p>if you remove the Selected attribute the event should register properly</p>

<pre><code> &lt;asp:ListItem&gt; Radio 1 &lt;/asp:ListItem&gt;
</code></pre>

<p>you could handle the preselection in your code behind.</p>

<pre><code>    protected void Page_Load(object sender, EventArgs e)
    {
        if(!IsPostBack)
        {
           rbList.SelectedIndex = 0;
        }
    }
</code></pre>",1
16823017,SelectedIndexChanged event not firing for 1 list item,"<p>I have a radiobuttonlist, a label, and a dropdown as follows:</p>

<pre><code>&lt;asp:RadioButtonList id=""rbList"" runat=""server"" AutoPostBack=""true"" EnableViewState=""false"" 
            OnSelectedIndexChanged=""rbList_SelectedIndexChanged"" 
RepeatLayout=""Table"" RepeatDirection=""Horizontal"" RepeatColumns=""3""&gt;
&lt;asp:ListItem Selected=""True""&gt; Radio 1 &lt;/asp:ListItem&gt;
            &lt;asp:ListItem&gt; Radio 2 &lt;/asp:ListItem&gt;
            &lt;asp:ListItem&gt; Radio 3 &lt;/asp:ListItem&gt;
            &lt;/asp:RadioButtonList&gt;

&lt;asp:Label runat=""server"" ID=""lbl"" text=""1,2"" EnableViewState=""false""&gt;&lt;/asp:Label&gt;

&lt;asp:DropDownList runat=""server"" ID=""ddl"" Visible=""false""&gt;                    
            &lt;/asp:DropDownList&gt; 
</code></pre>

<p>My rbList_SelectedIndexChanged is as follows:</p>

<pre><code>protected void rbList_SelectedIndexChanged(object sender, EventArgs e)
{
    if (rbList.SelectedIndex == 0 | rbList.SelectedIndex==1)
    {
        lbl.Text = ""1,2"";
        ddl.Visible = false;
        //ddl.Attributes.Add(""style"", ""display:none"");
    }
    else if (rbList.SelectedIndex == 2)
    {
        lbl.Text = ""3"";
        ddl.Visible = true;
        //ddl.Attributes.Add(""style"", """");
     }
}
</code></pre>

<p>Now when I change from radio3 to radio2, the event is getting fired as usual and everything looks good. But when I change from radio3 to radio1, I don't see the event getting fired (I inserted a breakpoint) the ddl stays visible but the value of lbl changes to 1,2.</p>

<p>My 2 questions are as follows:</p>

<p>1) Why is the event not getting fired on changing from radio3 to radio1?</p>

<p>2) How is the label value getting changed when the event is not firing?</p>

<p>Any help or comments are much appreciated..Thanks in advance!</p>",c#|asp.net|radiobuttonlist|selectedindexchanged,"<p>As far as I can tell, programmatically setting SelectedIndex (even on first post) results in the same behaviour as setting Selected=""True"" on the markup.</p>

<p>The only sure-fire way seems to be using an UpdatePanel with the RadioButtonList as an async trigger, making sure the markup changes with every change.</p>

<p>That is, unless you want to go the jQuery route..</p>",1
16823017,SelectedIndexChanged event not firing for 1 list item,"<p>I have a radiobuttonlist, a label, and a dropdown as follows:</p>

<pre><code>&lt;asp:RadioButtonList id=""rbList"" runat=""server"" AutoPostBack=""true"" EnableViewState=""false"" 
            OnSelectedIndexChanged=""rbList_SelectedIndexChanged"" 
RepeatLayout=""Table"" RepeatDirection=""Horizontal"" RepeatColumns=""3""&gt;
&lt;asp:ListItem Selected=""True""&gt; Radio 1 &lt;/asp:ListItem&gt;
            &lt;asp:ListItem&gt; Radio 2 &lt;/asp:ListItem&gt;
            &lt;asp:ListItem&gt; Radio 3 &lt;/asp:ListItem&gt;
            &lt;/asp:RadioButtonList&gt;

&lt;asp:Label runat=""server"" ID=""lbl"" text=""1,2"" EnableViewState=""false""&gt;&lt;/asp:Label&gt;

&lt;asp:DropDownList runat=""server"" ID=""ddl"" Visible=""false""&gt;                    
            &lt;/asp:DropDownList&gt; 
</code></pre>

<p>My rbList_SelectedIndexChanged is as follows:</p>

<pre><code>protected void rbList_SelectedIndexChanged(object sender, EventArgs e)
{
    if (rbList.SelectedIndex == 0 | rbList.SelectedIndex==1)
    {
        lbl.Text = ""1,2"";
        ddl.Visible = false;
        //ddl.Attributes.Add(""style"", ""display:none"");
    }
    else if (rbList.SelectedIndex == 2)
    {
        lbl.Text = ""3"";
        ddl.Visible = true;
        //ddl.Attributes.Add(""style"", """");
     }
}
</code></pre>

<p>Now when I change from radio3 to radio2, the event is getting fired as usual and everything looks good. But when I change from radio3 to radio1, I don't see the event getting fired (I inserted a breakpoint) the ddl stays visible but the value of lbl changes to 1,2.</p>

<p>My 2 questions are as follows:</p>

<p>1) Why is the event not getting fired on changing from radio3 to radio1?</p>

<p>2) How is the label value getting changed when the event is not firing?</p>

<p>Any help or comments are much appreciated..Thanks in advance!</p>",c#|asp.net|radiobuttonlist|selectedindexchanged,"<p>I am not sure this is a bug or not, but...</p>

<p>When EnableViewState=""false"" with DDL or RBL and user trying to pick the first list item (index 0), the SelectedIndexChanged will NOT get fired.</p>

<p>If you set EnableViewState=""true"", then the DDL or RBL should work properly when user pick the first list item while non-first item was selected...</p>",2
16823017,SelectedIndexChanged event not firing for 1 list item,"<p>I have a radiobuttonlist, a label, and a dropdown as follows:</p>

<pre><code>&lt;asp:RadioButtonList id=""rbList"" runat=""server"" AutoPostBack=""true"" EnableViewState=""false"" 
            OnSelectedIndexChanged=""rbList_SelectedIndexChanged"" 
RepeatLayout=""Table"" RepeatDirection=""Horizontal"" RepeatColumns=""3""&gt;
&lt;asp:ListItem Selected=""True""&gt; Radio 1 &lt;/asp:ListItem&gt;
            &lt;asp:ListItem&gt; Radio 2 &lt;/asp:ListItem&gt;
            &lt;asp:ListItem&gt; Radio 3 &lt;/asp:ListItem&gt;
            &lt;/asp:RadioButtonList&gt;

&lt;asp:Label runat=""server"" ID=""lbl"" text=""1,2"" EnableViewState=""false""&gt;&lt;/asp:Label&gt;

&lt;asp:DropDownList runat=""server"" ID=""ddl"" Visible=""false""&gt;                    
            &lt;/asp:DropDownList&gt; 
</code></pre>

<p>My rbList_SelectedIndexChanged is as follows:</p>

<pre><code>protected void rbList_SelectedIndexChanged(object sender, EventArgs e)
{
    if (rbList.SelectedIndex == 0 | rbList.SelectedIndex==1)
    {
        lbl.Text = ""1,2"";
        ddl.Visible = false;
        //ddl.Attributes.Add(""style"", ""display:none"");
    }
    else if (rbList.SelectedIndex == 2)
    {
        lbl.Text = ""3"";
        ddl.Visible = true;
        //ddl.Attributes.Add(""style"", """");
     }
}
</code></pre>

<p>Now when I change from radio3 to radio2, the event is getting fired as usual and everything looks good. But when I change from radio3 to radio1, I don't see the event getting fired (I inserted a breakpoint) the ddl stays visible but the value of lbl changes to 1,2.</p>

<p>My 2 questions are as follows:</p>

<p>1) Why is the event not getting fired on changing from radio3 to radio1?</p>

<p>2) How is the label value getting changed when the event is not firing?</p>

<p>Any help or comments are much appreciated..Thanks in advance!</p>",c#|asp.net|radiobuttonlist|selectedindexchanged,"<p>I had a similar problem, but it had to do with the ""ChildrenAsTriggers"" property of the update panel being set to false.  All other radio button indexes worked fine this way, except index 0.</p>",0
2194342,Response.WriteFile with a URL possible?,"<p>I would like to be able to do this:</p>

<pre><code>Response.WriteFile (""http://domain/filepath/file.mpg"")
</code></pre>

<p>But, I get this error:</p>

<pre><code>Invalid path for MapPath 'http://domain/filepath/file.mpg' 
A virtual path is expected.
</code></pre>

<p>The <code>WriteFile</code> method does not appear to work with URLs. Is there any other way I can write the contents of a URL to my page?</p>

<p>Thanks. </p>",c#|asp.net|response.write,"<p>Basically you have a couple of choices. You can either download the file to your server and serve it with <code>Response.WriteFile</code> or you could redirect to the actual location. If the file is already on your server you just have to provide a file system path to <code>Response.WriteFile</code> instead of the url, or use a virtual url, by removing <code>http://domain</code>.</p>",0
2194342,Response.WriteFile with a URL possible?,"<p>I would like to be able to do this:</p>

<pre><code>Response.WriteFile (""http://domain/filepath/file.mpg"")
</code></pre>

<p>But, I get this error:</p>

<pre><code>Invalid path for MapPath 'http://domain/filepath/file.mpg' 
A virtual path is expected.
</code></pre>

<p>The <code>WriteFile</code> method does not appear to work with URLs. Is there any other way I can write the contents of a URL to my page?</p>

<p>Thanks. </p>",c#|asp.net|response.write,"<p>A possible solution would be to simply use:</p>

<pre><code>Response.Redirect(""http://domain/filepath/file.mpg"")
</code></pre>

<p>But then, I am not sure if that is what you are really trying to do or not.</p>",1
2194342,Response.WriteFile with a URL possible?,"<p>I would like to be able to do this:</p>

<pre><code>Response.WriteFile (""http://domain/filepath/file.mpg"")
</code></pre>

<p>But, I get this error:</p>

<pre><code>Invalid path for MapPath 'http://domain/filepath/file.mpg' 
A virtual path is expected.
</code></pre>

<p>The <code>WriteFile</code> method does not appear to work with URLs. Is there any other way I can write the contents of a URL to my page?</p>

<p>Thanks. </p>",c#|asp.net|response.write,"<p>If you need the code to work in that manner, then you will have to dynamically download it onto your server first:</p>

<pre><code>HttpWebRequest request = (HttpWebRequest)WebRequest.Create(""http://domain/filepath/file.mpg"");
HttpWebResponse response = (HttpWebResponse)request.GetResponse();
Stream file = response.GetResponseStream();
</code></pre>

<p>From that point, you have the contents of the file as a stream, and you will have to read/write the bytes out to the response.</p>

<p>I will mention however, that this is not necessarily optimal--you will be killing your bandwidth, because every file will be using far more resources than necessary.</p>

<p>If possible, move the file to your server, or rethink exactly what you are trying to do.</p>",3
2242806,How to setup disposable email aliases (craigslist style)?,"<p>Writing my own ""craigslist"" in .NET, trying to figure out how to create disposable email aliases (craigslist type)?</p>

<blockquote>
  <p>Here's what I mean by ""craigslist
  style"".</p>
  
  <p>My website is: somecoolurl.com</p>
  
  <p>User creates an account, but doesn't
  want to give his/her email out as contact when posting on the site. </p>
  
  <p>I want to give the user a TEMP email
  asdflkasfdjlaksdj@somecoolurl.com and
  alias that to their real email. When
  the user wants to get a new email, the
  TEMP gets canned and a new email gets
  created.</p>
</blockquote>",c#|email|email-spam,<p>Set up a catch-all account. Then use C# to log in with IMAP or POP and forward according to your rules. </p>,0
2242806,How to setup disposable email aliases (craigslist style)?,"<p>Writing my own ""craigslist"" in .NET, trying to figure out how to create disposable email aliases (craigslist type)?</p>

<blockquote>
  <p>Here's what I mean by ""craigslist
  style"".</p>
  
  <p>My website is: somecoolurl.com</p>
  
  <p>User creates an account, but doesn't
  want to give his/her email out as contact when posting on the site. </p>
  
  <p>I want to give the user a TEMP email
  asdflkasfdjlaksdj@somecoolurl.com and
  alias that to their real email. When
  the user wants to get a new email, the
  TEMP gets canned and a new email gets
  created.</p>
</blockquote>",c#|email|email-spam,"<p>Are you talking about email address piping? Check out this SO question <a href=""https://stackoverflow.com/questions/745124/best-way-to-send-anonymous-email-like-craigslist"">Best way to send anonymous email like craigslist</a> </p>

<p>Here is how to <a href=""https://stackoverflow.com/questions/926345/pipe-incoming-email-to-a-script-on-windows-iis-smtp"">pipe incomming mail on IIS</a></p>",3
2242806,How to setup disposable email aliases (craigslist style)?,"<p>Writing my own ""craigslist"" in .NET, trying to figure out how to create disposable email aliases (craigslist type)?</p>

<blockquote>
  <p>Here's what I mean by ""craigslist
  style"".</p>
  
  <p>My website is: somecoolurl.com</p>
  
  <p>User creates an account, but doesn't
  want to give his/her email out as contact when posting on the site. </p>
  
  <p>I want to give the user a TEMP email
  asdflkasfdjlaksdj@somecoolurl.com and
  alias that to their real email. When
  the user wants to get a new email, the
  TEMP gets canned and a new email gets
  created.</p>
</blockquote>",c#|email|email-spam,"<p>Hmm, not exactly sure what you're referring to with ""craigslist"" but I do know that in an app that I currently built, I purchased the SmarterMail app from <a href=""http://smartertools.com"" rel=""nofollow noreferrer"">http://smartertools.com</a> and used their .NET API as part of my software.</p>

<p>When a user signs up and pays, I generate a random string (you could make it more meaningful if you want) and then append it to the domain name (fke34s@example.com)</p>

<p>From there I create the email address via the SmarterMail API and assign the password based on the users existing password.</p>

<p>Then I have a watcher the checks to see if the paid subscription lapses... if it does, I disable the account for X days.  If the user doesn't renew after X days, the watcher deletes the account (this keeps my total users down since I didn't pay for the unlimited license yet).</p>

<p>Works very well.</p>",0
1401720,How to determine time interval during DST transition in C#,"<p>I want to compute the time 4 hours later during the DST transition, either into DST or out of it.</p>

<p>Currently doing this:</p>

<pre><code>DateTime now = DateTime.now();
DateTime later = now.AddHours(4);
System.Console.WriteLine(now + "" isDST "" + now.IsDaylightSavingTime());
System.Console.WriteLine(later + "" isDST "" + later.IsDaylightSavingTime());
</code></pre>

<p>Provides:</p>

<pre><code>11/1/2009 12:45:54 AM isDST True
11/1/2009 4:45:54 AM isDST False
</code></pre>

<p>What I want to see is:</p>

<pre><code>11/1/2009 12:45:54 AM isDST True
11/1/2009 3:45:54 AM isDST False
</code></pre>

<p>The ""best"" way I've found to do this is to take a round trip through UTC like this:</p>

<pre><code>DateTime now = DateTime.now();
DateTime later = now.ToUniversalTime().AddHours(4).ToLocalTime;
System.Console.WriteLine(now + "" isDST "" + now.IsDaylightSavingTime());
System.Console.WriteLine(later + "" isDST "" + later.IsDaylightSavingTime());
</code></pre>

<p>It seems I should be able to specify to AddHours() that the time returned should be elapsed time or display time. What am I missing? </p>",c#|datetime,"<p><code>AddHours()</code> deals with TimeSpans, which have no real concept of ""display hours"" or even timezones.  It's essentially a whole number of ticks.</p>

<p>I think what you're doing is a pretty good way of handling it, if I understand your intent correctly.</p>",2
1401720,How to determine time interval during DST transition in C#,"<p>I want to compute the time 4 hours later during the DST transition, either into DST or out of it.</p>

<p>Currently doing this:</p>

<pre><code>DateTime now = DateTime.now();
DateTime later = now.AddHours(4);
System.Console.WriteLine(now + "" isDST "" + now.IsDaylightSavingTime());
System.Console.WriteLine(later + "" isDST "" + later.IsDaylightSavingTime());
</code></pre>

<p>Provides:</p>

<pre><code>11/1/2009 12:45:54 AM isDST True
11/1/2009 4:45:54 AM isDST False
</code></pre>

<p>What I want to see is:</p>

<pre><code>11/1/2009 12:45:54 AM isDST True
11/1/2009 3:45:54 AM isDST False
</code></pre>

<p>The ""best"" way I've found to do this is to take a round trip through UTC like this:</p>

<pre><code>DateTime now = DateTime.now();
DateTime later = now.ToUniversalTime().AddHours(4).ToLocalTime;
System.Console.WriteLine(now + "" isDST "" + now.IsDaylightSavingTime());
System.Console.WriteLine(later + "" isDST "" + later.IsDaylightSavingTime());
</code></pre>

<p>It seems I should be able to specify to AddHours() that the time returned should be elapsed time or display time. What am I missing? </p>",c#|datetime,"<p>I don't think you're missing anything.  It sounds like DateTime could have a better documented or richer interface, but <a href=""http://msdn.microsoft.com/en-us/library/ms973825.aspx#datetime_topic6"" rel=""nofollow noreferrer"">MSDN recommends using UTC</a> exactly like you are.</p>

<p>There's a cute time difference between .NET and win32 in displaying times from a different daylight savings' rule than the present.  .NET will display the time as it would have been displayed at that time, while win32 will always give it in terms of the current daylight savings flag.</p>",2
1401720,How to determine time interval during DST transition in C#,"<p>I want to compute the time 4 hours later during the DST transition, either into DST or out of it.</p>

<p>Currently doing this:</p>

<pre><code>DateTime now = DateTime.now();
DateTime later = now.AddHours(4);
System.Console.WriteLine(now + "" isDST "" + now.IsDaylightSavingTime());
System.Console.WriteLine(later + "" isDST "" + later.IsDaylightSavingTime());
</code></pre>

<p>Provides:</p>

<pre><code>11/1/2009 12:45:54 AM isDST True
11/1/2009 4:45:54 AM isDST False
</code></pre>

<p>What I want to see is:</p>

<pre><code>11/1/2009 12:45:54 AM isDST True
11/1/2009 3:45:54 AM isDST False
</code></pre>

<p>The ""best"" way I've found to do this is to take a round trip through UTC like this:</p>

<pre><code>DateTime now = DateTime.now();
DateTime later = now.ToUniversalTime().AddHours(4).ToLocalTime;
System.Console.WriteLine(now + "" isDST "" + now.IsDaylightSavingTime());
System.Console.WriteLine(later + "" isDST "" + later.IsDaylightSavingTime());
</code></pre>

<p>It seems I should be able to specify to AddHours() that the time returned should be elapsed time or display time. What am I missing? </p>",c#|datetime,"<p>Yes, you should use UTC.</p>

<p>You're effectively talking about an <em>instant</em> in time 4 hours after the current instant. Not 4 hours of a particular local time, but 4 hours in ""experienced"" time, if you will. (Let's leave relativity out of it.) Imagine one person calls another and says, ""I'll call you again in 4 hours"" - both will know what that means, even if they're in completely different time zones with different DST transitions involved.</p>

<p>Instants are usually best expressed in UTC to avoid confusion - they're inherently ""universal"" rather than being in a particular time zone.</p>

<p>I'd avoid using local time until you need it:</p>

<pre><code>DateTime localTimeInFourHours = DateTime.UtcNow.AddHours(4).ToLocalTime;
</code></pre>

<p>Or you could use <code>DateTimeOffset</code> if you want to end up with a ""local time"" in a time zone other than the one your computer is set to.</p>",2
1574492,How Does GetSchemaTable() Work?,"<pre><code>OleDbDataReader oleDbDataReader = oleDbCommand.ExecuteReader(CommandBehavior.KeyInfo);
DataTable dataTable = oleDbDataReader.GetSchemaTable();
</code></pre>

<p>How does <code>GetSchemaTable()</code> work?</p>

<p>Where does it get its information in RDBMS?</p>",c#|oledbdatareader|getschematable,"<p>From the system tables (e.g., syscolumns, sysobjects, etc) in each database.</p>",-1
1574492,How Does GetSchemaTable() Work?,"<pre><code>OleDbDataReader oleDbDataReader = oleDbCommand.ExecuteReader(CommandBehavior.KeyInfo);
DataTable dataTable = oleDbDataReader.GetSchemaTable();
</code></pre>

<p>How does <code>GetSchemaTable()</code> work?</p>

<p>Where does it get its information in RDBMS?</p>",c#|oledbdatareader|getschematable,<p>GetSchemaTable() reads the metadata on the resultset returned by ADO.NET.</p>,2
1574492,How Does GetSchemaTable() Work?,"<pre><code>OleDbDataReader oleDbDataReader = oleDbCommand.ExecuteReader(CommandBehavior.KeyInfo);
DataTable dataTable = oleDbDataReader.GetSchemaTable();
</code></pre>

<p>How does <code>GetSchemaTable()</code> work?</p>

<p>Where does it get its information in RDBMS?</p>",c#|oledbdatareader|getschematable,"<p>The implementation of <code>IDataReader.GetSchemaTable()</code> is up to the provider - so it will vary. You can write your own providers and do it any way you want.</p>

<p>To be honest this is bad bit of design in the framework - you should never have interface methods that return an untyped <code>DataTable</code> or <code>DataSet</code> as that result could contain anything. Kinda defeats the point of constraining it by an interface in the first place: <em>""you must have a method that returns <code>DataTable</code> but we don't care what rows or columns it has""</em></p>

<p>Even if the provider is SQL <code>GetSchemaTable()</code> doesn't go back to the <code>[syscolumns]</code> or <code>[sysobjects]</code>. That would be an additional DB call, require additional privileges and not work anyway, as the result set doesn't need to reflect any objects in the DB.</p>

<p>I'm not certain, but I'd expect the vast majority of <code>IDataReader.GetSchemaTable()</code> implementations to read some properties of the meta data held with the result set.</p>",6
1962253,Mono AOT Segmentation Fault - Strange Problem,"<p>I wanted to test Mono AOT, so I wrote a simple console application with MonoDevelop:</p>

<pre><code>using System;

namespace abc
{
    public class Program
    {
        public static void Main()
        {
            Console.WriteLine(""Hello World!"");
        }
    }
}
</code></pre>

<p>It created a file named ""abc.exe"" in bin/debug. When I try to  do:</p>

<pre><code>mono abc.exe
</code></pre>

<p>it worked. So, I tried to AOT it. I did:</p>

<pre><code>mono --aot abc.exe
</code></pre>

<p>it created me a file named abc.exe.so. When I try to start it, it throws an ""Segmentation fault (core dumped)"" error. Heres the output of mono --aot:</p>

<pre><code>Code: 51 Info: 5 Ex Info: 8 Unwind Info: 31 Class Info: 30 PLT: 2 GOT Info: 11 GOT Info Offsets: 16 GOT: 20 Offsets: 48
Compiled 2 out of 3 methods (66%)
1 methods have other problems (33%)
Methods without GOT slots: 1 (33%)
Direct calls: 0 (100%)
JIT time: 1 ms, Generation time: 0 ms, Assembly+Link time: 0 ms.
</code></pre>

<p>How can I fix it?</p>

<p>Thanks.</p>",c#|mono|aot,"<p>What is your environment and Mono version?</p>

<p>AOT only works on x86, x86-64, and ARM, and only on Linux and maybe Mac.</p>

<p>If you are on one of these platforms and on the latest Mono version (2.6) then it sounds like a bug that should probably be filed at <a href=""http://www.mono-project.com/Bugs"" rel=""nofollow noreferrer"">http://www.mono-project.com/Bugs</a>.</p>",1
1962253,Mono AOT Segmentation Fault - Strange Problem,"<p>I wanted to test Mono AOT, so I wrote a simple console application with MonoDevelop:</p>

<pre><code>using System;

namespace abc
{
    public class Program
    {
        public static void Main()
        {
            Console.WriteLine(""Hello World!"");
        }
    }
}
</code></pre>

<p>It created a file named ""abc.exe"" in bin/debug. When I try to  do:</p>

<pre><code>mono abc.exe
</code></pre>

<p>it worked. So, I tried to AOT it. I did:</p>

<pre><code>mono --aot abc.exe
</code></pre>

<p>it created me a file named abc.exe.so. When I try to start it, it throws an ""Segmentation fault (core dumped)"" error. Heres the output of mono --aot:</p>

<pre><code>Code: 51 Info: 5 Ex Info: 8 Unwind Info: 31 Class Info: 30 PLT: 2 GOT Info: 11 GOT Info Offsets: 16 GOT: 20 Offsets: 48
Compiled 2 out of 3 methods (66%)
1 methods have other problems (33%)
Methods without GOT slots: 1 (33%)
Direct calls: 0 (100%)
JIT time: 1 ms, Generation time: 0 ms, Assembly+Link time: 0 ms.
</code></pre>

<p>How can I fix it?</p>

<p>Thanks.</p>",c#|mono|aot,"<p>You shouldn't start the output .so file, just run mono on the original managed .exe and it will pick up the AOT file automatically.</p>",5
1962253,Mono AOT Segmentation Fault - Strange Problem,"<p>I wanted to test Mono AOT, so I wrote a simple console application with MonoDevelop:</p>

<pre><code>using System;

namespace abc
{
    public class Program
    {
        public static void Main()
        {
            Console.WriteLine(""Hello World!"");
        }
    }
}
</code></pre>

<p>It created a file named ""abc.exe"" in bin/debug. When I try to  do:</p>

<pre><code>mono abc.exe
</code></pre>

<p>it worked. So, I tried to AOT it. I did:</p>

<pre><code>mono --aot abc.exe
</code></pre>

<p>it created me a file named abc.exe.so. When I try to start it, it throws an ""Segmentation fault (core dumped)"" error. Heres the output of mono --aot:</p>

<pre><code>Code: 51 Info: 5 Ex Info: 8 Unwind Info: 31 Class Info: 30 PLT: 2 GOT Info: 11 GOT Info Offsets: 16 GOT: 20 Offsets: 48
Compiled 2 out of 3 methods (66%)
1 methods have other problems (33%)
Methods without GOT slots: 1 (33%)
Direct calls: 0 (100%)
JIT time: 1 ms, Generation time: 0 ms, Assembly+Link time: 0 ms.
</code></pre>

<p>How can I fix it?</p>

<p>Thanks.</p>",c#|mono|aot,"<p>What skolima said was right, it is quite odd that he got down-voted.</p>

<p>You are not supposed to use directly the output generated by Mono's AOT compiler.</p>

<p>Mono's AOT compilation is a process that caches the output of JIT compilation and leaves it in a shared library that is loaded by the Mono runtime on demand.   The .so file that is generated contains the pre-compiled code and the metadata necessary to be consumed by the runtime.</p>

<p>To use the AOT file, you just invoke your program like this:</p>

<p>mono program.exe</p>

<p>Mono will load the metadata from program.exe and probe for the existence of a program.exe.so to avoid doing just-in-time compilation at runtime, and instead use the code from the .so file.   The same process is applied to any libraries referenced.</p>

<p>Even Mono's full static compilation mode produces code that requires the original .exe file to be present.</p>

<p>If what you wanted to achieve was a native executable, you could try the mkbundle command which packages the Mono runtime and your program into a single executable.</p>",7
1396531,C# - Collection is enough or comobination of LINQ will improve performance?,"<p>According to the requirement we have to return a collection either in reverse order or as </p>

<p>it is. We, beginning level programmer designed the collection as follow :(sample is given)</p>

<pre><code>namespace Linqfying

{

 class linqy

  {
      static void Main()

      {

         InvestigationReport rpt=new InvestigationReport();

         // rpt.GetDocuments(true) refers 
        //  to return the collection in reverse order       


            foreach(  EnquiryDocument doc in rpt.GetDocuments(true)   )
            {

               // printing document title and author name     

             }
        }
  } 




 class EnquiryDocument

  {
       string _docTitle;

       string _docAuthor;

       // properties to get and set doc title and author name goes below 


      public EnquiryDocument(string title,string author)

      {
      _docAuthor = author;

      _docTitle = title;
      }

      public EnquiryDocument(){}

}



   class InvestigationReport

   {

       EnquiryDocument[] docs=new EnquiryDocument[3];

      public IEnumerable&lt;EnquiryDocument&gt; GetDocuments(bool IsReverseOrder)

       {

           /* some business logic to retrieve the document 

            docs[0]=new EnquiryDocument(""FundAbuse"",""Margon"");

          docs[1]=new EnquiryDocument(""Sexual Harassment"",""Philliphe"");

              docs[2]=new EnquiryDocument(""Missing Resource"",""Goel""); 

         */ 


         //if reverse order is preferred

          if(IsReverseOrder)
          {

              for (int i = docs.Length; i != 0; i--)
              yield return docs[i-1];

          }

         else
          {
            foreach (EnquiryDocument doc in docs)
        {
             yield return doc;
            }
      }

      } 

}

 }
</code></pre>

<hr/>

<p>Question :</p>

<ul>

 <li> <i> Can we use other collection type to improve efficiency ? </i> </li>

 <li> <i> Mixing of Collection with LINQ reduce the code ? (We are not familiar with LINQ) </i> </li>

</ul>",c#,"<p>Your GetDocuments method has a return type of IEnumerable so there is no need to even loop over your array when IsReverseOrder is false, you can just return it as is as Array type is IEnumerable...</p>

<p>As for when IsReverseOrder is true you can use either Array.Reverse or the Linq Reverse() extension method to reduce the amount of code.</p>",0
1396531,C# - Collection is enough or comobination of LINQ will improve performance?,"<p>According to the requirement we have to return a collection either in reverse order or as </p>

<p>it is. We, beginning level programmer designed the collection as follow :(sample is given)</p>

<pre><code>namespace Linqfying

{

 class linqy

  {
      static void Main()

      {

         InvestigationReport rpt=new InvestigationReport();

         // rpt.GetDocuments(true) refers 
        //  to return the collection in reverse order       


            foreach(  EnquiryDocument doc in rpt.GetDocuments(true)   )
            {

               // printing document title and author name     

             }
        }
  } 




 class EnquiryDocument

  {
       string _docTitle;

       string _docAuthor;

       // properties to get and set doc title and author name goes below 


      public EnquiryDocument(string title,string author)

      {
      _docAuthor = author;

      _docTitle = title;
      }

      public EnquiryDocument(){}

}



   class InvestigationReport

   {

       EnquiryDocument[] docs=new EnquiryDocument[3];

      public IEnumerable&lt;EnquiryDocument&gt; GetDocuments(bool IsReverseOrder)

       {

           /* some business logic to retrieve the document 

            docs[0]=new EnquiryDocument(""FundAbuse"",""Margon"");

          docs[1]=new EnquiryDocument(""Sexual Harassment"",""Philliphe"");

              docs[2]=new EnquiryDocument(""Missing Resource"",""Goel""); 

         */ 


         //if reverse order is preferred

          if(IsReverseOrder)
          {

              for (int i = docs.Length; i != 0; i--)
              yield return docs[i-1];

          }

         else
          {
            foreach (EnquiryDocument doc in docs)
        {
             yield return doc;
            }
      }

      } 

}

 }
</code></pre>

<hr/>

<p>Question :</p>

<ul>

 <li> <i> Can we use other collection type to improve efficiency ? </i> </li>

 <li> <i> Mixing of Collection with LINQ reduce the code ? (We are not familiar with LINQ) </i> </li>

</ul>",c#,"<p>Two questions:</p>

<ol>
<li>Does the code you currently have work?</li>
<li>Have you identified this piece of code as being your performance bottleneck?</li>
</ol>

<p>If the answer to either of those questions is no, don't worry about it. Just make it work and move on. There's nothing grossly wrong about the code, so no need to fret! Spend your time building new functionality instead. Save LINQ for a new problem you haven't already solved.</p>",1
1396531,C# - Collection is enough or comobination of LINQ will improve performance?,"<p>According to the requirement we have to return a collection either in reverse order or as </p>

<p>it is. We, beginning level programmer designed the collection as follow :(sample is given)</p>

<pre><code>namespace Linqfying

{

 class linqy

  {
      static void Main()

      {

         InvestigationReport rpt=new InvestigationReport();

         // rpt.GetDocuments(true) refers 
        //  to return the collection in reverse order       


            foreach(  EnquiryDocument doc in rpt.GetDocuments(true)   )
            {

               // printing document title and author name     

             }
        }
  } 




 class EnquiryDocument

  {
       string _docTitle;

       string _docAuthor;

       // properties to get and set doc title and author name goes below 


      public EnquiryDocument(string title,string author)

      {
      _docAuthor = author;

      _docTitle = title;
      }

      public EnquiryDocument(){}

}



   class InvestigationReport

   {

       EnquiryDocument[] docs=new EnquiryDocument[3];

      public IEnumerable&lt;EnquiryDocument&gt; GetDocuments(bool IsReverseOrder)

       {

           /* some business logic to retrieve the document 

            docs[0]=new EnquiryDocument(""FundAbuse"",""Margon"");

          docs[1]=new EnquiryDocument(""Sexual Harassment"",""Philliphe"");

              docs[2]=new EnquiryDocument(""Missing Resource"",""Goel""); 

         */ 


         //if reverse order is preferred

          if(IsReverseOrder)
          {

              for (int i = docs.Length; i != 0; i--)
              yield return docs[i-1];

          }

         else
          {
            foreach (EnquiryDocument doc in docs)
        {
             yield return doc;
            }
      }

      } 

}

 }
</code></pre>

<hr/>

<p>Question :</p>

<ul>

 <li> <i> Can we use other collection type to improve efficiency ? </i> </li>

 <li> <i> Mixing of Collection with LINQ reduce the code ? (We are not familiar with LINQ) </i> </li>

</ul>",c#,"<p>Actually this task seems pretty straightforward.  I'd actually just use the <a href=""http://msdn.microsoft.com/en-us/library/5c6526tb.aspx"" rel=""nofollow noreferrer"">Reverse method on a Generic List</a>.</p>

<p>This should already be well-optimized.</p>",1
1396531,C# - Collection is enough or comobination of LINQ will improve performance?,"<p>According to the requirement we have to return a collection either in reverse order or as </p>

<p>it is. We, beginning level programmer designed the collection as follow :(sample is given)</p>

<pre><code>namespace Linqfying

{

 class linqy

  {
      static void Main()

      {

         InvestigationReport rpt=new InvestigationReport();

         // rpt.GetDocuments(true) refers 
        //  to return the collection in reverse order       


            foreach(  EnquiryDocument doc in rpt.GetDocuments(true)   )
            {

               // printing document title and author name     

             }
        }
  } 




 class EnquiryDocument

  {
       string _docTitle;

       string _docAuthor;

       // properties to get and set doc title and author name goes below 


      public EnquiryDocument(string title,string author)

      {
      _docAuthor = author;

      _docTitle = title;
      }

      public EnquiryDocument(){}

}



   class InvestigationReport

   {

       EnquiryDocument[] docs=new EnquiryDocument[3];

      public IEnumerable&lt;EnquiryDocument&gt; GetDocuments(bool IsReverseOrder)

       {

           /* some business logic to retrieve the document 

            docs[0]=new EnquiryDocument(""FundAbuse"",""Margon"");

          docs[1]=new EnquiryDocument(""Sexual Harassment"",""Philliphe"");

              docs[2]=new EnquiryDocument(""Missing Resource"",""Goel""); 

         */ 


         //if reverse order is preferred

          if(IsReverseOrder)
          {

              for (int i = docs.Length; i != 0; i--)
              yield return docs[i-1];

          }

         else
          {
            foreach (EnquiryDocument doc in docs)
        {
             yield return doc;
            }
      }

      } 

}

 }
</code></pre>

<hr/>

<p>Question :</p>

<ul>

 <li> <i> Can we use other collection type to improve efficiency ? </i> </li>

 <li> <i> Mixing of Collection with LINQ reduce the code ? (We are not familiar with LINQ) </i> </li>

</ul>",c#,"<p>Looks fine to me. Yes, you could use the <code>Reverse</code> extension method... but that won't be as efficient as what you've got.</p>

<p>How much do you care about the efficiency though? I'd go with the most <em>readable</em> solution (namely <code>Reverse</code>) until you know that efficiency is a problem. Unless the collection is large, it's unlikely to be an issue.</p>

<p>If you've got the ""raw data"" as an array, then your use of an iterator block will be more efficient than calling <code>Reverse</code>. The <code>Reverse</code> method will buffer up all the data before yielding it one item at a time - just like your own code does, really. However, simply calling <code>Reverse</code> would be a lot simpler...</p>

<p>Aside from anything else, I'd say it's well worth you learning LINQ - at least LINQ to Objects. It can make processing data <em>much, much</em> cleaner than before.</p>",1
2130092,Is there a function in c# which returns date&time when given GMT values(-12 to -1 and 1 to 12)?,"<p>Is there a function in c# which returns date&amp;time when given GMT values(-12 to -1 and 1 to 12)?</p>

<p><strong>EDIT:</strong></p>

<p>I have a Dropdownlistbox which contains all GMT values.. Now i want to display date&amp;time of a selected GMT value....</p>",c#|datetime|gmt,"<p>Is <a href=""http://msdn.microsoft.com/en-us/library/system.datetimeoffset.aspx"" rel=""nofollow noreferrer"">DateTimeOffset</a> what you are looking for?  One of its <a href=""http://msdn.microsoft.com/en-us/library/bb351980.aspx"" rel=""nofollow noreferrer"">constructors</a> takes a DateTime and an offset.</p>",0
2130092,Is there a function in c# which returns date&time when given GMT values(-12 to -1 and 1 to 12)?,"<p>Is there a function in c# which returns date&amp;time when given GMT values(-12 to -1 and 1 to 12)?</p>

<p><strong>EDIT:</strong></p>

<p>I have a Dropdownlistbox which contains all GMT values.. Now i want to display date&amp;time of a selected GMT value....</p>",c#|datetime|gmt,"<p>Paulo's answer should work fine, but the <a href=""http://msdn.microsoft.com/en-us/library/system.datetimeoffset.aspx"" rel=""nofollow noreferrer"">DateTimeOffset</a> struct in .NET 3.5 seems built for your question.</p>",0
2130092,Is there a function in c# which returns date&time when given GMT values(-12 to -1 and 1 to 12)?,"<p>Is there a function in c# which returns date&amp;time when given GMT values(-12 to -1 and 1 to 12)?</p>

<p><strong>EDIT:</strong></p>

<p>I have a Dropdownlistbox which contains all GMT values.. Now i want to display date&amp;time of a selected GMT value....</p>",c#|datetime|gmt,"<p>GMT is Greenwich Mean Time, right?   Or better known as UTC? </p>

<p>I think you're referring to UTC <em>offset</em>.  </p>

<p>In other words, given an offset from GMT, what is the time in that spot?  </p>

<p>I think it is </p>

<pre><code>DateTime.SpecifyKind(DateTime.UtcNow + new Timespan(offsetHours,0,0),
                     DateTimeKind.LocalTime);
</code></pre>

<p>except, that's not really true, because the ""kind"" of that DateTime will be Local, meaning <em>wherever the computer is right now</em>. What you really want is a DateTimeKind with a particular timezone.</p>

<p><strong>Addendum</strong></p>

<p>Also see the TzTimeZone class that is included in the
PublicDomain project on Codeplex: <a href=""http://www.codeplex.com/publicdomain"" rel=""nofollow noreferrer"">http://www.codeplex.com/publicdomain</a>.</p>

<p>The System.TimeZone as included in .NET 2.0 does not permit an
application to instantiate a TimeZone object given a shorthand name of
the timezone, or a UTC offset.  Instead, the System.TimeZone class
""knows"" about the local timezone but doesn't do much else.  This makes
it difficult to take an arbitrary time (say, 3:13pm, October 4th 2006,
in Los Angeles) and format it for display in an arbitrary other timezone
(say, Paris).</p>

<p>The TzTimeZone class provides a model for a number of different
timezones, including their offsets from UTC and the rules they apply for
daylight savings time.</p>

<p>With this new set of classes, it is possible to instantiate a timezone
from a well-known set of named instances.  It is also easy to format a
time value w.r.t. any arbitrary (named) timezone. In particular, it is
easy to take a time like (3:13pm October 4th 2006, in Los Angeles) and
format it for display in Paris.</p>",2
2130092,Is there a function in c# which returns date&time when given GMT values(-12 to -1 and 1 to 12)?,"<p>Is there a function in c# which returns date&amp;time when given GMT values(-12 to -1 and 1 to 12)?</p>

<p><strong>EDIT:</strong></p>

<p>I have a Dropdownlistbox which contains all GMT values.. Now i want to display date&amp;time of a selected GMT value....</p>",c#|datetime|gmt,"<p>You can use something like:</p>

<pre><code>var d = System.DateTime.Now().ToUniversalTime().AddHours(5)
</code></pre>",0
1606910,Converting MySQL DATETIME to System.DateTime,"<p>I am using a MySQL database with <a href=""http://code2code.net/DB_Linq/"" rel=""nofollow noreferrer"">DbLinq</a>, but there is an exception being thrown: </p>

<blockquote>
  <p>""Cannot convert mysql datetime to
  system.datetime""</p>
</blockquote>

<p>How can I resolve this issue?</p>",c#|asp.net-mvc|dblinq,"<p>I was moving a column in my gridview from asp:BoundField to asp:TemplateField so had to display a date from a MySQL database explicitly.  I found, through reflection, that the collection typed the date fields as MySqlDateTime and not system.DateTime.  </p>

<p>I added the import MySql.Data.Types statement to the code behind and the following Eval statement within a label in the context of a gridview.</p>

<p>Text='&lt;%# CType(Eval(""Submitted_Date""), MySql.Data.Types.MySqlDateTime).ToString%>'</p>

<p>output format:  02/23/2011</p>

<p>Hope that helps!</p>",1
1606910,Converting MySQL DATETIME to System.DateTime,"<p>I am using a MySQL database with <a href=""http://code2code.net/DB_Linq/"" rel=""nofollow noreferrer"">DbLinq</a>, but there is an exception being thrown: </p>

<blockquote>
  <p>""Cannot convert mysql datetime to
  system.datetime""</p>
</blockquote>

<p>How can I resolve this issue?</p>",c#|asp.net-mvc|dblinq,"<p>Well, if you have a result set containing MySql <code>DateTime</code> values, you could use the <a href=""http://msdn.microsoft.com/en-us/library/73fe8cwf.aspx"" rel=""nofollow noreferrer""><code>ConvertAll</code></a> method along with a delegate using <a href=""http://msdn.microsoft.com/en-us/library/system.datetime.parse.aspx"" rel=""nofollow noreferrer""><code>DateTime.Parse</code></a> to create a collection of <a href=""http://msdn.microsoft.com/en-us/library/system.datetime.aspx"" rel=""nofollow noreferrer""><code>System.DateTime</code></a> values. </p>

<p>Here's an example, where ""results"" is the result of your dblinq query containing MySQL datetime values:</p>

<pre><code>List&lt;DateTime&gt; dateTimes = results.ConvertAll(delegate(string time){ 
   return DateTime.Parse(time); 
});
</code></pre>

<p>Is this what you're looking for?</p>",1
1606910,Converting MySQL DATETIME to System.DateTime,"<p>I am using a MySQL database with <a href=""http://code2code.net/DB_Linq/"" rel=""nofollow noreferrer"">DbLinq</a>, but there is an exception being thrown: </p>

<blockquote>
  <p>""Cannot convert mysql datetime to
  system.datetime""</p>
</blockquote>

<p>How can I resolve this issue?</p>",c#|asp.net-mvc|dblinq,"<p>value.GetDateTime()</p>

<p><a href=""http://dev.mysql.com/doc/refman/5.0/en/connector-net-ref-types.html#connector-net-ref-types-mysqldatetime-getdatetime"" rel=""nofollow noreferrer"">http://dev.mysql.com/doc/refman/5.0/en/connector-net-ref-types.html#connector-net-ref-types-mysqldatetime-getdatetime</a></p>",2
1606910,Converting MySQL DATETIME to System.DateTime,"<p>I am using a MySQL database with <a href=""http://code2code.net/DB_Linq/"" rel=""nofollow noreferrer"">DbLinq</a>, but there is an exception being thrown: </p>

<blockquote>
  <p>""Cannot convert mysql datetime to
  system.datetime""</p>
</blockquote>

<p>How can I resolve this issue?</p>",c#|asp.net-mvc|dblinq,"<p>Check for any zero date means date like <strong>'0000-00-00'</strong> in database;
this could be the cause of error.</p>",5
2035827,C# minimax tree realization,"<p>I'm trying to write C# Chess AI.</p>

<p>At that moment I have to build my minmax tree. I try by using recursion, but my recursive functions has to call itself about 1 000 000 times for every node. I get Stack Overflow exception after about... 60 000 calls.</p>",c#|tree|chess,"<p>Given that the depth of the recursion might not be known you might want to stop to at a reasonable limit like 10 moves in advance and/or ignore trees that have a lower utility score.   By adding extra constraints such as these you can also ensure that a solution will be found quickly without having to optimize extensively.</p>

<p>As echoed by others it sounds like you probably have a bug given your large number of iterations. It might be possible to prune out a variety of rules or chose a different search strategy to reduce the number of iterations required, such as <a href=""http://en.wikipedia.org/wiki/Iterative_deepening_depth-first_search"" rel=""nofollow noreferrer"">iterative deepenning</a>, <a href=""http://en.wikipedia.org/wiki/A*"" rel=""nofollow noreferrer"">A*</a> or perhaps a <a href=""http://en.wikipedia.org/wiki/Genetic_algorithm"" rel=""nofollow noreferrer"">Genetic Algorithm</a> for fun,  </p>

<p>It would be much better to return a result even if it is not perfect rather than failing after searching the tree too deep.</p>

<p>Good luck.</p>",0
2035827,C# minimax tree realization,"<p>I'm trying to write C# Chess AI.</p>

<p>At that moment I have to build my minmax tree. I try by using recursion, but my recursive functions has to call itself about 1 000 000 times for every node. I get Stack Overflow exception after about... 60 000 calls.</p>",c#|tree|chess,"<p>if you are interested in learning how to write a C# Chess Engine I invite you to visit the <a href=""http://www.chessbin.com"" rel=""nofollow noreferrer"">Computer Chess Blog</a></p>

<p>The blog describes a creation of a C# Chess Engine from the first steps, providing C# code examples.  </p>

<p>The page you might be the most interested in is: <a href=""http://www.chessbin.com/post/Move-Searching-Alpha-Beta.aspx"" rel=""nofollow noreferrer"">Move Searching and Alpha Beta</a></p>

<p>This article gives a detailed explanation of Min Max and the Alpha Beta search algorithms including C# code examples of both.</p>",0
2035827,C# minimax tree realization,"<p>I'm trying to write C# Chess AI.</p>

<p>At that moment I have to build my minmax tree. I try by using recursion, but my recursive functions has to call itself about 1 000 000 times for every node. I get Stack Overflow exception after about... 60 000 calls.</p>",c#|tree|chess,"<p>I guess you are using a depth first search. This isn't too useful when the search space is so large. When implementing minimax you can use a breadth first search implemented as a depth first search with <a href=""http://en.wikipedia.org/wiki/Iterative_deepening_depth-first_search"" rel=""nofollow noreferrer"">iterative deepening</a>.</p>

<p>You should have a maximum number of levels you are allowed to recurse as a parameter to your functions, and decrease that by one each time you call your function recursively, until you hit zero when you stop and backtrack. Start with a small maximum depth and slowly increase it until you find an acceptable solution, or else run out of time.</p>",4
2035827,C# minimax tree realization,"<p>I'm trying to write C# Chess AI.</p>

<p>At that moment I have to build my minmax tree. I try by using recursion, but my recursive functions has to call itself about 1 000 000 times for every node. I get Stack Overflow exception after about... 60 000 calls.</p>",c#|tree|chess,"<p>Most chess search programs can only search to depth 9 or 10. This is not enough to overflow the stack at all.</p>

<p>You probably have an error in your program. In any case, you do need to have a depth limit on your search as you will not be able to do full-width search (exploring all possibilities across all moves up to a given depth) without a depth limit, since a chess game is potentially of unlimited depth (except for the repeated positions or limit on moves rule).</p>

<p>After you search to about depth 9, you have to use a static board evaluation function to evaluate and score the position. You then use the mini-max algorithm to prune branches of the search tree. It's still an exponential search though.</p>

<p>There are also techniques such as quiescent search, where you continue searching in positions where the position is not stable (i.e. if a piece can be taken or the king is in check).</p>",0
1434747,C# Generics - Constraints on type parameters,"<p>I'm trying to build a factory method that uses the generics feature of C#. </p>

<p>In this factory method I would like to constraint it to some specific classes, all of which do not have a default constructor.</p>

<p>Here is my example. Can someone tell me if it's possible to run it?</p>

<pre><code>public class AbstractClass {
    //this abstract class does not have a default constructor, nor its subclasses
    public AbstractClass(SomeClassName obj) {
        //use obj for initialization
    }
}

//this factory class should create objects of type T that inherit 
//from AbstractClass and invoke the non-default constructor
public class FactoryClass {
    public static T BuildObject&lt;T&gt; (SomeClassName obj) where T: AbstractClass {
        return new T(obj); //does not work?!?!?!
    }
}


//Edit: ANSWER!!!
public static T BuildObject&lt;T&gt;(SomeClassUsedForTheConstructor item) where T : SomeAbstractClass { 
return (T) Activator.CreateInstance(typeof (T), item); 
} 
</code></pre>",c#|generics,"<p>I don't think you can instantiate generic types without <a href=""http://msdn.microsoft.com/en-us/library/d5x73970.aspx"" rel=""nofollow noreferrer"">a default constructor</a> on the constraint type.  </p>

<p>Consider instead specifying an interface IAbstractClass, such that your factory class can set the SomeClassName parameter as a property of IAbstractClass.</p>

<p>Additionally, if a SomeClassName instance is required for initializing AbstractClass, consider also having an empty default constructor, but a rich initializer method defined in IAbstractClass.  For example:</p>

<pre><code>public interface IAbstractClass { void Initialize(SomeClassName obj); }
</code></pre>

<p>That way, your static BuildObject method instead does:</p>

<pre><code>public static T BuildObject&lt;T&gt;(SomeClassName obj) where T: AbstractClass 
{
  T newObject = new T();
  IAbstractClass ac = newObject as IAbstractClass;
  ac.Initialize(obj);
}
</code></pre>",4
1434747,C# Generics - Constraints on type parameters,"<p>I'm trying to build a factory method that uses the generics feature of C#. </p>

<p>In this factory method I would like to constraint it to some specific classes, all of which do not have a default constructor.</p>

<p>Here is my example. Can someone tell me if it's possible to run it?</p>

<pre><code>public class AbstractClass {
    //this abstract class does not have a default constructor, nor its subclasses
    public AbstractClass(SomeClassName obj) {
        //use obj for initialization
    }
}

//this factory class should create objects of type T that inherit 
//from AbstractClass and invoke the non-default constructor
public class FactoryClass {
    public static T BuildObject&lt;T&gt; (SomeClassName obj) where T: AbstractClass {
        return new T(obj); //does not work?!?!?!
    }
}


//Edit: ANSWER!!!
public static T BuildObject&lt;T&gt;(SomeClassUsedForTheConstructor item) where T : SomeAbstractClass { 
return (T) Activator.CreateInstance(typeof (T), item); 
} 
</code></pre>",c#|generics,"<p>No, what you are trying to do is not possible using the built-in generic constraints alone. The <em>new</em> keyword only allows you to constrain the generic type to having a default constructor.</p>",3
1434747,C# Generics - Constraints on type parameters,"<p>I'm trying to build a factory method that uses the generics feature of C#. </p>

<p>In this factory method I would like to constraint it to some specific classes, all of which do not have a default constructor.</p>

<p>Here is my example. Can someone tell me if it's possible to run it?</p>

<pre><code>public class AbstractClass {
    //this abstract class does not have a default constructor, nor its subclasses
    public AbstractClass(SomeClassName obj) {
        //use obj for initialization
    }
}

//this factory class should create objects of type T that inherit 
//from AbstractClass and invoke the non-default constructor
public class FactoryClass {
    public static T BuildObject&lt;T&gt; (SomeClassName obj) where T: AbstractClass {
        return new T(obj); //does not work?!?!?!
    }
}


//Edit: ANSWER!!!
public static T BuildObject&lt;T&gt;(SomeClassUsedForTheConstructor item) where T : SomeAbstractClass { 
return (T) Activator.CreateInstance(typeof (T), item); 
} 
</code></pre>",c#|generics,"<p>Look at the <a href=""http://msdn.microsoft.com/en-us/library/system.type.aspx"" rel=""nofollow noreferrer"">Type</a> class and GetConstructor.  Once you get the ConstructorInfo object, use the Invoke Method.</p>

<pre><code>var x = typeof(T);
var t = x.GetConstructor(new[] {obj.GetType()});
object u = t.Invoke(&lt;inputs&gt;);
</code></pre>",4
1434747,C# Generics - Constraints on type parameters,"<p>I'm trying to build a factory method that uses the generics feature of C#. </p>

<p>In this factory method I would like to constraint it to some specific classes, all of which do not have a default constructor.</p>

<p>Here is my example. Can someone tell me if it's possible to run it?</p>

<pre><code>public class AbstractClass {
    //this abstract class does not have a default constructor, nor its subclasses
    public AbstractClass(SomeClassName obj) {
        //use obj for initialization
    }
}

//this factory class should create objects of type T that inherit 
//from AbstractClass and invoke the non-default constructor
public class FactoryClass {
    public static T BuildObject&lt;T&gt; (SomeClassName obj) where T: AbstractClass {
        return new T(obj); //does not work?!?!?!
    }
}


//Edit: ANSWER!!!
public static T BuildObject&lt;T&gt;(SomeClassUsedForTheConstructor item) where T : SomeAbstractClass { 
return (T) Activator.CreateInstance(typeof (T), item); 
} 
</code></pre>",c#|generics,<p>I like to use <code>Activator.CreateInstance(typeof(T))</code> in my generics that need to create new objects of type T.  It works really well.</p>,5
1505732,Virtual Path Provider disable caching?,"<p>I have a virtual path provider. Problem is its caching my files. Whenever I manually edit one of the aspx files it references the VPP doesn't pull in the new file, it continues to reuse the old file until I restart the site.</p>

<p>I've even over-rode the GetCacheDependency() in my VirtualPathProvider class:</p>

<pre><code>    public override CacheDependency GetCacheDependency(string virtualPath, IEnumerable virtualPathDependencies, DateTime utcStart)
    {
        return null;
    }
</code></pre>

<p>Ideas?</p>",c#|caching|virtualpathprovider,"<p>The correct way to disable caching is this:</p>

<pre><code>    public override CacheDependency GetCacheDependency(string virtualPath, IEnumerable virtualPathDependencies, DateTime utcStart)
    {
        if (_IsLayoutFile(virtualPath))
        {
            return null;
        }
        return Previous.GetCacheDependency(virtualPath, virtualPathDependencies, utcStart);
    }

    public override String GetFileHash(String virtualPath, IEnumerable virtualPathDependencies)
    {
        if (_IsLayoutFile(virtualPath))
        {
            return Guid.NewGuid().ToString();
        }

        return Previous.GetFileHash(virtualPath, virtualPathDependencies);
    }
</code></pre>",16
1505732,Virtual Path Provider disable caching?,"<p>I have a virtual path provider. Problem is its caching my files. Whenever I manually edit one of the aspx files it references the VPP doesn't pull in the new file, it continues to reuse the old file until I restart the site.</p>

<p>I've even over-rode the GetCacheDependency() in my VirtualPathProvider class:</p>

<pre><code>    public override CacheDependency GetCacheDependency(string virtualPath, IEnumerable virtualPathDependencies, DateTime utcStart)
    {
        return null;
    }
</code></pre>

<p>Ideas?</p>",c#|caching|virtualpathprovider,"<pre><code>public override CacheDependency GetCacheDependency(string virtualPath, IEnumerable virtualPathDependencies, DateTime utcStart)
{
   return IsVirtualPath(virtualPath) ? new CacheDependency(HttpContext.Current.Server.MapPath(""~/Resource.xml"")) 
                                     : Previous.GetCacheDependency(virtualPath, virtualPathDependencies, utcStart);
}
</code></pre>",1
1505732,Virtual Path Provider disable caching?,"<p>I have a virtual path provider. Problem is its caching my files. Whenever I manually edit one of the aspx files it references the VPP doesn't pull in the new file, it continues to reuse the old file until I restart the site.</p>

<p>I've even over-rode the GetCacheDependency() in my VirtualPathProvider class:</p>

<pre><code>    public override CacheDependency GetCacheDependency(string virtualPath, IEnumerable virtualPathDependencies, DateTime utcStart)
    {
        return null;
    }
</code></pre>

<p>Ideas?</p>",c#|caching|virtualpathprovider,"<p>The solution that worked for me as desired was:</p>

<ul>
<li><strong>GetCacheDependency:</strong> return null;</li>
<li><strong>GetFileHash:</strong> return Guid.NewGuid().ToString();</li>
</ul>

<p>However, with this solution results in hanging the server (Cassini, IIS 6, IIS 7, IIS 8).  The hanging only lasts for a few minutes then the results are delivered.</p>

<p>I've also included a test for virtual path/file with the same results.  I messed with browser timeouts.</p>

<p>Can anyone help?</p>",-1
1505732,Virtual Path Provider disable caching?,"<p>I have a virtual path provider. Problem is its caching my files. Whenever I manually edit one of the aspx files it references the VPP doesn't pull in the new file, it continues to reuse the old file until I restart the site.</p>

<p>I've even over-rode the GetCacheDependency() in my VirtualPathProvider class:</p>

<pre><code>    public override CacheDependency GetCacheDependency(string virtualPath, IEnumerable virtualPathDependencies, DateTime utcStart)
    {
        return null;
    }
</code></pre>

<p>Ideas?</p>",c#|caching|virtualpathprovider,"<p>I don't believe this is  what the original poster asked. He wants to disable the caching entirely, not implement it in a better way, although your post is helpful for the latter.</p>

<p>A great many people are using VirtualPathProvider to pull data from a database instead of a file system.  I don't see how creating a file system dependency would be a useful way to determine when it's time to refresh the file.</p>

<p>How would you FORCE it to never use caching and always retrieve the latest version of the file?  That is the question.</p>",2
1505732,Virtual Path Provider disable caching?,"<p>I have a virtual path provider. Problem is its caching my files. Whenever I manually edit one of the aspx files it references the VPP doesn't pull in the new file, it continues to reuse the old file until I restart the site.</p>

<p>I've even over-rode the GetCacheDependency() in my VirtualPathProvider class:</p>

<pre><code>    public override CacheDependency GetCacheDependency(string virtualPath, IEnumerable virtualPathDependencies, DateTime utcStart)
    {
        return null;
    }
</code></pre>

<p>Ideas?</p>",c#|caching|virtualpathprovider,"<p>Returning a null is essentially telling ASP.NET that you do not have any dependency - hence ASP.NET will not reload the item.</p>

<p>What you need is to return a valid dependency e.g.</p>

<pre><code> public override CacheDependency GetCacheDependency(string virtualPath, IEnumerable virtualPathDependencies, DateTime utcStart)
    {
        return new CacheDependency(getPhysicalFileName(virtualPath));
    }
</code></pre>

<p>A more correct approach is to make sure that you only handle your own cache dependencies (this is a schematic example) :</p>

<pre><code> public override CacheDependency GetCacheDependency(string virtualPath, IEnumerable virtualPathDependencies, DateTime utcStart)
    {
        if (isMyVirtualPath(virtualPath))
            return new CacheDependency(getPhysicalFileName(virtualPath));
        else
            return new Previous.GetCacheDependency(virtualPath, virtualPathDependencies, utcStart);
    }
</code></pre>",21
2333835,extract all email address from a text using c#,"<p>Is there a way to extract all email addresses from a plain text using C# .</p>

<p>For example </p>

<blockquote>
  <p>my email address is mrrame@gmail.com and his email is mrgar@yahoo.com</p>
</blockquote>

<p>should return </p>

<p>mrrame@gmail.com, mrgar@yahoo.com</p>

<p>I have tried the following but it matches perfect emails only.</p>

<pre><code> public const string MatchEmailPattern =
            @""^(([\w-]+\.)+[\w-]+|([a-zA-Z]{1}|[\w-]{2,}))@""
            + @""((([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.""
              + @""([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])){1}|""
            + @""([a-zA-Z]+[\w-]+\.)+[a-zA-Z]{2,4})$"";


        public static bool IsEmail(string email)
        {
            if (email != null) return Regex.IsMatch(email, MatchEmailPattern);
            else return false;
        }
</code></pre>",c#|.net|regex|email,"<p>If you don't want it to match perfect email addresses, don't use a regular expression that matches perfect email addresses.</p>

<p>The regular expression you are using will match on the start of the line (^) and the end of the line ($), so if you remove those it will not filter with them.</p>",0
2333835,extract all email address from a text using c#,"<p>Is there a way to extract all email addresses from a plain text using C# .</p>

<p>For example </p>

<blockquote>
  <p>my email address is mrrame@gmail.com and his email is mrgar@yahoo.com</p>
</blockquote>

<p>should return </p>

<p>mrrame@gmail.com, mrgar@yahoo.com</p>

<p>I have tried the following but it matches perfect emails only.</p>

<pre><code> public const string MatchEmailPattern =
            @""^(([\w-]+\.)+[\w-]+|([a-zA-Z]{1}|[\w-]{2,}))@""
            + @""((([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.""
              + @""([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])){1}|""
            + @""([a-zA-Z]+[\w-]+\.)+[a-zA-Z]{2,4})$"";


        public static bool IsEmail(string email)
        {
            if (email != null) return Regex.IsMatch(email, MatchEmailPattern);
            else return false;
        }
</code></pre>",c#|.net|regex|email,"<p>check this snippet </p>

<pre><code>using System.IO;
using System.Text.RegularExpressions;
using System.Text;

class MailExtracter
{

    public static void ExtractEmails(string inFilePath, string outFilePath)
    {
        string data = File.ReadAllText(inFilePath); //read File 
        //instantiate with this pattern 
        Regex emailRegex = new Regex(@""\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*"",
            RegexOptions.IgnoreCase);
        //find items that matches with our pattern
        MatchCollection emailMatches = emailRegex.Matches(data);

        StringBuilder sb = new StringBuilder();

        foreach (Match emailMatch in emailMatches)
        {
            sb.AppendLine(emailMatch.Value);
        }
        //store to file
        File.WriteAllText(outFilePath, sb.ToString());
    }
}
</code></pre>",65
2333835,extract all email address from a text using c#,"<p>Is there a way to extract all email addresses from a plain text using C# .</p>

<p>For example </p>

<blockquote>
  <p>my email address is mrrame@gmail.com and his email is mrgar@yahoo.com</p>
</blockquote>

<p>should return </p>

<p>mrrame@gmail.com, mrgar@yahoo.com</p>

<p>I have tried the following but it matches perfect emails only.</p>

<pre><code> public const string MatchEmailPattern =
            @""^(([\w-]+\.)+[\w-]+|([a-zA-Z]{1}|[\w-]{2,}))@""
            + @""((([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.""
              + @""([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])){1}|""
            + @""([a-zA-Z]+[\w-]+\.)+[a-zA-Z]{2,4})$"";


        public static bool IsEmail(string email)
        {
            if (email != null) return Regex.IsMatch(email, MatchEmailPattern);
            else return false;
        }
</code></pre>",c#|.net|regex|email,"<p>Just remove the ""^"" from the beginning and the ""$"" from the end of your filter string.</p>",6
2333835,extract all email address from a text using c#,"<p>Is there a way to extract all email addresses from a plain text using C# .</p>

<p>For example </p>

<blockquote>
  <p>my email address is mrrame@gmail.com and his email is mrgar@yahoo.com</p>
</blockquote>

<p>should return </p>

<p>mrrame@gmail.com, mrgar@yahoo.com</p>

<p>I have tried the following but it matches perfect emails only.</p>

<pre><code> public const string MatchEmailPattern =
            @""^(([\w-]+\.)+[\w-]+|([a-zA-Z]{1}|[\w-]{2,}))@""
            + @""((([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.""
              + @""([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])){1}|""
            + @""([a-zA-Z]+[\w-]+\.)+[a-zA-Z]{2,4})$"";


        public static bool IsEmail(string email)
        {
            if (email != null) return Regex.IsMatch(email, MatchEmailPattern);
            else return false;
        }
</code></pre>",c#|.net|regex|email,"<p>give this a try <a href=""http://www.regular-expressions.info/email.html"" rel=""nofollow noreferrer"">http://www.regular-expressions.info/email.html</a></p>",3
2333835,extract all email address from a text using c#,"<p>Is there a way to extract all email addresses from a plain text using C# .</p>

<p>For example </p>

<blockquote>
  <p>my email address is mrrame@gmail.com and his email is mrgar@yahoo.com</p>
</blockquote>

<p>should return </p>

<p>mrrame@gmail.com, mrgar@yahoo.com</p>

<p>I have tried the following but it matches perfect emails only.</p>

<pre><code> public const string MatchEmailPattern =
            @""^(([\w-]+\.)+[\w-]+|([a-zA-Z]{1}|[\w-]{2,}))@""
            + @""((([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.""
              + @""([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])){1}|""
            + @""([a-zA-Z]+[\w-]+\.)+[a-zA-Z]{2,4})$"";


        public static bool IsEmail(string email)
        {
            if (email != null) return Regex.IsMatch(email, MatchEmailPattern);
            else return false;
        }
</code></pre>",c#|.net|regex|email,"<p>Following works</p>

<pre><code>public static void emas(string text)
        {
            const string MatchEmailPattern =
           @""(([\w-]+\.)+[\w-]+|([a-zA-Z]{1}|[\w-]{2,}))@""
           + @""((([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.""
             + @""([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])\.([0-1]?[0-9]{1,2}|25[0-5]|2[0-4][0-9])){1}|""
           + @""([a-zA-Z]+[\w-]+\.)+[a-zA-Z]{2,4})"";
            Regex rx = new Regex(MatchEmailPattern,  RegexOptions.Compiled | RegexOptions.IgnoreCase);
            // Find matches.
            MatchCollection matches = rx.Matches(text);
            // Report the number of matches found.
            int noOfMatches = matches.Count;
            // Report on each match.
            foreach (Match match in matches)
            {
                Console.WriteLine(match.Value.ToString());
            }
        }
</code></pre>",21
21659457,WP8 emulator cant connect to IIS Express,"<p>I'm unable to get a connection from WP8 emulator to an IIS Express local instance. I've set the binding an am running VS with admin rights: </p>

<pre><code>&lt;bindings&gt;
     &lt;binding protocol=""http"" bindingInformation=""*:5285:localhost"" /&gt;
     &lt;binding protocol=""http"" bindingInformation=""*:5285:192.168.1.90"" /&gt;
&lt;/bindings&gt;
</code></pre>

<p>The binding is working since it shows up in the IIS Express menu and I can view results when sending a GET in Fiddler to  [code]http://192.168.1.90:5285/api/account/getallusers[/code].  </p>

<p>I've created a test method in WP8 to try to access the api: </p>

<pre><code>public async static void TestConnection()
{
    var url = ""http://192.168.1.90:5285/api/account/getusers"";
    using (var client = new HttpClient())
    {
        var res = await client.GetAsync(url);
        Debug.WriteLine(res.StatusCode);
    }
}
</code></pre>

<p>This should be enough to get the WP8 emulator to connect to the IIS instance but im getting Not Found all the time. Does anyone have any suggestions about what might be causing this?</p>",c#|iis|windows-phone-8,"<p>The step that I usually forget is to open the firewall port for the IIS express. </p>

<p>Make sure you open the port <code>5285</code> in the firewall. </p>",1
21604380,How to unzip files in Windows Phone 8,"<p>Is it possible to unzip files on my application which is on Windows Phone 8? Most libs are using Windows Phone 7 but not Windows Phone 8.</p>

<p>Even <code>System.IO.Compression.ZipFile</code> is not there...</p>",c#|windows-phone-8|unzip,"<p>Put this code inside Unzipper class like this</p>

<pre><code>      public sealed class UnZipper : IDisposable
            {
                private Stream stream;
                private List&lt;FileEntry&gt; fileEntries;

                /// &lt;summary&gt;
                /// Class used for storing file entry information when
                /// parsing the central file directory.
                /// &lt;/summary&gt;
                private class FileEntry
                {
                    public string Filename;
                    public int FileStart;
                    public int CompressedSize;
                    public int UncompressedSize;
                    public int CRC32;
                }

                /// &lt;summary&gt;
                /// Initializes a new instance of the &lt;see cref=""UnZipper""/&gt; class.
                /// &lt;/summary&gt;
                /// &lt;param name=""zipFileStream""&gt;The zip file stream.&lt;/param&gt;
                public UnZipper(Stream zipFileStream)
                {
                    if (!zipFileStream.CanSeek)
                        throw new NotSupportedException(""zip stream must be seekable"");
                    this.stream = zipFileStream;
                }

                /// &lt;summary&gt;
                /// Gets the file stream for the specified file. Returns null if the file could not be found.
                /// &lt;/summary&gt;
                /// &lt;param name=""filename""&gt;The filename.&lt;/param&gt;
                /// &lt;returns&gt;Stream to file inside zip stream&lt;/returns&gt;
                public Stream GetFileStream(string filename)
                {
                    if (fileEntries == null)
                        fileEntries = ParseCentralDirectory(); //We need to do this in case the zip is in a format Silverligth doesn't like
                    long position = this.stream.Position;
                    this.stream.Seek(0, SeekOrigin.Begin);
                    Uri fileUri = new Uri(filename, UriKind.Relative);
                    StreamResourceInfo info = new StreamResourceInfo(this.stream, null);
                    StreamResourceInfo stream = System.Windows.Application.GetResourceStream(info, fileUri);
                    this.stream.Position = position;
                    if (stream != null)
                        return stream.Stream;
                    return null;
                }

                /// &lt;summary&gt;
                /// Gets a list of file names embedded in the zip file.
                /// &lt;/summary&gt;
                /// &lt;param name=""stream""&gt;The stream for a zip file.&lt;/param&gt;
                /// &lt;returns&gt;List of file names&lt;/returns&gt;
                public IEnumerable&lt;string&gt; FileNamesInZip()
                {
                    //get
                    //{
                    if (fileEntries == null)
                        fileEntries = ParseCentralDirectory();
                    foreach (FileEntry entry in fileEntries)
                        //Ignore folders and ""hidden"" MacOS folders
                        if (!entry.Filename.EndsWith(""/"") &amp;&amp; !entry.Filename.StartsWith(""__MACOSX/""))
                            yield return entry.Filename;
                    //}
                }

                /// &lt;summary&gt;
                /// Gets a list of directories embedded in the zip file
                /// &lt;/summary&gt;
                public IEnumerable&lt;string&gt; DirectoriesInZip
                {
                    get
                    {
                        if (fileEntries == null)
                            fileEntries = ParseCentralDirectory();
                        foreach (FileEntry entry in fileEntries)
                            //Ignore files and special MacOS folders
                            if (entry.Filename.EndsWith(""/"") &amp;&amp; !entry.Filename.StartsWith(""__MACOSX/""))
                                yield return entry.Filename;
                    }
                }

                private List&lt;FileEntry&gt; ParseCentralDirectory()
                {
                    BinaryReader reader = new BinaryReader(this.stream);
                    List&lt;FileEntry&gt; entries = new List&lt;FileEntry&gt;();
                    reader.BaseStream.Seek(-4, SeekOrigin.End);
                    while (reader.ReadInt32() != 101010256)
                    {
                        reader.BaseStream.Seek(-5, SeekOrigin.Current);
                    }
                    reader.BaseStream.Seek(6, SeekOrigin.Current);
                    short entryCount = reader.ReadInt16();
                    int directorySize = reader.ReadInt32();
                    int directoryStart = reader.ReadInt32();
                    reader.BaseStream.Seek(directoryStart, SeekOrigin.Begin);
                    bool needsFixing = false;
                    for (int i = 0; i &lt; entryCount; i++)
                    {
                        int headerSignature = reader.ReadInt32();
                        if (headerSignature == 33639248) //Central directory file header signature 
                        {
                            reader.BaseStream.Seek(4, SeekOrigin.Current);
                            byte flag = reader.ReadByte();
                            if ((flag &amp; 8) &gt; 0) //Silverlight doesn't like this format. We'll ""fix it"" further below
                            {
                                needsFixing = true;
                            }
                            reader.BaseStream.Seek(7, SeekOrigin.Current);
                            int crc32 = reader.ReadInt32();
                            int compressedSize = reader.ReadInt32();
                            int unCompressedSize = reader.ReadInt32();
                            short fileNameLenght = reader.ReadInt16();
                            short extraFieldLength = reader.ReadInt16();
                            short fileCommentLength = reader.ReadInt16();
                            reader.BaseStream.Seek(8, SeekOrigin.Current);
                            int fileStart = reader.ReadInt32();
                            string filename = new string(reader.ReadChars(fileNameLenght));
                            entries.Add(new FileEntry()
                            {
                                Filename = filename,
                                FileStart = fileStart,
                                CRC32 = crc32,
                                CompressedSize = compressedSize,
                                UncompressedSize = unCompressedSize
                            });
                            reader.BaseStream.Seek(extraFieldLength + fileCommentLength, SeekOrigin.Current);
                        }
                    }
                    if (needsFixing)
                    {
                        //We are using a zipformat that Silverlight doesn't like. 
                        //Zipfiles where the file size is reported after the compressed data
                        //is a no-go, so we rebuild the header and report the information there.
                        MemoryStream newZip = new MemoryStream();
                        BinaryWriter writer = new BinaryWriter(newZip);
                        //Rebuild file entries
                        foreach (FileEntry entry in entries)
                        {
                            FileEntry e = entry;
                            reader.BaseStream.Seek(entry.FileStart, SeekOrigin.Begin);
                            e.FileStart = (int)writer.BaseStream.Position;
                            CopyBytes(reader, writer, 6);
                            byte flag = reader.ReadByte();
                            writer.Write((byte)(247 &amp; flag)); //set 3rd bit to 0 to indicate the new format
                            CopyBytes(reader, writer, 7);
                            writer.Write(entry.CRC32); //Update CRC
                            writer.Write(entry.CompressedSize); //Update Compressed size
                            writer.Write(entry.UncompressedSize); //Update Uncompressed size
                            writer.Write((short)entry.Filename.Length);
                            reader.BaseStream.Seek(14, SeekOrigin.Current);
                            short fieldLength = reader.ReadInt16();
                            writer.Write(fieldLength);
                            CopyBytes(reader, writer, entry.Filename.Length + fieldLength + entry.CompressedSize);
                        }
                        //Rebuild directory
                        reader.BaseStream.Seek(directoryStart, SeekOrigin.Begin);
                        for (int i = 0; i &lt; entryCount; i++)
                        {
                            CopyBytes(reader, writer, 8);
                            byte flag = reader.ReadByte();
                            writer.Write((byte)(247 &amp; flag)); //set 3rd bit to 0 to indicate the new format
                            CopyBytes(reader, writer, 19);
                            short filenamelength = reader.ReadInt16();
                            writer.Write(filenamelength);
                            short extrafieldlength = reader.ReadInt16();
                            writer.Write(extrafieldlength);
                            short filecommentlength = reader.ReadInt16();
                            writer.Write(filecommentlength);
                            CopyBytes(reader, writer, 8);
                            writer.Write(entries[i].FileStart);
                            reader.BaseStream.Seek(4, SeekOrigin.Current);
                            CopyBytes(reader, writer, filenamelength + extrafieldlength + filecommentlength);
                        }
                        CopyBytes(reader, writer, (int)(reader.BaseStream.Length - reader.BaseStream.Position));
                        this.stream = newZip; //Replace stream with new stream
                    }
                    return entries;
                }

                private static void CopyBytes(BinaryReader input, BinaryWriter output, int count)
                {
                    for (int i = 0; i &lt; count; i++)
                    {
                        output.Write(input.ReadByte());
                    }
                }

                #region IDisposable Members

                /// &lt;summary&gt;
                /// Performs application-defined tasks associated with freeing, releasing,
                /// or resetting unmanaged resources.
                /// &lt;/summary&gt;
                public void Dispose()
                {
                    if (stream != null)
                        stream.Dispose();
                }

                #endregion
            }
</code></pre>

<p>and use this code where you want to unzip your file:</p>

<pre><code>IsolatedStorageFile myIsolatedStorage = IsolatedStorageFile.GetUserStoreForApplication();
using (IsolatedStorageFileStream fileStream = myIsolatedStorage.OpenFile(yourFileName, FileMode.Open, FileAccess.ReadWrite))
{
    UnZipper unzip = new UnZipper(fileStream);                               
    foreach (string filename in unzip.FileNamesInZip())
    {
        string FileName = filename;
    }
}    
</code></pre>",5
21496535,can i change data grid view combobox column into textbox column?,"<pre><code>if (ItemUnitsList.Count == 1)
{
        ((DataGridViewComboBoxCell)dataGridView1.Rows[i].Cells[2]).DataSource = ItemUnitsList
        ((DataGridViewComboBoxCell)dataGridView1.Rows[i].Cells[2]).DisplayMember = ""UnitName"";
        ((DataGridViewComboBoxCell)dataGridView1.Rows[i].Cells[2]).ValueMember = ""UnitId"";  
</code></pre>

<p>how i define default selected item to first index                </p>

<pre><code>}
else if (ItemUnitsList.Count &gt; 1)
{       
        ((DataGridViewComboBoxCell)dataGridView1.Rows[i].Cells[2]).DataSource = ItemUnitsList;
        ((DataGridViewComboBoxCell)dataGridView1.Rows[i].Cells[2]).DisplayMember = ""UnitName"";
        ((DataGridViewComboBoxCell)dataGridView1.Rows[i].Cells[2]).ValueMember = ""UnitId"";
</code></pre>

<p>how i define textchange event to this combobox column </p>

<pre><code>}
else
{
        MessageBox.Show(""NONE"");
}
</code></pre>",c#|winforms|datagridview,"<p>Once a column is created you can't change its type. There is no <code>TextChanged</code> event for <code>DataGridViewComboboxColumn</code>. </p>

<p>If you want to validate any change use the <code>DataGridView.CellValidating</code> event.</p>

<p>To learn about <code>DataGridView</code> see the tips given <a href=""http://www.dotnetperls.com/datagridview"" rel=""nofollow"">here</a>.</p>",0
21535422,Retrieve value from a hashtable with dynamic key,"<p>I have a hashtable ""Param"" which has keys which are created dynamically.
e.g <br/>
key : chkbox_1 Value: 1 <br/>
key : chk_box_2 Value : 2 <br/>
key : chk_box_3 Value <br/>
and so on.</p>

<p>Now I want to get all the values for keys which are LIKE ""chkbox_""
I can't do Param.ContainsKey[""chkbox_"" + id ] because I don't know the ""id"" part. </p>

<p>So basically I want to do something like Param.ContainsKey LIKE ""chkbox_"".</p>

<p>What is the best way to do this?</p>

<p>Thanks</p>",c#|.net|dictionary|hashtable,"<p>Both <code>HashTable</code> and <code>Dictionary&lt;TKey, TValue&gt;</code> require you to know the key to perform fast <em>O(1)</em> lookup for value. If you don't know the key you'll have to iterate over entire collection and check all the keys to find what you're looking for.</p>

<p>You should consider changing your collection to e.g. <code>SortedList</code>, which would allow you to find items with <code>LIKE 'Prefix%'</code> predicate in <em>O(log n)</em> time instead of <em>O(n)</em> for standard linear search.</p>",3
21535422,Retrieve value from a hashtable with dynamic key,"<p>I have a hashtable ""Param"" which has keys which are created dynamically.
e.g <br/>
key : chkbox_1 Value: 1 <br/>
key : chk_box_2 Value : 2 <br/>
key : chk_box_3 Value <br/>
and so on.</p>

<p>Now I want to get all the values for keys which are LIKE ""chkbox_""
I can't do Param.ContainsKey[""chkbox_"" + id ] because I don't know the ""id"" part. </p>

<p>So basically I want to do something like Param.ContainsKey LIKE ""chkbox_"".</p>

<p>What is the best way to do this?</p>

<p>Thanks</p>",c#|.net|dictionary|hashtable,"<p>You'll have to iterate through all the pairs:</p>

<pre><code>var values = dict.Where(kvp =&gt; kvp.Key.StartsWith(""chkbox_""))
    .Select(kvp =&gt; kvp.Value);
</code></pre>

<p>If you're using a non-generic <code>HashTable</code> you'll have to cast:</p>

<pre><code>IEnumerable&lt;object&gt; values = dict.Cast&lt;DictionaryEntry&gt;()
    .Where(de =&gt; ((string)de.Key).StartsWith(""chkbox_""))
    .Select(de =&gt; de.Value);
</code></pre>",1
21375129,How can I add the string text to the method that get string[]?,"<p>I have this string that contain text inside:</p>

<pre><code>readableRss = RssReader.covertRss(""http://rotter.net/rss/rotternews.xml"");
</code></pre>

<p>readbleRss is a string variable.</p>

<p>Then I have this code:</p>

<pre><code>SetupText(new string[] { ""Hello everyone this is the weather for today"", ""Text2"", ""hello world this is a test for long text what do you think"", ""Text 4 -&gt; 4"", ""Text Nr. 5"" });
SetupColors(new Color[] { Color.Blue, Color.Lime, Color.Maroon, Color.FromArgb(255, 71, 71, 255), Color.BurlyWood });

private void SetupColors(Color[] colors)
{
      if (this.newsFeed1.TextColor.Length &gt; 0 &amp;&amp; colors.Length &gt; 0)
             this.newsFeed1.TextColor[0] = colors[0];
      if (this.newsFeed1.TextColor.Length &gt; 1 &amp;&amp; colors.Length &gt; 1)
             this.newsFeed1.TextColor[1] = colors[1];
      if (this.newsFeed1.TextColor.Length &gt; 2 &amp;&amp; colors.Length &gt; 2)
             this.newsFeed1.TextColor[2] = colors[2];
      if (this.newsFeed1.TextColor.Length &gt; 3 &amp;&amp; colors.Length &gt; 3)
             this.newsFeed1.TextColor[3] = colors[3];
      if (this.newsFeed1.TextColor.Length &gt; 4 &amp;&amp; colors.Length &gt; 4)
             this.newsFeed1.TextColor[4] = colors[4];
}

private void SetupText(string[] textToDisplay)
    {
         if (this.newsFeed1.NewsTextFeed.Length &gt; 0 &amp;&amp; textToDisplay.Length &gt; 0)
              this.newsFeed1.NewsTextFeed[0] = textToDisplay[0];
          if (this.newsFeed1.NewsTextFeed.Length &gt; 1 &amp;&amp; textToDisplay.Length &gt; 1)
              this.newsFeed1.NewsTextFeed[1] = textToDisplay[1];
          if (this.newsFeed1.NewsTextFeed.Length &gt; 2 &amp;&amp; textToDisplay.Length &gt; 2)
              this.newsFeed1.NewsTextFeed[2] = textToDisplay[2];
          if (this.newsFeed1.NewsTextFeed.Length &gt; 3 &amp;&amp; textToDisplay.Length &gt; 3)
              this.newsFeed1.NewsTextFeed[3] = textToDisplay[3];
          if (this.newsFeed1.NewsTextFeed.Length &gt; 4 &amp;&amp; textToDisplay.Length &gt; 4)
              this.newsFeed1.NewsTextFeed[4] = textToDisplay[4];
    }
</code></pre>

<p>What I want is that instead adding to the news feeder the text from SetupText(new string[] { 
To add the text from readableRss</p>

<p>My program making the text to move scroll in animation from down to up like a news feeder.</p>

<p>The website is rss feed site.
So I want each line from the rss to be scrolled with my code.</p>

<p>This is en example of how the format looks like in the variable readbleRss:</p>

<pre><code>אם הרב אלקנה אליאסי נרצח ברקע לאומני?
Mon, 27 Jan 2014 10:27:40 +0200

ביל גייטס הובס תוך דקה ע''י צעיר בן 23 במשחק שחמט
Mon, 27 Jan 2014 10:25:30 +0200

מי יציל את המוסד לביטוח לאומי? - החל מ2042 לא יישאר כסף לקצבאות
Mon, 27 Jan 2014 10:25:03 +0200
</code></pre>

<p>EDIT**</p>

<p>This is what i tried now but its not working i dont see any text when running the program:</p>

<pre><code>readableRss = RssReader.covertRss(""http://rotter.net/rss/rotternews.xml"");
            for (int i = 0; i &lt; readableRss.Length; i++)
            {
                this.newsFeed1.NewsTextFeed = new string[i];
                string t = Convert.ToString(readableRss[i]);
                SetupText(new string[] { t });
            }
            this.newsFeed1.TextColor = new Color[1];
            SetupColors(new Color[] { Color.Blue });
</code></pre>",c#|winforms,"<p>If you want to split your string as per lines you can use this</p>

<pre><code>string[] lines = Regex.Split(readableRss, ""\r\n"");
</code></pre>

<p>Of course you need to include the corresponding namespace.</p>

<pre><code>using System.Text.RegularExpressions;
</code></pre>

<p>Hope this helps.</p>",1
30802611,Is there a difference between using for-each and Contains in joining on a query?,"<p>Let's say I am doing a join like this below:</p>

<pre><code>var query1 = (from ga in this.Context.GroupAddress
    join gpa in this.Context.GroupsProvidersAddresses on ga.GroupAddress_K equals gpa.GroupAddress_K
    where this.TerminatedGroupAddressesKeys.Contains(ga.GroupAddress_K)
            select gpa.ProviderAddress_K).ToList();
</code></pre>

<p>where <code>TerminatedGroupAddressesKeys</code> is a collection of strings that I have and I am using .<code>Contains</code></p>

<p>Is that different from doing a <code>for-each loop</code> on <code>TerminatedGroupAddressesKeys</code> and saying where <code>ga.GroupAddress_K == forEachItemInTheLoop</code></p>",c#|.net|entity-framework|linq|join,<p>You should definitely use contains because it will be executed in database and reduce the size of data that will be transferred between client and database. Also using foreach will reduce readability of your code</p>,1
30824410,MVC5 JSON parsing,"<p>I have this JSON from a 3rd party system (so I can't change the JSON). I am trying to get it to parse into a list of MethodItems, but my <code>Items</code> collection is always <code>null</code>. I am using the built-in MVC 5 JSON deserializer in a controller action. What am I missing.</p>

<pre><code>{ ""Method"": {
        ""name"": ""GetItems"",
        ""items"": {
            ""Item 1"": {
                ""name"": ""myItem"",
                ""value"": ""toothbrush""
            },
            ""Item 2"": {
                ""name"": ""my item 2"",
                ""value"": ""razor""
            }
        }
 }
</code></pre>

<p>C# objects here</p>

<pre><code>public class RequestRoot {
    public Method Method { get; set; }
}

public class Method {
    public string Name { get; set; }
    public MethodItem[] Items { get; set; }
}

public class MethodItem {
    public string name { get; set; }
    public string value { get; set; }
}
</code></pre>",c#|json|asp.net-mvc,"<p><code>Items</code> should be treat as a dictionary, try something like this:</p>

<pre><code>public class Method 
{

    public string name { get; set; }
    public Dictionary&lt;string,MethodItem&gt; items { get; set; }

}

public class MethodItem 
{

    public string name { get; set; }
    public string value { get; set; }

}
</code></pre>",3
30955909,"Practical Reasons to use C# ""named arguments""","<p>I find this feature ""named arguments"" from C# to be really weird because I see two flaws from it. The book says ""named arguments give you the ""ability to pass arguments in any order"".</p>

<p>Two flaws I think is a problem for this C# feature:</p>

<ol>
<li><p>It violates ""information hiding"" in computer science.
(i.e.: the end user using the method needs to know the parameter name and data type to make use of the feature.) Coming from a Java background, this is weird. Why expose parameter names to the end of the user? </p></li>
<li><p>It is prone to ambiguity which can lead to bugs.
(The programmer needs to do extra thinking and problems can creep up when the programmer wind up writing methods that use the same method name(aka overloading methods""). You will always get a ""call is ambiguous when you have two methods with same name with the same parameters for each other even if the other method has a extra parameters with different data types. The only fix I can think of is to make the data type a ""mandatory parameter"" aka a parameter without a default value so the compiler does not get confused. But then this fix is only a bandage solution to leads to another worst case scenario (see below)</p></li>
</ol>

<p>Do people in the industry even use this concept to this day? If so, why break the two rules to be given the ""ability to pass arguments in any order when calling the method""?</p>

<p>TLDR: An Example to bring clarity to what I am talking about by introducing a possible worst case scenario(the compiler chose the wrong method call... despite resemblance of the two methods):</p>

<pre><code>namespace ConsoleApplication1
{
    class Venusaur
    {
        static void Main(string[] args)
        {

            new Venusaur().optMethod(fourth: ""s"");
        }

        public void optMethod(  string third , string fourth =  ""hello"", int fifth = 23, string two = ""w"")
        {
            // what if I wanted this method to run instead of the method below me
            Console.WriteLine(""did not execute"");
        }


        public void optMethod(string third = ""Byte"", string fourth = ""hello"",  int fifth = 4)
        {
            // But this method ran instead
            Console.WriteLine(""run"");

        }


    }
}
</code></pre>",c#|methods|parameters|arguments|optional-parameters,"<p>I find your first argument completely specious. Like it or not the names of parameters <strong>are</strong> part of each method's semantics, particularly for abstract classes and methods that will be overridden in subclasses. The names of the parameters are a key signalling to users of a method on the semantics of that method, and of each parameters role in that semantics.  Further it is essential for understanding of the semantics throughout the class hierarchy that parameter names be consistent, and not subject to the whims of individual programmers at each level.</p>

<p>Your second argument I find completely unintelligible. If you actually have a valid point here I suggest you rewrite this to achieve greater clarity.</p>

<p>That said, I rarely use named parameters in my method calls; the exception being for methods that accept more than two consecutive parameters of the same type. In this case I like to name them so that I, as the future reader of the code, can in fact decipher the method's use without having to constantly hover to see the intelli-sense.</p>",3
30955909,"Practical Reasons to use C# ""named arguments""","<p>I find this feature ""named arguments"" from C# to be really weird because I see two flaws from it. The book says ""named arguments give you the ""ability to pass arguments in any order"".</p>

<p>Two flaws I think is a problem for this C# feature:</p>

<ol>
<li><p>It violates ""information hiding"" in computer science.
(i.e.: the end user using the method needs to know the parameter name and data type to make use of the feature.) Coming from a Java background, this is weird. Why expose parameter names to the end of the user? </p></li>
<li><p>It is prone to ambiguity which can lead to bugs.
(The programmer needs to do extra thinking and problems can creep up when the programmer wind up writing methods that use the same method name(aka overloading methods""). You will always get a ""call is ambiguous when you have two methods with same name with the same parameters for each other even if the other method has a extra parameters with different data types. The only fix I can think of is to make the data type a ""mandatory parameter"" aka a parameter without a default value so the compiler does not get confused. But then this fix is only a bandage solution to leads to another worst case scenario (see below)</p></li>
</ol>

<p>Do people in the industry even use this concept to this day? If so, why break the two rules to be given the ""ability to pass arguments in any order when calling the method""?</p>

<p>TLDR: An Example to bring clarity to what I am talking about by introducing a possible worst case scenario(the compiler chose the wrong method call... despite resemblance of the two methods):</p>

<pre><code>namespace ConsoleApplication1
{
    class Venusaur
    {
        static void Main(string[] args)
        {

            new Venusaur().optMethod(fourth: ""s"");
        }

        public void optMethod(  string third , string fourth =  ""hello"", int fifth = 23, string two = ""w"")
        {
            // what if I wanted this method to run instead of the method below me
            Console.WriteLine(""did not execute"");
        }


        public void optMethod(string third = ""Byte"", string fourth = ""hello"",  int fifth = 4)
        {
            // But this method ran instead
            Console.WriteLine(""run"");

        }


    }
}
</code></pre>",c#|methods|parameters|arguments|optional-parameters,"<p>The point about COM inter-op is most important. </p>

<p>Personally I tend to use it if I have a boolean parameter in the method signature that I want to use but there is no obvious variable that I can use. 
Example:</p>

<p>I find more readable</p>

<pre><code>var isSuccessful = myObject.Method(isRecursive: true)
</code></pre>

<p>then</p>

<pre><code>var isSuccessful = myObject.Method(true);
</code></pre>

<p>eventually you could more verbose syntax</p>

<pre><code>var isRecursive = true;
var isSuccessful = myObject.Method(isRecursive);
</code></pre>

<p>to avoid named parameter.</p>

<p>Obvious disadvantage of calling methods like that is if for some reason signature of the method changes, you code will no longer build. </p>",0
30955909,"Practical Reasons to use C# ""named arguments""","<p>I find this feature ""named arguments"" from C# to be really weird because I see two flaws from it. The book says ""named arguments give you the ""ability to pass arguments in any order"".</p>

<p>Two flaws I think is a problem for this C# feature:</p>

<ol>
<li><p>It violates ""information hiding"" in computer science.
(i.e.: the end user using the method needs to know the parameter name and data type to make use of the feature.) Coming from a Java background, this is weird. Why expose parameter names to the end of the user? </p></li>
<li><p>It is prone to ambiguity which can lead to bugs.
(The programmer needs to do extra thinking and problems can creep up when the programmer wind up writing methods that use the same method name(aka overloading methods""). You will always get a ""call is ambiguous when you have two methods with same name with the same parameters for each other even if the other method has a extra parameters with different data types. The only fix I can think of is to make the data type a ""mandatory parameter"" aka a parameter without a default value so the compiler does not get confused. But then this fix is only a bandage solution to leads to another worst case scenario (see below)</p></li>
</ol>

<p>Do people in the industry even use this concept to this day? If so, why break the two rules to be given the ""ability to pass arguments in any order when calling the method""?</p>

<p>TLDR: An Example to bring clarity to what I am talking about by introducing a possible worst case scenario(the compiler chose the wrong method call... despite resemblance of the two methods):</p>

<pre><code>namespace ConsoleApplication1
{
    class Venusaur
    {
        static void Main(string[] args)
        {

            new Venusaur().optMethod(fourth: ""s"");
        }

        public void optMethod(  string third , string fourth =  ""hello"", int fifth = 23, string two = ""w"")
        {
            // what if I wanted this method to run instead of the method below me
            Console.WriteLine(""did not execute"");
        }


        public void optMethod(string third = ""Byte"", string fourth = ""hello"",  int fifth = 4)
        {
            // But this method ran instead
            Console.WriteLine(""run"");

        }


    }
}
</code></pre>",c#|methods|parameters|arguments|optional-parameters,"<p>1) I don't understand where ""information hiding"" lies there ; a method signature is what you ask the end user to give you. He obviously needs to know the data type and name to disambiguate why argument refers to what. Also he still doesn't know what you gonna do with those parameters you asked for (maybe nothing) so what needs to be hidden from him is still hidden.</p>

<p>2) the problem here is in a bad choice for two overloads which differ only by number of arguments, that combined with the ability to omit certain arguments (provided by optional arguments) makes you lose the ""benefit"" to distinguish them (unless you give all the arguments)</p>

<p>Named parameters were (partly) introduced with dynamic for interop scenario ; for example with Office Automation where in C#3 you needed to add a bunch of <code>Type.Missing</code> arguments and then in C#4 you can just provide those you want/need.</p>",1
30955909,"Practical Reasons to use C# ""named arguments""","<p>I find this feature ""named arguments"" from C# to be really weird because I see two flaws from it. The book says ""named arguments give you the ""ability to pass arguments in any order"".</p>

<p>Two flaws I think is a problem for this C# feature:</p>

<ol>
<li><p>It violates ""information hiding"" in computer science.
(i.e.: the end user using the method needs to know the parameter name and data type to make use of the feature.) Coming from a Java background, this is weird. Why expose parameter names to the end of the user? </p></li>
<li><p>It is prone to ambiguity which can lead to bugs.
(The programmer needs to do extra thinking and problems can creep up when the programmer wind up writing methods that use the same method name(aka overloading methods""). You will always get a ""call is ambiguous when you have two methods with same name with the same parameters for each other even if the other method has a extra parameters with different data types. The only fix I can think of is to make the data type a ""mandatory parameter"" aka a parameter without a default value so the compiler does not get confused. But then this fix is only a bandage solution to leads to another worst case scenario (see below)</p></li>
</ol>

<p>Do people in the industry even use this concept to this day? If so, why break the two rules to be given the ""ability to pass arguments in any order when calling the method""?</p>

<p>TLDR: An Example to bring clarity to what I am talking about by introducing a possible worst case scenario(the compiler chose the wrong method call... despite resemblance of the two methods):</p>

<pre><code>namespace ConsoleApplication1
{
    class Venusaur
    {
        static void Main(string[] args)
        {

            new Venusaur().optMethod(fourth: ""s"");
        }

        public void optMethod(  string third , string fourth =  ""hello"", int fifth = 23, string two = ""w"")
        {
            // what if I wanted this method to run instead of the method below me
            Console.WriteLine(""did not execute"");
        }


        public void optMethod(string third = ""Byte"", string fourth = ""hello"",  int fifth = 4)
        {
            // But this method ran instead
            Console.WriteLine(""run"");

        }


    }
}
</code></pre>",c#|methods|parameters|arguments|optional-parameters,"<p>Named arguments is yet another piece of technology that was added to make interoperability with COM (and similar technologies) easier.</p>

<p>Take the <a href=""https://msdn.microsoft.com/fr-fr/library/microsoft.office.interop.word.documents.open(v=office.11).aspx"">method to open a Word document using COM</a>:</p>

<pre><code>Document Open(
    [In] ref object FileName, 
    [In, Optional] ref object ConfirmConversions, 
    [In, Optional] ref object ReadOnly, 
    [In, Optional] ref object AddToRecentFiles, 
    [In, Optional] ref object PasswordDocument, 
    [In, Optional] ref object PasswordTemplate, 
    [In, Optional] ref object Revert, 
    [In, Optional] ref object WritePasswordDocument, 
    [In, Optional] ref object WritePasswordTemplate, 
    [In, Optional] ref object Format, 
    [In, Optional] ref object Encoding, 
    [In, Optional] ref object Visible, 
    [In, Optional] ref object OpenAndRepair, 
    [In, Optional] ref object DocumentDirection, 
    [In, Optional] ref object NoEncodingDialog, 
    [In, Optional] ref object XMLTransform
);
</code></pre>

<p>It has no less than 16 parameters, 15 of which are optional.</p>

<p>What if you want to specify the <code>XMLTransform</code> parameter but don't care about the rest?</p>

<p>You would have to specify the rest with positional arguments. With named arguments the call simply becomes:</p>

<pre><code>doc.Open(""somefilename.doc"", XMLTransform: xxx);
</code></pre>

<p>Along with <code>dynamic</code> and a few other things, it wasn't meant to be a good solution to a lot of problems but when you have an API that relies heavily on methods with lots and lots of parameters, most of which are optional, named arguments makes sense.</p>

<p>Yes, you <em>can</em> specify arguments out of order. It doesn't mean it's a good idea or that it solves a problem someone really had.</p>",7
30781491,"Calling ""Form"" class method from ""A"" class without adding a reference to the ""Form"" class","<p>I have two Projects one is  a <strong>Winform</strong>  application another is a <strong>Class library</strong>. I have added a reference to the class Library in Winform and called a method  of the class library. Now I want  to call a different method in winform application from class library but I can't add a reference to winform to the class library.</p>

<p>IN CODE:- </p>

<pre><code>public partial class Form1 : Form
    {
        private void btn_Click(object sender, EventArgs e)
        {
            A obj = new A();
            obj.foo();
        }
        public string Test(par)
        {
            //to_stuff
        }


    }
</code></pre>

<p>and in Class library </p>

<pre><code> class A
    {
        public void foo()
        {
            //Do_stuff
            //...

            Test(Par);

            //Do...

        }
    }
</code></pre>",c#|winforms|methods|class-library,"<p>You can achieve this by injecting <code>Test</code> into <code>class A</code>.</p>

<p>For example:</p>

<pre><code>public partial class Form1 : Form
{
    private void btn_Click(object sender, EventArgs e)
    {
        A obj = new A();
        obj.foo(Test);
    }

    public string Test(string par)
    {
        //to_stuff
    }
}

class A
{
    public void foo(Func&lt;string, string&gt; callback)
        //Do_stuff
        //...

        if (callback != null)
        {
            callback(Par);
        }

        //Do...

    }
}
</code></pre>",4
30781491,"Calling ""Form"" class method from ""A"" class without adding a reference to the ""Form"" class","<p>I have two Projects one is  a <strong>Winform</strong>  application another is a <strong>Class library</strong>. I have added a reference to the class Library in Winform and called a method  of the class library. Now I want  to call a different method in winform application from class library but I can't add a reference to winform to the class library.</p>

<p>IN CODE:- </p>

<pre><code>public partial class Form1 : Form
    {
        private void btn_Click(object sender, EventArgs e)
        {
            A obj = new A();
            obj.foo();
        }
        public string Test(par)
        {
            //to_stuff
        }


    }
</code></pre>

<p>and in Class library </p>

<pre><code> class A
    {
        public void foo()
        {
            //Do_stuff
            //...

            Test(Par);

            //Do...

        }
    }
</code></pre>",c#|winforms|methods|class-library,"<p>While the callback method from David is a sufficient solution, if your interactions gets more complex, I would use this approach</p>

<p>Create an inteface in your class libary</p>

<pre><code>public interface ITester
{
    string Test(string value);
}
</code></pre>

<p>Rewrite your code so class A expects an ITester interface</p>

<pre><code>public class A
{
    public A(ITester tester)
    {
        this.tester = tester;
    }

    public string foo(string value)
    {
        return this.tester.Test(value);
    }        
}
</code></pre>

<p>Implement your interface in Form1</p>

<pre><code>public partial class Form1 : Form, ITester
{
    private void btn_Click(object sender, EventArgs e)
    {
        A obj = new A(this);
        obj.foo(""test"");
    }

    public string Test(string value)
    {
        //to_stuff
        return value;
    }
}
</code></pre>",3
30870843,C# mouse event handlers,"<p>I am implementing a card game. Here are basic blocks of the implementation:</p>

<p>I have a class of Card:</p>

<pre><code>Public
/*Constructor*/
         Card( string n)
        {
            this.name = n;
            this.image.MouseDown += new MouseEventHandler(this.OnMouseDown);
            this.image.MouseUp += new MouseEventHandler(this.OnMouseUp);
            this.image.MouseMove += new MouseEventHandler(this.OnMouseMove);


        }

Private
PictureBox image;// Keeps a tracker of the image of the card

// Event handlres
            public event MouseEventHandler MouseDown;
            public event MouseEventHandler MouseUp;
            public event MouseEventHandler MouseMove;

private  void OnMouseDown(object sender, MouseEventArgs e) 
        {
            mouseOriginalX = e.X;
            mouseOriginalY = e.Y;
            dragable = true;
        }
        private void OnMouseMove(object sender, MouseEventArgs e)
        {

            if (dragable)
            {
              this.image.Top += e.Y - mouseOriginalY;
              this.image.Left += e.X - mouseOriginalX;
              this.image.BringToFront();
            }
        }

        private void OnMouseUp(object sender, MouseEventArgs e)
        {
            this.image.Top = 200;
            this.image.Left = 150;
            dragable = false;
        }


    Private
    PictureBox image;// Keeps a tracker of the image of the card

    // Event handlres
                public event MouseEventHandler MouseDown;
                public event MouseEventHandler MouseUp;
                public event MouseEventHandler MouseMove;
</code></pre>

<p>I also defined a List of cards which holds 52 instances of cards</p>

<pre><code>public partial class Form1 : Form
    {
        List&lt;Card&gt; allCards = new List&lt;Card&gt;();// To store each card
      // More stuff here

    }
</code></pre>

<p>When I run the program, I can easily drag and drop each card (PictureBox of the Card class). The problem is that the Form does not know which card has been dragged and dropped. Let say we have a label called lblName on the main form. Every time I drag a card, I want to set the Text property of the label (lblName.Text) to the name property of the card.
In general, in each turn 4 cards are thrown. I need to keep a track of these four cards. Perhaps somewhere in the form have:</p>

<pre><code>publipublic partial class Form1 : Form
    {
        List&lt;Card&gt; PlayedCards = new List&lt;Card&gt;();// Played cards in each turn. Four cards in each turn
      // More stuff here

    }
</code></pre>

<p>then every time a card is thrown, we can add the card to the above List. Once we have 4 cards thrown, apply the game's logic and clear this list and go for the next run.
Thank you</p>",c#,"<p>Problem solved: </p>

<blockquote>
  <p>PictureBox pb = (PictureBox)sender;</p>
  
  <p>Form1 frm=(Form1)pb.Parent.GetContainerControl();</p>
</blockquote>

<p>then frm is my main form and contains everything I need from the main form</p>",0
25769625,Is paths interpretation on mono on mac different from the .net windows version?,"<p>I'm translating an app from .net on windows to mono on mac. I found an error that was happening, that I think related with how the backslash is interpreted on mono - mac.</p>

<pre><code>Path.GetDirectoryName(""Assembly\\file.dll"")
</code></pre>

<p>On mono for mac that return an empty string, on .net windows that return ""Assembly"". Is that the normal behaviour? can I change the way path are interpreted with some kind of configuration, or I need to replace every backslash with forwardslash?</p>",c#|macos|mono|path-separator,"<p>on mono you can use <code>MONO_IOMAP</code> environment variable to ignore differences like path ( windows is case insensitive, unix is case sensitive) and path separator ( '\' vs '/' )</p>

<p>see <a href=""http://www.mono-project.com/docs/advanced/iomap/"" rel=""nofollow"">http://www.mono-project.com/docs/advanced/iomap/</a></p>

<p>the best long term solution anyway is to use methods like <code>Path.Combine</code> or <code>Path.DirectorySeparator</code> to fix these problems</p>",1
25601794,"How to ""await"" the closing of another window","<p>I have a lot of code looking like that :</p>

<pre><code>MyWindow window = new MyWindow(someParam, callingWindow)
</code></pre>

<p>With a MyWindow class containing something like that :</p>

<pre><code>public MyWindow.Processing()
{
`  // Do processing
   ...
   callingWindow.RefreshListBox(); // Listbox for example
}
</code></pre>

<p>Is there a built-in way to await the closing of the window. I would like to be able to write something like that in the callingWindow's class :</p>

<pre><code>await mywindowInstanceCloseEvent; 
RefreshListBoxWhenWindowIsClosed();
</code></pre>

<p>I wonder if there is an easy way to ""pause"" a method (whether it's asynchronous or not) until a specific window is closed.</p>",c#|.net|wpf|async-await,"<p>It depends upon what is your need. If you need to show the window as modal dialog use <code>Window.ShowDialog</code>. Otherwise you can use <code>Window.Closed</code> event.</p>

<p>If you want to await it, Here is a <a href=""https://stackoverflow.com/a/25601933/2530848"">good answer</a> from @Athari.</p>",3
25601794,"How to ""await"" the closing of another window","<p>I have a lot of code looking like that :</p>

<pre><code>MyWindow window = new MyWindow(someParam, callingWindow)
</code></pre>

<p>With a MyWindow class containing something like that :</p>

<pre><code>public MyWindow.Processing()
{
`  // Do processing
   ...
   callingWindow.RefreshListBox(); // Listbox for example
}
</code></pre>

<p>Is there a built-in way to await the closing of the window. I would like to be able to write something like that in the callingWindow's class :</p>

<pre><code>await mywindowInstanceCloseEvent; 
RefreshListBoxWhenWindowIsClosed();
</code></pre>

<p>I wonder if there is an easy way to ""pause"" a method (whether it's asynchronous or not) until a specific window is closed.</p>",c#|.net|wpf|async-await,"<p>You can use <code>TaskCompletionSource</code> and <code>Closed</code> event for this. Here is a method I use:</p>

<pre><code>private Task ShowPopup&lt;TPopup&gt; (TPopup popup)
    where TPopup : Window
{
    var task = new TaskCompletionSource&lt;object&gt;();
    popup.Owner = Application.Current.MainWindow;
    popup.Closed += (s, a) =&gt; task.SetResult(null);
    popup.Show();
    popup.Focus();
    return task.Task;
}
</code></pre>

<p>You can use it like this:</p>

<pre><code>await ShowPopup(new MyWindow());
</code></pre>

<p>You can replace <code>Show</code> method with <code>ShowDialog</code> if you want the window to be modal.</p>

<p>If you want to get result from the window, you can modify the code to use <code>TaskCompletionSource&lt;Result&gt;</code> appropriately.</p>",13
25697927,c# store two vars objects in one var object,"<p>In the past, i was reading data from one excel sheet named ""On leave"" and do operation on the result like this:</p>

<pre><code>var resultNew1 = (from x in dataNew.Worksheet&lt;Employee&gt;(""On Leave"")
                             select x).ToList();
</code></pre>

<p>but now I have got another sheet which is ""Working"". so I did this:</p>

<pre><code>var resultNew1 = (from x in dataNew.Worksheet&lt;Employee&gt;(""On Leave"")
                             select x);
            var resultNew2 = (from x in dataNew.Worksheet&lt;Employee&gt;(""Working"")
                          select x);
</code></pre>

<p>please notice that the first one was <code>ToList()</code></p>

<p>but now I didn't make <code>ToLists()</code> because I want to ask you if there is a way to store these two vars which are <code>resultsNew1</code> and <code>resultsNew2</code> in one var and then make that var <code>ToList()</code></p>

<p>If you need more infomration, please tell me</p>",c#,"<p>You can use <code>List&lt;T&gt;.AddRange</code>:</p>

<pre><code>List&lt;Employee&gt; employees = new List&lt;Employee&gt;();
employees.AddRange(resultNew1);
employees.AddRange(resultNew2);
</code></pre>",1
25697927,c# store two vars objects in one var object,"<p>In the past, i was reading data from one excel sheet named ""On leave"" and do operation on the result like this:</p>

<pre><code>var resultNew1 = (from x in dataNew.Worksheet&lt;Employee&gt;(""On Leave"")
                             select x).ToList();
</code></pre>

<p>but now I have got another sheet which is ""Working"". so I did this:</p>

<pre><code>var resultNew1 = (from x in dataNew.Worksheet&lt;Employee&gt;(""On Leave"")
                             select x);
            var resultNew2 = (from x in dataNew.Worksheet&lt;Employee&gt;(""Working"")
                          select x);
</code></pre>

<p>please notice that the first one was <code>ToList()</code></p>

<p>but now I didn't make <code>ToLists()</code> because I want to ask you if there is a way to store these two vars which are <code>resultsNew1</code> and <code>resultsNew2</code> in one var and then make that var <code>ToList()</code></p>

<p>If you need more infomration, please tell me</p>",c#,"<p>You can use <code>Concat</code></p>

<pre><code>var employees = dataNew.Worksheet&lt;Employee&gt;(""On Leave"")
         .Concat(dataNew.Worksheet&lt;Employee&gt;(""Working""))
         .ToList();
</code></pre>",4
25759964,Force LINQ to Entities recognize my method,"<p>I have these code(this is only example code)</p>

<pre><code>public SomeService ()
{
    public Queryable&lt;CarDto&gt; GetDtos()
    {
       context.Cars.Select(c =&gt; new CarDto
       {
          CarDtoId = c.Id,
          Name = c.Name,
          Status = GetCarStatus(c)
       })
    }



    private CarStatusEnum GetCarStatus(Car car)
    {
       if(car.statusId == 2 || car.statusId == 3)
       {
          return 4;
       }
       return 5;
    }

}
</code></pre>

<p>This code throw exception(LINQ to Entities does not recognize method GetCarStatus).</p>

<p>I know:</p>

<ul>
<li>why it throws</li>
<li>I can do ToList() but I need Iqueryble</li>
<li>I can write method code inline without using method</li>
</ul>

<p>But I want know  way How can I do so,that LINQ to Entities can recognize my method?</p>",c#|.net|entity-framework|linq-to-entities|iqueryable,"<p>Let the DTO do the conversion:</p>

<pre><code>class CarDto
{
    ... 

    public int StatusId { get; set; }

    public CarStatusEnum CarStatus
    {
        get { return StatusId == 2 || StatusId == 3 
                       ? CarStatusEnum.Four
                       : CarStatusEnum.Five; }
    }
}
</code></pre>

<p>So in the query you just copy the <code>TypeId</code> value from the <code>Car</code>. And in the application you access <code>CarStatus</code>.</p>

<p>Note that you should return <code>CarStatusEnum</code> members, not plain integers (even when they match <code>CarStatusEnum</code> values. These <em>may</em> change in the future, which won't break your code, but will surely cause interesting bugs).</p>",0
25759964,Force LINQ to Entities recognize my method,"<p>I have these code(this is only example code)</p>

<pre><code>public SomeService ()
{
    public Queryable&lt;CarDto&gt; GetDtos()
    {
       context.Cars.Select(c =&gt; new CarDto
       {
          CarDtoId = c.Id,
          Name = c.Name,
          Status = GetCarStatus(c)
       })
    }



    private CarStatusEnum GetCarStatus(Car car)
    {
       if(car.statusId == 2 || car.statusId == 3)
       {
          return 4;
       }
       return 5;
    }

}
</code></pre>

<p>This code throw exception(LINQ to Entities does not recognize method GetCarStatus).</p>

<p>I know:</p>

<ul>
<li>why it throws</li>
<li>I can do ToList() but I need Iqueryble</li>
<li>I can write method code inline without using method</li>
</ul>

<p>But I want know  way How can I do so,that LINQ to Entities can recognize my method?</p>",c#|.net|entity-framework|linq-to-entities|iqueryable,"<p>Not sure if LINQ to Entities is able to convert such function to SQL query. You might need to use <a href=""http://msdn.microsoft.com/en-us/library/system.linq.expressions.expression(v=vs.110).aspx"" rel=""nofollow"">Expression</a> for such cases.</p>",0
25407876,Keep the delegate argument names when compiling C++/CLI for .Net,"<p>In C# I can get Visual Studio to keep the delegate's argument names.<br>
For example if I have:  </p>

<pre><code>public delegate void Blah(object myArg);
public event Blah Foo;
</code></pre>

<p>Then when I add a method to the event, Visual Studio UI automatically keeps the names and creates the method:</p>

<pre><code>void Form1_Foo(object myArg);
</code></pre>

<p>But, if I declare a delegate in C++/CLI:</p>

<pre><code>public:
delegate void Blah(Object^ myArg);
event Blah^ Foo;
</code></pre>

<p>it doesn't keep the names and creates a method with nonsense names:</p>

<pre><code>void Form1_Foo(object A_0)
</code></pre>

<p>How can I set meaningful names to the argument in C++/CLI ?</p>

<p><strong>EDIT (Added ildasm results):</strong></p>

<p>C++ CLI event:</p>

<pre><code>.method public hidebysig specialname instance void 
        Invoke(object myArg) cil managed
{
} // end of method Blah::Invoke
</code></pre>

<p>C# event:</p>

<pre><code>.method public hidebysig newslot virtual 
        instance void  Invoke(object myArg) runtime managed
{
} // end of method Blah::Invoke
</code></pre>",c#|c++-cli|ildasm,"<p>The question has no hint at the real problem and I could not get a repro.  But later realized what might be happening, the C++ compiler is different from other managed compilers, and MSIL, it doesn't require parameters to be named in declarations.  That panned out:</p>

<pre><code>namespace CppClassLibrary {
    public ref class Example {
    public:
        delegate void Blah(int, int, int, int);
        event Blah^ Foo;
    };
}
</code></pre>

<p>Produces this auto-generated event handler in C#:</p>

<pre><code>    void test_Foo(int A_0, int A_1, int A_2, int A_3) {
        throw new NotImplementedException();
    }
</code></pre>

<p>Looks like a slamdunk explanation.  You simply forgot to name the parameters in the delegate declaration, the C++ compiler is forced to synthesize them in order to write correct MSIL.  Easy to fix of course.</p>",3
25702030,ASPX connect to wamp database,"<p>I'm trying to connect aspx to a wamp database. Here's the database credentials:</p>

<pre><code>Server: mysql_wampserver
user: sa
password: Passw0rd
computer: mypc
database: ProjetoUtilizadores
</code></pre>

<p>In my web.config i'm using the following:</p>

<pre><code>&lt;add key=""cn"" value=""Server=localhost\mysql_wampserver;Database=ProjetoUtilizadores;User ID=sa;Password=Passw0rd;Trusted_Connection=False""/&gt;
</code></pre>

<p>Whenever i try to connect i get the error ""26 - Error Locating Server/Instance Specified"" any help? Thank you.</p>

<p>NOTE: Firewall is currently disabled on the computer that i'm using either for VisualStudio or WAMP server.</p>

<p>EDIT: i tried with Server=localhost and Server=MY_IP and now i get 
Named Pipes Provider, <code>error: 40 - Could not open a connection to SQL ServeR</code></p>",c#|mysql|asp.net|wamp,"<p>If you connect to a <code>MySql Server</code> you need to use the <code>MySqlConnection</code> class and, of course, the same MySql version of every other ADO.NET classes (MySqlCommand, MySqlDataReader, MySqlDataAdapter).</p>

<p>So your code should be something like this....</p>

<pre><code> using(MySqlConnection cnn = new MySqlConnection(GetConnectionStringFromConfig()))
 {
     using(MySqlCommand cmd = new MySqlCommand(commandText, cnn))
     {
         cnn.Open();
         .......
     }
 }
</code></pre>

<p>These classes are available in the <strong>MySql .Net Connector</strong>.<br>
The latest version could be downloaded <a href=""http://dev.mysql.com/downloads/connector/net/5.1.html"" rel=""nofollow"">here</a>, after installation you need to add a reference to this library and add a <code>using MySql.Data.MySqlClient;</code> directive to your project files where you use these classes.</p>",1
25542519,C# Index Out of Range,"<p>I am Learning c#. I am trying to get the displayName from AD. Here is the code for the following.</p>

<pre><code>if ( resEnt.Properties[""displayname""].Count &gt; 0)
{
    nameList = new List&lt;string&gt;();
    name = resEnt.Properties[""displayname""][0].ToString();
    nameList.Add(name.ToString());
    int count = nameList.Count;
    Console.WriteLine(""name: "" + resEnt.Properties[""displayname""][0].ToString());

    comboBox1.Items.Add(name.ToString());
 }
</code></pre>

<p>The error i am getting is </p>

<blockquote>
  <p>Index was out of range. Must be non-negative and less than the size of
  the collection. </p>
</blockquote>

<p>on the line </p>

<pre><code> name = resEnt.Properties[""displayname""][0].ToString();
</code></pre>",c#|active-directory,"<p>Maybe resEnt.Properties[""displayname""][0] is null?
Anyway, what is resEnt? is it of type DirectoryEntry? if so, you should try resEnt.Properties[""displayname""].Value.ToString()</p>",0
2059030,"Why is C# null translated as Empty in VB6, instead of Nothing","<p>I have a C# application that reference a VB6 dll. When I pass null from C# into VB6 dll function, the null is translated as value Empty (value) in VB6, instead of Nothing (object). For example:</p>

<pre><code> // function in vb6 dll that referenced by c# app
 Public Sub TestFunc(ByVal oValue As Variant)
 {
   ...
   if oValue is Nothing then
     set oValue = someObject
   end if
   ...

 }

 // main c# code
 private void Form1_Load(object sender, EventArgs e)
 {
    object testObject = new object();
    testObject = null;
    TestFunc(testObject);
 }
</code></pre>

<p>When I pass an object (not null) then it will be passed into the VB6 as object. But when null passed into vb6, it becomes value type Empty, instead of object type Nothing. Any one knows why? and is there anyway I can force null as Nothing in VB6 when passed from c# app?</p>

<p>Thanks a lot.</p>",c#|com|vb6|com-interop,"<p>Since you aren't supposed to modify the functions in the VB dll, what about adding one?</p>

<pre><code>Public Sub TestFuncEx(ByVal oValue As Variant)
{
   If IsEmpty(oValue) Then
    TestFunc(Nothing)
   Else
    TestFunc(oValue)
   End If
}
</code></pre>

<p>Presumably this would work as 1) it's a sub an not a function, so there's no return value and 2) you're passing by value so it's not modifying the object itself.</p>",3
2059030,"Why is C# null translated as Empty in VB6, instead of Nothing","<p>I have a C# application that reference a VB6 dll. When I pass null from C# into VB6 dll function, the null is translated as value Empty (value) in VB6, instead of Nothing (object). For example:</p>

<pre><code> // function in vb6 dll that referenced by c# app
 Public Sub TestFunc(ByVal oValue As Variant)
 {
   ...
   if oValue is Nothing then
     set oValue = someObject
   end if
   ...

 }

 // main c# code
 private void Form1_Load(object sender, EventArgs e)
 {
    object testObject = new object();
    testObject = null;
    TestFunc(testObject);
 }
</code></pre>

<p>When I pass an object (not null) then it will be passed into the VB6 as object. But when null passed into vb6, it becomes value type Empty, instead of object type Nothing. Any one knows why? and is there anyway I can force null as Nothing in VB6 when passed from c# app?</p>

<p>Thanks a lot.</p>",c#|com|vb6|com-interop,<p>I followed a suggestion from another website and used System.DBNull.Value in a COM method call.  That worked for me where passing the C# null did not.</p>,1
2059030,"Why is C# null translated as Empty in VB6, instead of Nothing","<p>I have a C# application that reference a VB6 dll. When I pass null from C# into VB6 dll function, the null is translated as value Empty (value) in VB6, instead of Nothing (object). For example:</p>

<pre><code> // function in vb6 dll that referenced by c# app
 Public Sub TestFunc(ByVal oValue As Variant)
 {
   ...
   if oValue is Nothing then
     set oValue = someObject
   end if
   ...

 }

 // main c# code
 private void Form1_Load(object sender, EventArgs e)
 {
    object testObject = new object();
    testObject = null;
    TestFunc(testObject);
 }
</code></pre>

<p>When I pass an object (not null) then it will be passed into the VB6 as object. But when null passed into vb6, it becomes value type Empty, instead of object type Nothing. Any one knows why? and is there anyway I can force null as Nothing in VB6 when passed from c# app?</p>

<p>Thanks a lot.</p>",c#|com|vb6|com-interop,<p>The reason is probably that it's a <code>ByVal</code> function. <code>null</code> is probably marshaled to a valuetype Variant that's as 'null' as possible.</p>,3
2059030,"Why is C# null translated as Empty in VB6, instead of Nothing","<p>I have a C# application that reference a VB6 dll. When I pass null from C# into VB6 dll function, the null is translated as value Empty (value) in VB6, instead of Nothing (object). For example:</p>

<pre><code> // function in vb6 dll that referenced by c# app
 Public Sub TestFunc(ByVal oValue As Variant)
 {
   ...
   if oValue is Nothing then
     set oValue = someObject
   end if
   ...

 }

 // main c# code
 private void Form1_Load(object sender, EventArgs e)
 {
    object testObject = new object();
    testObject = null;
    TestFunc(testObject);
 }
</code></pre>

<p>When I pass an object (not null) then it will be passed into the VB6 as object. But when null passed into vb6, it becomes value type Empty, instead of object type Nothing. Any one knows why? and is there anyway I can force null as Nothing in VB6 when passed from c# app?</p>

<p>Thanks a lot.</p>",c#|com|vb6|com-interop,"<p>Some more information, rather than an answer. I just ran this VB6 scratch program to confirm whether <code>Nothing</code> can be passed <code>ByVal</code>. It can be. </p>

<pre><code>Private Sub Form_Load()
  Call TestSub(Nothing)
End Sub
Private Sub TestSub(ByVal vnt As Variant)
  Debug.Print VarType(Nothing)
  Debug.Print VarType(vnt)
  If vnt Is Nothing Then Debug.Print ""vnt Is Nothing""
  If IsEmpty(vnt) Then Debug.Print ""vnt Is Empty""
End Sub
</code></pre>

<p>I got the following output. Note that 9 is <a href=""http://msdn.microsoft.com/en-us/library/aa263402(VS.60).aspx"" rel=""noreferrer"">vbObject</a> and indicates a Variant holding an Object reference. </p>

<pre><code> 9 
 9 
vnt Is Nothing
</code></pre>

<p>I haven't tested moving TestStub into another component but I think that'd still work. So I think the .NET marshalling to COM could do better. </p>",5
2059030,"Why is C# null translated as Empty in VB6, instead of Nothing","<p>I have a C# application that reference a VB6 dll. When I pass null from C# into VB6 dll function, the null is translated as value Empty (value) in VB6, instead of Nothing (object). For example:</p>

<pre><code> // function in vb6 dll that referenced by c# app
 Public Sub TestFunc(ByVal oValue As Variant)
 {
   ...
   if oValue is Nothing then
     set oValue = someObject
   end if
   ...

 }

 // main c# code
 private void Form1_Load(object sender, EventArgs e)
 {
    object testObject = new object();
    testObject = null;
    TestFunc(testObject);
 }
</code></pre>

<p>When I pass an object (not null) then it will be passed into the VB6 as object. But when null passed into vb6, it becomes value type Empty, instead of object type Nothing. Any one knows why? and is there anyway I can force null as Nothing in VB6 when passed from c# app?</p>

<p>Thanks a lot.</p>",c#|com|vb6|com-interop,"<p>As the parameter for the VB6 method is a Variant you should be testing for Nothing, Missing and Empty because they are the possible ""not value or object"" that can be passed when no real value or object is available.</p>

<p>In answer to your question, i think it is because a Variant in VB6 defaults to Empty, if your parameter was of type Object Nothing will be passed in, in your case.</p>

<p>You may want to try passing Nothing from VB.Net and seeing what happens, if the Nothing persists to the VB6 DLL then you know it is possible to pass it in and will find the answer by looking at the IL code.</p>",0
2059030,"Why is C# null translated as Empty in VB6, instead of Nothing","<p>I have a C# application that reference a VB6 dll. When I pass null from C# into VB6 dll function, the null is translated as value Empty (value) in VB6, instead of Nothing (object). For example:</p>

<pre><code> // function in vb6 dll that referenced by c# app
 Public Sub TestFunc(ByVal oValue As Variant)
 {
   ...
   if oValue is Nothing then
     set oValue = someObject
   end if
   ...

 }

 // main c# code
 private void Form1_Load(object sender, EventArgs e)
 {
    object testObject = new object();
    testObject = null;
    TestFunc(testObject);
 }
</code></pre>

<p>When I pass an object (not null) then it will be passed into the VB6 as object. But when null passed into vb6, it becomes value type Empty, instead of object type Nothing. Any one knows why? and is there anyway I can force null as Nothing in VB6 when passed from c# app?</p>

<p>Thanks a lot.</p>",c#|com|vb6|com-interop,"<p>Have you tried:</p>

<pre><code>Public Sub TestFunc(ByVal oValue As Variant)
 {
   ...
   If oValue Is Nothing Then
     Set oValue = someObject
   ElseIf IsEmpty(oValue) Then
     Set oValue = someObject
   End If
   ...

 }
</code></pre>

<p>Edit - And I would agree wtih Sander Rijken's answer as to why <code>Empty</code> is being returned instead of <code>null</code></p>",2
1343053,"Detecting if a program was run by Visual Studio, as opposed to run from Windows Explorer","<p>Is there a way to detect if your program was loaded through Visual Studio vs. whether it was started as a standalone executable?</p>

<p>Our software has a bug reporting feature to handle unhandled exceptions -- we need to be able to distribute debug builds to our beta testers, but we don't want the bug report to go off when we are in the middle of development, because the Exceptions are a lot more useful if VS catches them with a full stack trace, etc.</p>

<p>Right now, I'm disabling the bug report if <code>Application.ExecutablePath</code> includes bin\Debug or bin\Release, but I figure there is probably a more robust way of detecting whether the program was loaded through VS.</p>

<p>Obviously, we could set up a different build with some preprocessor macros, but for the sake of the question, assume that isn't a possibility -- I don't mind adding code, but I'm trying to make the fewest modifications to the build process, which is why command-line options are kind of a last resort as well.</p>

<p>If it matters, I'm using VS2003/.NET 1.1.</p>",c#|visual-studio,"<p>If you're doing this to determine if it is in <strong>any</strong> debugger (clarified by <em>@JaredPar</em>), you can use <a href=""http://msdn.microsoft.com/en-us/library/system.diagnostics.debugger.isattached.aspx"" rel=""noreferrer"">Debugger.IsAttached</a> in the exception handler.</p>

<pre><code>try
{
    // ...
}
catch(Exception ex)
{
    if (!Debugger.IsAttached)
    {
        ExceptionHandler.Frob(ex);
    }
    else
    {
        throw;
    }
}
</code></pre>

<p>Alternatively:</p>

<pre><code>public static void Frob(Exception ex)
{
    if (Debugger.IsAttached)
    {
        Debugger.Break();
    }
}
</code></pre>",51
1343053,"Detecting if a program was run by Visual Studio, as opposed to run from Windows Explorer","<p>Is there a way to detect if your program was loaded through Visual Studio vs. whether it was started as a standalone executable?</p>

<p>Our software has a bug reporting feature to handle unhandled exceptions -- we need to be able to distribute debug builds to our beta testers, but we don't want the bug report to go off when we are in the middle of development, because the Exceptions are a lot more useful if VS catches them with a full stack trace, etc.</p>

<p>Right now, I'm disabling the bug report if <code>Application.ExecutablePath</code> includes bin\Debug or bin\Release, but I figure there is probably a more robust way of detecting whether the program was loaded through VS.</p>

<p>Obviously, we could set up a different build with some preprocessor macros, but for the sake of the question, assume that isn't a possibility -- I don't mind adding code, but I'm trying to make the fewest modifications to the build process, which is why command-line options are kind of a last resort as well.</p>

<p>If it matters, I'm using VS2003/.NET 1.1.</p>",c#|visual-studio,"<p>Sometimes the application is started outside the debugger and the debugger gets attached later. (Doubleclick on a file where the application is assigned to ...) I use this code to wait for the debugger attach.</p>

<pre><code>using System.Diagnostics;

Process[] procName = Process.GetProcessesByName(""devenv"");

if(procName.Length &gt; 0)
  MessageBox.Show(""Wait for debugger attach"");
</code></pre>",0
1343053,"Detecting if a program was run by Visual Studio, as opposed to run from Windows Explorer","<p>Is there a way to detect if your program was loaded through Visual Studio vs. whether it was started as a standalone executable?</p>

<p>Our software has a bug reporting feature to handle unhandled exceptions -- we need to be able to distribute debug builds to our beta testers, but we don't want the bug report to go off when we are in the middle of development, because the Exceptions are a lot more useful if VS catches them with a full stack trace, etc.</p>

<p>Right now, I'm disabling the bug report if <code>Application.ExecutablePath</code> includes bin\Debug or bin\Release, but I figure there is probably a more robust way of detecting whether the program was loaded through VS.</p>

<p>Obviously, we could set up a different build with some preprocessor macros, but for the sake of the question, assume that isn't a possibility -- I don't mind adding code, but I'm trying to make the fewest modifications to the build process, which is why command-line options are kind of a last resort as well.</p>

<p>If it matters, I'm using VS2003/.NET 1.1.</p>",c#|visual-studio,"<p>Instead of tracking by process tree, I would add a configuration flag that enables the reporting feature.  The flag can always default to ""true"" unless you are in your DEV environment then you set it to ""false"". </p>",1
1343053,"Detecting if a program was run by Visual Studio, as opposed to run from Windows Explorer","<p>Is there a way to detect if your program was loaded through Visual Studio vs. whether it was started as a standalone executable?</p>

<p>Our software has a bug reporting feature to handle unhandled exceptions -- we need to be able to distribute debug builds to our beta testers, but we don't want the bug report to go off when we are in the middle of development, because the Exceptions are a lot more useful if VS catches them with a full stack trace, etc.</p>

<p>Right now, I'm disabling the bug report if <code>Application.ExecutablePath</code> includes bin\Debug or bin\Release, but I figure there is probably a more robust way of detecting whether the program was loaded through VS.</p>

<p>Obviously, we could set up a different build with some preprocessor macros, but for the sake of the question, assume that isn't a possibility -- I don't mind adding code, but I'm trying to make the fewest modifications to the build process, which is why command-line options are kind of a last resort as well.</p>

<p>If it matters, I'm using VS2003/.NET 1.1.</p>",c#|visual-studio,"<p>Have you considered command line arguments? Run the program from Visual Studio with a --no-exception-handling flag (or whatever sounds appropriate), and don't handle exceptions if that argument is passed in. When you start the program elsewhere, without this argument, it'll behave normally.</p>",3
1343053,"Detecting if a program was run by Visual Studio, as opposed to run from Windows Explorer","<p>Is there a way to detect if your program was loaded through Visual Studio vs. whether it was started as a standalone executable?</p>

<p>Our software has a bug reporting feature to handle unhandled exceptions -- we need to be able to distribute debug builds to our beta testers, but we don't want the bug report to go off when we are in the middle of development, because the Exceptions are a lot more useful if VS catches them with a full stack trace, etc.</p>

<p>Right now, I'm disabling the bug report if <code>Application.ExecutablePath</code> includes bin\Debug or bin\Release, but I figure there is probably a more robust way of detecting whether the program was loaded through VS.</p>

<p>Obviously, we could set up a different build with some preprocessor macros, but for the sake of the question, assume that isn't a possibility -- I don't mind adding code, but I'm trying to make the fewest modifications to the build process, which is why command-line options are kind of a last resort as well.</p>

<p>If it matters, I'm using VS2003/.NET 1.1.</p>",c#|visual-studio,"<p>I don't do .net development, but in java I have done this by passing a flag into the startup options of the application.  So you could pass a debug flag into the app from the IDE, and then check for that, when the app is run as an executable the flag would not be present.  I would be surprised if .net didn't have something similar.</p>",2
1343053,"Detecting if a program was run by Visual Studio, as opposed to run from Windows Explorer","<p>Is there a way to detect if your program was loaded through Visual Studio vs. whether it was started as a standalone executable?</p>

<p>Our software has a bug reporting feature to handle unhandled exceptions -- we need to be able to distribute debug builds to our beta testers, but we don't want the bug report to go off when we are in the middle of development, because the Exceptions are a lot more useful if VS catches them with a full stack trace, etc.</p>

<p>Right now, I'm disabling the bug report if <code>Application.ExecutablePath</code> includes bin\Debug or bin\Release, but I figure there is probably a more robust way of detecting whether the program was loaded through VS.</p>

<p>Obviously, we could set up a different build with some preprocessor macros, but for the sake of the question, assume that isn't a possibility -- I don't mind adding code, but I'm trying to make the fewest modifications to the build process, which is why command-line options are kind of a last resort as well.</p>

<p>If it matters, I'm using VS2003/.NET 1.1.</p>",c#|visual-studio,"<p>I know this is old but the provided solutions are not very satisfying.</p>

<p>I used the following class instead:</p>

<pre><code>using System.IO;
using System.Reflection;

public static class Program
{
    public static string ExecutablePath
    {
        get;
        private set;
    }

    static Program()
    {
        var assemblyPath = Assembly.GetEntryAssembly().Location;
        var assemblyDirectory = Path.GetDirectoryName(assemblyPath);

        if (assemblyDirectory.EndsWith(@""\Debug"") || assemblyDirectory.EndsWith(@""\Release""))
        {
            string projectFile = Path.GetFileNameWithoutExtension(assemblyPath) + "".csproj"";

            var root = new DirectoryInfo(assemblyDirectory);

            while (root.Parent != null)
            {
                if (File.Exists(Path.Combine(root.FullName, projectFile)))
                    break;

                root = root.Parent;

                if (root.Parent == null) // we could not find it (should not happen)
                    ExecutablePath = assemblyDirectory;
            }

            ExecutablePath = root.FullName;
        }
        else
        {
            ExecutablePath = assemblyDirectory;
        }
    }
}
</code></pre>

<p>Then you can just use <code>Program.ExecutablePath</code>. If you already have a class named <code>Program</code> you can just extend it by those properties and methods.</p>

<p>If running from Visual Studio it will give you the project path where the csproj-file resides. This is the executable path without the ""bin\*\Debug"" or ""bin\*\Release"" stuff.</p>

<p>If not running from Visual Studio it will give you the path where the executable resides.</p>

<p>The solution is independent of debug settings, other attached debuggers or build configurations. The only important thing is, that your configurations are named ""Release"" and ""Debug"".</p>

<p><strong>Note:</strong> As Troy Gizzi mentioned in the comments, this solution only works if you run the executable from another directory than the output directory. For my use case (simulate the deployment directory structure with the project directory as the root directory), this is a suitable solution. In general I copy my executable later to the deployment directory and expect the same behavior as if I run my program from within Visual Studio. Content and other dependencies are located relative to the project directory in my case.</p>",3
1916095,How do I make an eventhandler run asynchronously?,"<p>I am writing a Visual C# program that executes a continuous loop of operations on a secondary thread. Occasionally when that thread finishes a task I want it to trigger an eventhandler. My program does that but the when the event handler is triggered, the secondary thread waits until the event handler is finished before continuing the thread. How do I make it continue? Here is the way I currently have it structured...</p>

<pre><code>class TestClass 
{
  private Thread SecondaryThread;
  public event EventHandler OperationFinished;

  public void StartMethod()
  {
    ...
    SecondaryThread.Start();      //start the secondary thread
  }

  private void SecondaryThreadMethod()
  {
    ...
    OperationFinished(null, new EventArgs());
    ...  //This is where the program waits for whatever operations take
         //place when OperationFinished is triggered.
  }

}
</code></pre>

<p>This code is part of an API for one of my devices. When the OperationFinished event is triggered I want the client application to be able to do whatever it needs to (i.e. update the GUI accordingly) without haulting the API operation. </p>

<p>Also, if I do not want to pass any parameters to the event handler is my syntax correct by using <code>OperationFinished(null, new EventArgs())</code> ?</p>",c#|multithreading|event-handling|synchronous|eventargs,"<p>So you want to raise the event in a manner that prevents the listeners from blocking the background thread?  Gimme a couple minutes to whip up an example; it's pretty simple :-)</p>

<p>Here we go:  <strong>first an important note!</strong> Whenever you call <code>BeginInvoke</code> you must call the corresponding <code>EndInvoke</code>, otherwise if the invoked method threw an exception <em>or</em> returned a value then the ThreadPool thread will never be released back to the pool, resulting in a thread-leak!</p>

<pre><code>class TestHarness
{

    static void Main(string[] args)
    {
        var raiser = new SomeClass();

        // Emulate some event listeners
        raiser.SomeEvent += (sender, e) =&gt; { Console.WriteLine(""   Received event""); };
        raiser.SomeEvent += (sender, e) =&gt;
        {
            // Bad listener!
            Console.WriteLine(""   Blocking event"");
            System.Threading.Thread.Sleep(5000);
            Console.WriteLine(""   Finished blocking event"");
        };

        // Listener who throws an exception
        raiser.SomeEvent += (sender, e) =&gt;
        {
            Console.WriteLine(""   Received event, time to die!"");
            throw new Exception();
        };

        // Raise the event, see the effects
        raiser.DoSomething();

        Console.ReadLine();
    }
}

class SomeClass
{
    public event EventHandler SomeEvent;

    public void DoSomething()
    {
        OnSomeEvent();
    }

    private void OnSomeEvent()
    {
        if (SomeEvent != null)
        {
            var eventListeners = SomeEvent.GetInvocationList();

            Console.WriteLine(""Raising Event"");
            for (int index = 0; index &lt; eventListeners.Count(); index++)
            {
                var methodToInvoke = (EventHandler)eventListeners[index];
                methodToInvoke.BeginInvoke(this, EventArgs.Empty, EndAsyncEvent, null);
            }
            Console.WriteLine(""Done Raising Event"");
        }
    }

    private void EndAsyncEvent(IAsyncResult iar)
    {
        var ar = (System.Runtime.Remoting.Messaging.AsyncResult)iar;
        var invokedMethod = (EventHandler)ar.AsyncDelegate;

        try
        {
            invokedMethod.EndInvoke(iar);
        }
        catch
        {
            // Handle any exceptions that were thrown by the invoked method
            Console.WriteLine(""An event listener went kaboom!"");
        }
    }
}
</code></pre>",58
1916095,How do I make an eventhandler run asynchronously?,"<p>I am writing a Visual C# program that executes a continuous loop of operations on a secondary thread. Occasionally when that thread finishes a task I want it to trigger an eventhandler. My program does that but the when the event handler is triggered, the secondary thread waits until the event handler is finished before continuing the thread. How do I make it continue? Here is the way I currently have it structured...</p>

<pre><code>class TestClass 
{
  private Thread SecondaryThread;
  public event EventHandler OperationFinished;

  public void StartMethod()
  {
    ...
    SecondaryThread.Start();      //start the secondary thread
  }

  private void SecondaryThreadMethod()
  {
    ...
    OperationFinished(null, new EventArgs());
    ...  //This is where the program waits for whatever operations take
         //place when OperationFinished is triggered.
  }

}
</code></pre>

<p>This code is part of an API for one of my devices. When the OperationFinished event is triggered I want the client application to be able to do whatever it needs to (i.e. update the GUI accordingly) without haulting the API operation. </p>

<p>Also, if I do not want to pass any parameters to the event handler is my syntax correct by using <code>OperationFinished(null, new EventArgs())</code> ?</p>",c#|multithreading|event-handling|synchronous|eventargs,"<p>With the <a href=""http://msdn.microsoft.com/en-us/library/dd537609.aspx"">Task Parallel Library</a> it is now possible to do the following:</p>

<pre><code>Task.Factory.FromAsync( ( asyncCallback, @object ) =&gt; this.OperationFinished.BeginInvoke( this, EventArgs.Empty, asyncCallback, @object ), this.OperationFinished.EndInvoke, null );
</code></pre>",13
1916095,How do I make an eventhandler run asynchronously?,"<p>I am writing a Visual C# program that executes a continuous loop of operations on a secondary thread. Occasionally when that thread finishes a task I want it to trigger an eventhandler. My program does that but the when the event handler is triggered, the secondary thread waits until the event handler is finished before continuing the thread. How do I make it continue? Here is the way I currently have it structured...</p>

<pre><code>class TestClass 
{
  private Thread SecondaryThread;
  public event EventHandler OperationFinished;

  public void StartMethod()
  {
    ...
    SecondaryThread.Start();      //start the secondary thread
  }

  private void SecondaryThreadMethod()
  {
    ...
    OperationFinished(null, new EventArgs());
    ...  //This is where the program waits for whatever operations take
         //place when OperationFinished is triggered.
  }

}
</code></pre>

<p>This code is part of an API for one of my devices. When the OperationFinished event is triggered I want the client application to be able to do whatever it needs to (i.e. update the GUI accordingly) without haulting the API operation. </p>

<p>Also, if I do not want to pass any parameters to the event handler is my syntax correct by using <code>OperationFinished(null, new EventArgs())</code> ?</p>",c#|multithreading|event-handling|synchronous|eventargs,"<p>Try the BeginInvoke and EndInvoke methods on the event delegate - these return immediately, and allow you to use polling, a wait handle or a callback function to notify you when the method has completed. See <a href=""http://msdn.microsoft.com/en-us/library/2e08f6yc.aspx"" rel=""nofollow noreferrer"">here</a> for an overview; in your example, the event is the delegate you'll be using</p>",6
1916095,How do I make an eventhandler run asynchronously?,"<p>I am writing a Visual C# program that executes a continuous loop of operations on a secondary thread. Occasionally when that thread finishes a task I want it to trigger an eventhandler. My program does that but the when the event handler is triggered, the secondary thread waits until the event handler is finished before continuing the thread. How do I make it continue? Here is the way I currently have it structured...</p>

<pre><code>class TestClass 
{
  private Thread SecondaryThread;
  public event EventHandler OperationFinished;

  public void StartMethod()
  {
    ...
    SecondaryThread.Start();      //start the secondary thread
  }

  private void SecondaryThreadMethod()
  {
    ...
    OperationFinished(null, new EventArgs());
    ...  //This is where the program waits for whatever operations take
         //place when OperationFinished is triggered.
  }

}
</code></pre>

<p>This code is part of an API for one of my devices. When the OperationFinished event is triggered I want the client application to be able to do whatever it needs to (i.e. update the GUI accordingly) without haulting the API operation. </p>

<p>Also, if I do not want to pass any parameters to the event handler is my syntax correct by using <code>OperationFinished(null, new EventArgs())</code> ?</p>",c#|multithreading|event-handling|synchronous|eventargs,"<p>Look at the <a href=""http://msdn.microsoft.com/en-us/library/system.componentmodel.backgroundworker.aspx"" rel=""nofollow noreferrer"">BackgroundWorker</a> class.  I think it does exactly what you are asking for.</p>

<p>EDIT:
What I think you are asking is how to fire an event when only a small part of the overall background task is complete.  BackgroundWorker provides an event called ""ProgressChanged"" that allows you to report back to the main thread that some portion of the overall process is complete.  Then, when all of the async work is complete, it raises the ""RunWorkerCompleted"" event.</p>",0
1916095,How do I make an eventhandler run asynchronously?,"<p>I am writing a Visual C# program that executes a continuous loop of operations on a secondary thread. Occasionally when that thread finishes a task I want it to trigger an eventhandler. My program does that but the when the event handler is triggered, the secondary thread waits until the event handler is finished before continuing the thread. How do I make it continue? Here is the way I currently have it structured...</p>

<pre><code>class TestClass 
{
  private Thread SecondaryThread;
  public event EventHandler OperationFinished;

  public void StartMethod()
  {
    ...
    SecondaryThread.Start();      //start the secondary thread
  }

  private void SecondaryThreadMethod()
  {
    ...
    OperationFinished(null, new EventArgs());
    ...  //This is where the program waits for whatever operations take
         //place when OperationFinished is triggered.
  }

}
</code></pre>

<p>This code is part of an API for one of my devices. When the OperationFinished event is triggered I want the client application to be able to do whatever it needs to (i.e. update the GUI accordingly) without haulting the API operation. </p>

<p>Also, if I do not want to pass any parameters to the event handler is my syntax correct by using <code>OperationFinished(null, new EventArgs())</code> ?</p>",c#|multithreading|event-handling|synchronous|eventargs,"<p>Maybe Method2 or Method3 below can help :)</p>

<pre><code>public partial class Form1 : Form
{
    private Thread SecondaryThread;

    public Form1()
    {
        InitializeComponent();

        OperationFinished += callback1;
        OperationFinished += callback2;
        OperationFinished += callback3;
    }

    private void Form1_Load(object sender, EventArgs e)
    {
        SecondaryThread = new Thread(new ThreadStart(SecondaryThreadMethod));
        SecondaryThread.Start();
    }

     private void SecondaryThreadMethod()
     {
        Stopwatch sw = new Stopwatch();
        sw.Restart();

        OnOperationFinished(new MessageEventArg(""test1""));
        OnOperationFinished(new MessageEventArg(""test2""));
        OnOperationFinished(new MessageEventArg(""test3""));
        //This is where the program waits for whatever operations take
             //place when OperationFinished is triggered.

        sw.Stop();

        Invoke((MethodInvoker)delegate
        {
            richTextBox1.Text += ""Time taken (ms): "" + sw.ElapsedMilliseconds + ""\n"";
        });
     }

    void callback1(object sender, MessageEventArg e)
    {
        Thread.Sleep(2000);
        Invoke((MethodInvoker)delegate
        {
            richTextBox1.Text += e.Message + ""\n"";
        });
    }
    void callback2(object sender, MessageEventArg e)
    {
        Thread.Sleep(2000);
        Invoke((MethodInvoker)delegate
        {
            richTextBox1.Text += e.Message + ""\n"";
        });
    }

    void callback3(object sender, MessageEventArg e)
    {
        Thread.Sleep(2000);
        Invoke((MethodInvoker)delegate
        {
            richTextBox1.Text += e.Message + ""\n"";
        });
    }

    public event EventHandler&lt;MessageEventArg&gt; OperationFinished;

    protected void OnOperationFinished(MessageEventArg e)
    {
        //##### Method1 - Event raised on the same thread ##### 
        //EventHandler&lt;MessageEventArg&gt; handler = OperationFinished;

        //if (handler != null)
        //{
        //    handler(this, e);
        //}

        //##### Method2 - Event raised on (the same) separate thread for all listener #####
        //EventHandler&lt;MessageEventArg&gt; handler = OperationFinished;

        //if (handler != null)
        //{
        //    Task.Factory.StartNew(() =&gt; handler(this, e));
        //}

        //##### Method3 - Event raised on different threads for each listener #####
        if (OperationFinished != null)
        {
            foreach (EventHandler&lt;MessageEventArg&gt; handler in OperationFinished.GetInvocationList())
            {
                Task.Factory.FromAsync((asyncCallback, @object) =&gt; handler.BeginInvoke(this, e, asyncCallback, @object), handler.EndInvoke, null);
            }
        }
    }
}

public class MessageEventArg : EventArgs
{
    public string Message { get; set; }

    public MessageEventArg(string message)
    {
        this.Message = message;
    }
}
</code></pre>

<p>}</p>",4
1916095,How do I make an eventhandler run asynchronously?,"<p>I am writing a Visual C# program that executes a continuous loop of operations on a secondary thread. Occasionally when that thread finishes a task I want it to trigger an eventhandler. My program does that but the when the event handler is triggered, the secondary thread waits until the event handler is finished before continuing the thread. How do I make it continue? Here is the way I currently have it structured...</p>

<pre><code>class TestClass 
{
  private Thread SecondaryThread;
  public event EventHandler OperationFinished;

  public void StartMethod()
  {
    ...
    SecondaryThread.Start();      //start the secondary thread
  }

  private void SecondaryThreadMethod()
  {
    ...
    OperationFinished(null, new EventArgs());
    ...  //This is where the program waits for whatever operations take
         //place when OperationFinished is triggered.
  }

}
</code></pre>

<p>This code is part of an API for one of my devices. When the OperationFinished event is triggered I want the client application to be able to do whatever it needs to (i.e. update the GUI accordingly) without haulting the API operation. </p>

<p>Also, if I do not want to pass any parameters to the event handler is my syntax correct by using <code>OperationFinished(null, new EventArgs())</code> ?</p>",c#|multithreading|event-handling|synchronous|eventargs,"<blockquote>
  <p>Also, if I do not want to pass any parameters to the event handler is my syntax correct by using OperationFinished(null, new EventArgs()) ?</p>
</blockquote>

<p>No.  Typically, you would call it as:</p>

<pre><code>OperationFinished(this, EventArgs.Empty);
</code></pre>

<p>You should always pass an object as a sender - it's expected in the pattern (although typically ignored).  EventArgs.Empty is better than new EventArgs(), as well.</p>

<p>In order to fire this in a separate thread, the easiest option is probably to just use the thread pool:</p>

<pre><code>private void RaiseOperationFinished()
{
       ThreadPool.QueueUserWorkItem( new WaitCallback( (s) =&gt;
           {
              if (this.OperationFinished != null)
                   this.OperationFinished(this, EventArgs.Empty);
           }));
}
</code></pre>

<p>That being said, raising an event on a separate thread is something that should be thoroughly documented, as it will potentially cause unexpected behavior.</p>",12
1916095,How do I make an eventhandler run asynchronously?,"<p>I am writing a Visual C# program that executes a continuous loop of operations on a secondary thread. Occasionally when that thread finishes a task I want it to trigger an eventhandler. My program does that but the when the event handler is triggered, the secondary thread waits until the event handler is finished before continuing the thread. How do I make it continue? Here is the way I currently have it structured...</p>

<pre><code>class TestClass 
{
  private Thread SecondaryThread;
  public event EventHandler OperationFinished;

  public void StartMethod()
  {
    ...
    SecondaryThread.Start();      //start the secondary thread
  }

  private void SecondaryThreadMethod()
  {
    ...
    OperationFinished(null, new EventArgs());
    ...  //This is where the program waits for whatever operations take
         //place when OperationFinished is triggered.
  }

}
</code></pre>

<p>This code is part of an API for one of my devices. When the OperationFinished event is triggered I want the client application to be able to do whatever it needs to (i.e. update the GUI accordingly) without haulting the API operation. </p>

<p>Also, if I do not want to pass any parameters to the event handler is my syntax correct by using <code>OperationFinished(null, new EventArgs())</code> ?</p>",c#|multithreading|event-handling|synchronous|eventargs,"<p>I prefer to define a method that I pass to the child thread as a delegate which updates the UI. First define a delegate:</p>

<pre><code>public delegate void ChildCallBackDelegate();
</code></pre>

<p>In the child thread define a delegate member:</p>

<pre><code>public ChildCallbackDelegate ChildCallback {get; set;}
</code></pre>

<p>In the calling class define the method that updates the UI. You'll need to wrap it in the target control's dispatcher since its being called from a separate thread. Note the BeginInvoke. In this context EndInvoke isn't required:</p>

<pre><code>private void ChildThreadUpdater()
{
  yourControl.Dispatcher.BeginInvoke(System.Windows.Threading.DispatcherPriority.Background
    , new System.Threading.ThreadStart(delegate
      {
        // update your control here
      }
    ));
}
</code></pre>

<p>Before you launch your child thread, set its ChildCallBack property:</p>

<pre><code>theChild.ChildCallBack = new ChildCallbackDelegate(ChildThreadUpdater);
</code></pre>

<p>Then when the child thread wants to update the parent:</p>

<pre><code>ChildCallBack();
</code></pre>",0
42845879,VS2017 Scanning data,"<p>I opened a solution in VS2017 and noticed the below image stating ""Scanning data XX%""</p>

<p><a href=""https://i.stack.imgur.com/AjLGl.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/AjLGl.png"" alt=""enter image description here""></a></p>

<p>Does anyone know what VS is doing here? It seems to be taking a long time for a solution with 9 projects one of wich is a .net core angular2 app.</p>",c#|visual-studio|visual-studio-2017,"<p>It seems that if you invoke the 'Folder View' capability from the solution explorer, it starts to scan mysterious data (the folder structure I assume). Reason is not known.</p>

<p>However, following <a href=""https://developercommunity.visualstudio.com/content/problem/55157/mysterious-scanning-data-caption-and-progress-indi.html"" rel=""noreferrer"">this discussion</a>, I assume that Microsoft will fix this in the future release. </p>

<p>I did not find <em>Scanning Data</em> hinder any of my work, though it may slow down the PC a bit. </p>

<p><a href=""https://i.stack.imgur.com/V5XrY.jpg"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/V5XrY.jpg"" alt=""Folder or Solution View""></a></p>",7
42845879,VS2017 Scanning data,"<p>I opened a solution in VS2017 and noticed the below image stating ""Scanning data XX%""</p>

<p><a href=""https://i.stack.imgur.com/AjLGl.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/AjLGl.png"" alt=""enter image description here""></a></p>

<p>Does anyone know what VS is doing here? It seems to be taking a long time for a solution with 9 projects one of wich is a .net core angular2 app.</p>",c#|visual-studio|visual-studio-2017,"<p>OK i think i have found the solution
<a href=""https://i.stack.imgur.com/WhywP.jpg"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/WhywP.jpg"" alt=""VS 2017 install""></a>
<strong>During installation pls uncheck the c++ things it can cause you trouble in cloning or  Data scanning</strong> </p>",1
42845879,VS2017 Scanning data,"<p>I opened a solution in VS2017 and noticed the below image stating ""Scanning data XX%""</p>

<p><a href=""https://i.stack.imgur.com/AjLGl.png"" rel=""noreferrer""><img src=""https://i.stack.imgur.com/AjLGl.png"" alt=""enter image description here""></a></p>

<p>Does anyone know what VS is doing here? It seems to be taking a long time for a solution with 9 projects one of wich is a .net core angular2 app.</p>",c#|visual-studio|visual-studio-2017,"<p>I'm guessing you opened the project as a ""Folder"", which will need to find and catalog all the files within the folder structure, including the massive ""node_modules"".</p>

<p>I ""fixed"" this by opening as ""Web Site"".</p>

<p><a href=""https://i.stack.imgur.com/meiqP.png"" rel=""nofollow noreferrer""><img src=""https://i.stack.imgur.com/meiqP.png"" alt=""Open As Website""></a></p>",2
